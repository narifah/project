(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{jkDv:function(t,e,n){"use strict";n.r(e),n.d(e,"AdminModule",function(){return Dp});var r=n("ofXK"),i=n("fXoL"),o=n("/t3+"),s=n("bTqV"),a=n("NFeN"),u=n("MutI"),c=n("tyNb"),h=n("XhcP"),l=n("FKr1");let f=(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=i.Jb({type:t,selectors:[["app-admin"]],decls:38,vars:8,consts:[["color","primary",1,"example-header"],["mat-icon-button","",3,"click"],[1,"uk-width-expand"],["mat-button","",1,"mini-tittle"],["matListIcon",""],["mat-button","","routerLink","/login",1,"mini-tittle"],[1,"admin-container"],["mode","side","opened","",1,"sidenav-left",3,"position","fixedInViewport","fixedTopGap","fixedBottomGap"],["sidenav",""],["routerLink","/admin/home"],["matLine",""],["matSubheader",""],["routerLink","/admin/katalog"],["routerLink","/admin/product"],["mode","side",1,"example-sidenav",3,"position","fixedInViewport","fixedTopGap","fixedBottomGap"],[2,"padding","20px","background-color","#e0e0e0"]],template:function(t,e){if(1&t){const t=i.Wb();i.Tb(0),i.Vb(1,"mat-toolbar",0),i.Vb(2,"button",1),i.cc("click",function(){return i.sc(t),i.qc(15).toggle()}),i.Vb(3,"mat-icon"),i.zc(4,"menu"),i.Ub(),i.Ub(),i.Vb(5,"span"),i.zc(6,"DETKAMERA"),i.Ub(),i.Qb(7,"div",2),i.Vb(8,"button",3),i.Vb(9,"mat-icon",4),i.zc(10,"account_circle"),i.Ub(),i.Ub(),i.Vb(11,"button",5),i.zc(12,"Logout"),i.Ub(),i.Ub(),i.Vb(13,"mat-sidenav-container",6),i.Vb(14,"mat-sidenav",7,8),i.Vb(16,"mat-nav-list"),i.Vb(17,"mat-list-item",9),i.Vb(18,"mat-icon",4),i.zc(19,"store"),i.Ub(),i.Vb(20,"h3",10),i.zc(21,"Home"),i.Ub(),i.Ub(),i.Vb(22,"h4",11),i.zc(23,"Menu"),i.Ub(),i.Vb(24,"mat-list-item",12),i.Vb(25,"mat-icon",4),i.zc(26,"inventory_2"),i.Ub(),i.Vb(27,"h3",10),i.zc(28,"Katalog"),i.Ub(),i.Ub(),i.Vb(29,"mat-list-item",13),i.Vb(30,"mat-icon",4),i.zc(31,"monochrome_photos"),i.Ub(),i.Vb(32,"h3",10),i.zc(33,"Product"),i.Ub(),i.Ub(),i.Ub(),i.Ub(),i.Qb(34,"mat-sidenav",14,8),i.Vb(36,"mat-sidenav-content",15),i.Qb(37,"router-outlet"),i.Ub(),i.Ub(),i.Sb()}2&t&&(i.Eb(14),i.lc("position","start")("fixedInViewport",!0)("fixedTopGap",60)("fixedBottomGap",0),i.Eb(20),i.lc("position","end")("fixedInViewport",!0)("fixedTopGap",60)("fixedBottomGap",0))},directives:[o.a,s.a,a.a,u.a,c.b,h.b,h.a,u.e,u.b,l.j,u.d,h.c,c.d],styles:[".sidenav-left[_ngcontent-%COMP%]{width:270px}.admin-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;position:absolute;top:60px;bottom:0;left:0;right:0}"]}),t})();var d=n("w55g"),p=n("0IaG"),y=n("D0XW"),v=n("HDdC"),m=n("Cfvw"),g=n("LRne"),b=n("JX91"),w=n("Zy1z"),I=n("lJxs"),T=n("Kqap"),E=n("/uUt"),_=n("pLZG"),O=n("pxpQ"),S=n("spgP"),D=n("Jgta"),N=n("zIRd"),A=n("qOnz"),k=n("q/0M"),x=function(t,e){return(x=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function C(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var j,R="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},P=P||{},L=R||self;function V(){}function U(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function M(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var F="closure_uid_"+(1e9*Math.random()>>>0),q=0;function B(t,e,n){return t.call.apply(t.bind,arguments)}function K(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function G(t,e,n){return(G=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?B:K).apply(null,arguments)}function z(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function Q(){return Date.now()}function H(t,e){function n(){}n.prototype=e.prototype,t.X=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Pb=function(t,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return e.prototype[n].apply(t,i)}}function W(){this.j=this.j,this.i=this.i}W.prototype.j=!1,W.prototype.ka=function(){!this.j&&(this.j=!0,this.H(),0)&&function(t){Object.prototype.hasOwnProperty.call(t,F)&&t[F]||(t[F]=++q)}(this)},W.prototype.H=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var Y=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},X=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function $(t){return Array.prototype.concat.apply([],arguments)}function J(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function Z(t){return/^[\s\xa0]*$/.test(t)}var tt,et=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function nt(t,e){return-1!=t.indexOf(e)}function rt(t,e){return t<e?-1:t>e?1:0}t:{var it=L.navigator;if(it){var ot=it.userAgent;if(ot){tt=ot;break t}}tt=""}function st(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function at(t){var e={};for(var n in t)e[n]=t[n];return e}var ut="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function ct(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<ut.length;o++)n=ut[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function ht(t){return ht[" "](t),t}ht[" "]=V;var lt,ft,dt=nt(tt,"Opera"),pt=nt(tt,"Trident")||nt(tt,"MSIE"),yt=nt(tt,"Edge"),vt=yt||pt,mt=nt(tt,"Gecko")&&!(nt(tt.toLowerCase(),"webkit")&&!nt(tt,"Edge"))&&!(nt(tt,"Trident")||nt(tt,"MSIE"))&&!nt(tt,"Edge"),gt=nt(tt.toLowerCase(),"webkit")&&!nt(tt,"Edge");function bt(){var t=L.document;return t?t.documentMode:void 0}t:{var wt="",It=(ft=tt,mt?/rv:([^\);]+)(\)|;)/.exec(ft):yt?/Edge\/([\d\.]+)/.exec(ft):pt?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(ft):gt?/WebKit\/(\S+)/.exec(ft):dt?/(?:Version)[ \/]?(\S+)/.exec(ft):void 0);if(It&&(wt=It?It[1]:""),pt){var Tt=bt();if(null!=Tt&&Tt>parseFloat(wt)){lt=String(Tt);break t}}lt=wt}var Et={};function _t(t){return function(t,e){var n=Et;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e()}(t,function(){for(var e=0,n=et(String(lt)).split("."),r=et(String(t)).split("."),i=Math.max(n.length,r.length),o=0;0==e&&o<i;o++){var s=n[o]||"",a=r[o]||"";do{if(s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],0==s[0].length&&0==a[0].length)break;e=rt(0==s[1].length?0:parseInt(s[1],10),0==a[1].length?0:parseInt(a[1],10))||rt(0==s[2].length,0==a[2].length)||rt(s[2],a[2]),s=s[3],a=a[3]}while(0==e)}return 0<=e})}var Ot=L.document&&pt&&(bt()||parseInt(lt,10))||void 0,St=!pt||9<=Number(Ot),Dt=pt&&!_t("9"),Nt=function(){if(!L.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{L.addEventListener("test",V,e),L.removeEventListener("test",V,e)}catch(n){}return t}();function At(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function kt(t,e){if(At.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(mt){t:{try{ht(e.nodeName);var i=!0;break t}catch(o){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:xt[t.pointerType]||"",this.c=t,t.defaultPrevented&&this.b()}}At.prototype.b=function(){this.defaultPrevented=!0},H(kt,At);var xt={2:"touch",3:"pen",4:"mouse"};kt.prototype.b=function(){kt.X.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,Dt)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(e){}};var Ct="closure_listenable_"+(1e6*Math.random()|0),jt=0;function Rt(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.da=i,this.key=++jt,this.Y=this.Z=!1}function Pt(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.da=null}function Lt(t){this.src=t,this.a={},this.b=0}function Vt(t,e){var n=e.type;if(n in t.a){var r,i=t.a[n],o=Y(i,e);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(Pt(e),0==t.a[n].length&&(delete t.a[n],t.b--))}}function Ut(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.da==r)return i}return-1}Lt.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=Ut(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new Rt(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var Mt="closure_lm_"+(1e6*Math.random()|0),Ft={};function qt(t,e,n,r,i){if(r&&r.once)return Kt(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)qt(t,e[o],n,r,i);return null}return n=$t(n),t&&t[Ct]?t.wa(e,n,M(r)?!!r.capture:!!r,i):Bt(t,e,n,!1,r,i)}function Bt(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=M(i)?!!i.capture:!!i;if(s&&!St)return null;var a=Yt(t);if(a||(t[Mt]=a=new Lt(t)),(n=a.add(e,n,r,s,o)).proxy)return n;if(r=function(){var t=Wt,e=St?function(n){return t.call(e.src,e.listener,n)}:function(n){if(!(n=t.call(e.src,e.listener,n)))return n};return e}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)Nt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Qt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Kt(t,e,n,r,i){if(Array.isArray(e)){for(var o=0;o<e.length;o++)Kt(t,e[o],n,r,i);return null}return n=$t(n),t&&t[Ct]?t.xa(e,n,M(r)?!!r.capture:!!r,i):Bt(t,e,n,!0,r,i)}function Gt(t,e,n,r,i){if(Array.isArray(e))for(var o=0;o<e.length;o++)Gt(t,e[o],n,r,i);else r=M(r)?!!r.capture:!!r,n=$t(n),t&&t[Ct]?(t=t.c,(e=String(e).toString())in t.a&&-1<(n=Ut(o=t.a[e],n,r,i))&&(Pt(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete t.a[e],t.b--))):t&&(t=Yt(t))&&(e=t.a[e.toString()],t=-1,e&&(t=Ut(e,n,r,i)),(n=-1<t?e[t]:null)&&zt(n))}function zt(t){if("number"!=typeof t&&t&&!t.Y){var e=t.src;if(e&&e[Ct])Vt(e.c,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Qt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Yt(e))?(Vt(n,t),0==n.b&&(n.src=null,e[Mt]=null)):Pt(t)}}}function Qt(t){return t in Ft?Ft[t]:Ft[t]="on"+t}function Ht(t,e){var n=t.listener,r=t.da||t.src;return t.Z&&zt(t),n.call(r,e)}function Wt(t,e){if(t.Y)return!0;if(!St){if(!e)t:{e=["window","event"];for(var n=L,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return Ht(t,e=new kt(e,this))}return Ht(t,new kt(e,this))}function Yt(t){return(t=t[Mt])instanceof Lt?t:null}var Xt="__closure_events_fn_"+(1e9*Math.random()>>>0);function $t(t){return"function"==typeof t?t:(t[Xt]||(t[Xt]=function(e){return t.handleEvent(e)}),t[Xt])}function Jt(){W.call(this),this.c=new Lt(this),this.J=this,this.D=null}function Zt(t,e){var n,r=t.D;if(r)for(n=[];r;r=r.D)n.push(r);if(t=t.J,r=e.type||e,"string"==typeof e)e=new At(e,t);else if(e instanceof At)e.target=e.target||t;else{var i=e;ct(e=new At(r,t),i)}if(i=!0,n)for(var o=n.length-1;0<=o;o--){var s=e.a=n[o];i=te(s,r,!0,e)&&i}if(i=te(s=e.a=t,r,!0,e)&&i,i=te(s,r,!1,e)&&i,n)for(o=0;o<n.length;o++)i=te(s=e.a=n[o],r,!1,e)&&i}function te(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s=e[o];if(s&&!s.Y&&s.capture==n){var a=s.listener,u=s.da||s.src;s.Z&&Vt(t.c,s),i=!1!==a.call(u,r)&&i}}return i&&!r.defaultPrevented}H(Jt,W),Jt.prototype[Ct]=!0,(j=Jt.prototype).addEventListener=function(t,e,n,r){qt(this,t,e,n,r)},j.removeEventListener=function(t,e,n,r){Gt(this,t,e,n,r)},j.H=function(){if(Jt.X.H.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)Pt(n[r]);delete e.a[t],e.b--}}this.D=null},j.wa=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},j.xa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var ee=L.JSON.stringify;function ne(){this.b=this.a=null}var re,ie=new(function(){function t(t,e){this.c=t,this.f=e,this.b=0,this.a=null}return t.prototype.get=function(){var t;return 0<this.b?(this.b--,this.a=(t=this.a).next,t.next=null):t=this.c(),t},t}())(function(){return new se},function(t){t.reset()});function oe(){var t=he,e=null;return t.a&&(e=t.a,t.a=t.a.next,t.a||(t.b=null),e.next=null),e}function se(){this.next=this.b=this.a=null}function ae(t){L.setTimeout(function(){throw t},0)}function ue(t,e){re||function(){var t=L.Promise.resolve(void 0);re=function(){t.then(le)}}(),ce||(re(),ce=!0),he.add(t,e)}ne.prototype.add=function(t,e){var n=ie.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},se.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},se.prototype.reset=function(){this.next=this.b=this.a=null};var ce=!1,he=new ne;function le(){for(var t;t=oe();){try{t.a.call(t.b)}catch(n){ae(n)}var e=ie;e.f(t),100>e.b&&(e.b++,t.next=e.a,e.a=t)}ce=!1}function fe(t,e){Jt.call(this),this.b=t||1,this.a=e||L,this.f=G(this.eb,this),this.g=Q()}function de(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function pe(t,e,n){if("function"==typeof t)n&&(t=G(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=G(t.handleEvent,t)}return 2147483647<Number(e)?-1:L.setTimeout(t,e||0)}function ye(t){t.a=pe(function(){t.a=null,t.c&&(t.c=!1,ye(t))},t.h);var e=t.b;t.b=null,t.g.apply(null,e)}H(fe,Jt),(j=fe.prototype).aa=!1,j.M=null,j.eb=function(){if(this.aa){var t=Q()-this.g;0<t&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),Zt(this,"tick"),this.aa&&(de(this),this.start()))}},j.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=Q())},j.H=function(){fe.X.H.call(this),de(this),delete this.a};var ve=function(t){function e(e,n){var r=t.call(this)||this;return r.g=e,r.h=n,r.b=null,r.c=!1,r.a=null,r}return function(t,e){function n(){this.constructor=t}x(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:ye(this)},e.prototype.H=function(){t.prototype.H.call(this),this.a&&(L.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},e}(W);function me(t){W.call(this),this.b=t,this.a={}}H(me,W);var ge=[];function be(t,e,n,r){Array.isArray(n)||(n&&(ge[0]=n.toString()),n=ge);for(var i=0;i<n.length;i++){var o=qt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function we(t){st(t.a,function(t,e){this.a.hasOwnProperty(e)&&zt(t)},t),t.a={}}function Ie(){this.a=!0}function Te(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var o=i[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var s=1;s<i.length;s++)i[s]=""}}}return ee(n)}catch(a){return e}}(t,n)+(r?" "+r:"")})}me.prototype.H=function(){me.X.H.call(this),we(this)},me.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},Ie.prototype.info=function(){};var Ee={},_e=null;function Oe(){return _e=_e||new Jt}function Se(t){At.call(this,Ee.Ga,t)}function De(t){var e=Oe();Zt(e,new Se(e,t))}function Ne(t,e){At.call(this,Ee.STAT_EVENT,t),this.stat=e}function Ae(t){var e=Oe();Zt(e,new Ne(e,t))}function ke(t){At.call(this,Ee.Ha,t)}function xe(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return L.setTimeout(function(){t()},e)}Ee.Ga="serverreachability",H(Se,At),Ee.STAT_EVENT="statevent",H(Ne,At),Ee.Ha="timingevent",H(ke,At);var Ce={NO_ERROR:0,fb:1,sb:2,rb:3,mb:4,qb:5,tb:6,Ea:7,TIMEOUT:8,wb:9},je={kb:"complete",Gb:"success",Fa:"error",Ea:"abort",yb:"ready",zb:"readystatechange",TIMEOUT:"timeout",ub:"incrementaldata",xb:"progress",nb:"downloadprogress",Ob:"uploadprogress"};function Re(){}function Pe(){}Re.prototype.b=null;var Le,Ve={OPEN:"a",jb:"b",Fa:"c",vb:"d"};function Ue(){At.call(this,"d")}function Me(){At.call(this,"c")}function Fe(){}function qe(t,e,n,r){this.g=t,this.c=e,this.f=n,this.S=r||1,this.J=new me(this),this.P=Be,this.R=new fe(t=vt?125:void 0),this.B=null,this.b=!1,this.j=this.l=this.i=this.G=this.u=this.T=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.V=this.C=this.U=this.I=!1}H(Ue,At),H(Me,At),H(Fe,Re),Fe.prototype.a=function(){return new XMLHttpRequest},Fe.prototype.c=function(){return{}},Le=new Fe;var Be=45e3,Ke={},Ge={};function ze(t,e,n){t.G=1,t.i=pn(un(e)),t.j=n,t.I=!0,Qe(t,null)}function Qe(t,e){t.u=Q(),Ye(t),t.l=un(t.i);var n=t.l,r=t.S;Array.isArray(r)||(r=[String(r)]),Dn(n.b,"t",r),t.D=0,t.a=Ir(t.g,t.g.C?e:null),0<t.O&&(t.F=new ve(G(t.Da,t,t.a),t.O)),be(t.J,t.a,"readystatechange",t.bb),e=t.B?at(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),De(1),function(t,e,n,r,i,o){t.info(function(){if(t.a)if(o)for(var s="",a=o.split("&"),u=0;u<a.length;u++){var c=a[u].split("=");if(1<c.length){var h=c[0];c=c[1];var l=h.split("_");s=2<=l.length&&"type"==l[1]?s+(h+"=")+c+"&":s+(h+"=redacted&")}}else s=null;else s=o;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+n+"\n"+s})}(t.c,t.m,t.l,t.f,t.S,t.j)}function He(t,e,n){for(var r=!0;!t.A&&t.D<n.length;){var i=We(t,n);if(i==Ge){4==e&&(t.h=4,Ae(14),r=!1),Te(t.c,t.f,null,"[Incomplete Response]");break}if(i==Ke){t.h=4,Ae(15),Te(t.c,t.f,n,"[Invalid Chunk]"),r=!1;break}Te(t.c,t.f,i,null),tn(t,i)}4==e&&0==n.length&&(t.h=1,Ae(16),r=!1),t.b=t.b&&r,r?0<n.length&&!t.V&&(t.V=!0,(e=t.g).a==t&&e.U&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),dr(e),e.F=!0,Ae(11))):(Te(t.c,t.f,n,"[Invalid Chunked Response]"),Ze(t),Je(t))}function We(t,e){var n=t.D,r=e.indexOf("\n",n);return-1==r?Ge:(n=Number(e.substring(n,r)),isNaN(n)?Ke:(r+=1)+n>e.length?Ge:(e=e.substr(r,n),t.D=r+n,e))}function Ye(t){t.T=Q()+t.P,Xe(t,t.P)}function Xe(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=xe(G(t.$a,t),e)}function $e(t){t.o&&(L.clearTimeout(t.o),t.o=null)}function Je(t){0==t.g.v||t.A||vr(t.g,t)}function Ze(t){$e(t);var e=t.F;e&&"function"==typeof e.ka&&e.ka(),t.F=null,de(t.R),we(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ka())}function tn(t,e){try{var n=t.g;if(0!=n.v&&(n.a==t||Rn(n.b,t)))if(n.I=t.N,!t.C&&Rn(n.b,t)&&3==n.v){try{var r=n.la.a.parse(e)}catch(Od){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){t:if(!n.j){if(n.a){if(!(n.a.u+3e3<t.u))break t;yr(n),ir(n)}fr(n),Ae(18)}}else n.pa=i[1],0<n.pa-n.P&&37500>i[2]&&n.G&&0==n.o&&!n.m&&(n.m=xe(G(n.Xa,n),6e3));if(1>=jn(n.b)&&n.fa){try{n.fa()}catch(Od){}n.fa=void 0}}else gr(n,11)}else if((t.C||n.a==t)&&yr(n),!Z(e))for(e=r=n.la.a.parse(e),r=0;r<e.length;r++)if(n.P=(i=e[r])[0],i=i[1],2==n.v)if("c"==i[0]){n.J=i[1],n.ha=i[2];var o=i[3];null!=o&&(n.ia=o,n.c.info("VER="+n.ia));var s=i[4];null!=s&&(n.qa=s,n.c.info("SVER="+n.qa));var a=i[5];if(null!=a&&"number"==typeof a&&0<a){var u=1.5*a;n.D=u,n.c.info("backChannelRequestTimeoutMs_="+u)}u=n;var c=t.a;if(c){var h=c.a?c.a.getResponseHeader("X-Client-Wire-Protocol"):null;if(h){var l=u.b;!l.a&&(nt(h,"spdy")||nt(h,"quic")||nt(h,"h2"))&&(l.f=l.g,l.a=new Set,l.b&&(Pn(l,l.b),l.b=null))}if(u.A){var f=c.a?c.a.getResponseHeader("X-HTTP-Session-Id"):null;f&&(u.oa=f,dn(u.B,u.A,f))}}n.v=3,n.f&&n.f.ua(),n.U&&(n.N=Q()-t.u,n.c.info("Handshake RTT: "+n.N+"ms"));var d=t;if((u=n).ma=wr(u,u.C?u.ha:null,u.ga),d.C){Ln(u.b,d);var p=d,y=u.D;y&&p.setTimeout(y),p.o&&($e(p),Ye(p)),u.a=d}else lr(u);0<n.g.length&&ar(n)}else"stop"!=i[0]&&"close"!=i[0]||gr(n,7);else 3==n.v&&("stop"==i[0]||"close"==i[0]?"stop"==i[0]?gr(n,7):rr(n):"noop"!=i[0]&&n.f&&n.f.ta(i),n.o=0);De(4)}catch(Od){}}function en(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(U(t)||"string"==typeof t)X(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(U(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(U(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function nn(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof nn)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function rn(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];on(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)on(i,r=t.a[e])||(t.a[n++]=r,i[r]=1),e++;t.a.length=n}}function on(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(j=qe.prototype).setTimeout=function(t){this.P=t},j.bb=function(t){t=t.target;var e=this.F;e&&3==Zn(t)?e.f():this.Da(t)},j.Da=function(t){try{if(t==this.a)t:{var e=Zn(this.a),n=this.a.va(),r=this.a.W();if(!(3>e||3==e&&!vt&&!this.a.$())){this.A||4!=e||7==n||De(8==n||0>=r?3:2),$e(this);var i=this.a.W();this.N=i;var o=this.a.$();if(this.b=200==i,function(t,e,n,r,i,o,s){t.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+n+"\n"+o+" "+s})}(this.c,this.m,this.l,this.f,this.S,e,i),this.b){if(this.U&&!this.C){e:{if(this.a){var s,a=this.a;if((s=a.a?a.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Z(s)){var u=s;break e}}u=null}if(!u){this.b=!1,this.h=3,Ae(12),Ze(this),Je(this);break t}Te(this.c,this.f,u,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,tn(this,u)}this.I?(He(this,e,o),vt&&this.b&&3==e&&(be(this.J,this.R,"tick",this.ab),this.R.start())):(Te(this.c,this.f,o,null),tn(this,o)),4==e&&Ze(this),this.b&&!this.A&&(4==e?vr(this.g,this):(this.b=!1,Ye(this)))}else 400==i&&0<o.indexOf("Unknown SID")?(this.h=3,Ae(12)):(this.h=0,Ae(13)),Ze(this),Je(this)}}}catch(c){}},j.ab=function(){if(this.a){var t=Zn(this.a),e=this.a.$();this.D<e.length&&($e(this),He(this,t,e),this.b&&4!=t&&Ye(this))}},j.cancel=function(){this.A=!0,Ze(this)},j.$a=function(){this.o=null;var t=Q();0<=t-this.T?(function(t,e){t.info(function(){return"TIMEOUT: "+e})}(this.c,this.l),2!=this.G&&(De(3),Ae(17)),Ze(this),this.h=2,Je(this)):Xe(this,this.T-t)},(j=nn.prototype).K=function(){rn(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},j.L=function(){return rn(this),this.a.concat()},j.get=function(t,e){return on(this.b,t)?this.b[t]:e},j.set=function(t,e){on(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},j.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var sn=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function an(t,e){if(this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof an){this.a=void 0!==e?e:t.a,cn(this,t.f),this.j=t.j,hn(this,t.c),ln(this,t.h),this.g=t.g,e=t.b;var n=new En;n.c=e.c,e.a&&(n.a=new nn(e.a),n.b=e.b),fn(this,n),this.i=t.i}else t&&(n=String(t).match(sn))?(this.a=!!e,cn(this,n[1]||"",!0),this.j=yn(n[2]||""),hn(this,n[3]||"",!0),ln(this,n[4]),this.g=yn(n[5]||"",!0),fn(this,n[6]||"",!0),this.i=yn(n[7]||"")):(this.a=!!e,this.b=new En(null,this.a))}function un(t){return new an(t)}function cn(t,e,n){t.f=n?yn(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function hn(t,e,n){t.c=n?yn(e,!0):e}function ln(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.h=e}else t.h=null}function fn(t,e,n){e instanceof En?(t.b=e,function(t,e){e&&!t.f&&(_n(t),t.c=null,t.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(On(this,e),Dn(this,n,t))},t)),t.f=e}(t.b,t.a)):(n||(e=vn(e,In)),t.b=new En(e,t.a))}function dn(t,e,n){t.b.set(e,n)}function pn(t){return dn(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Q()).toString(36)),t}function yn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function vn(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,mn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function mn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}an.prototype.toString=function(){var t=[],e=this.f;e&&t.push(vn(e,gn,!0),":");var n=this.c;return(n||"file"==e)&&(t.push("//"),(e=this.j)&&t.push(vn(e,gn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(vn(n,"/"==n.charAt(0)?wn:bn,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",vn(n,Tn)),t.join("")};var gn=/[#\/\?@]/g,bn=/[#\?:]/g,wn=/[#\?]/g,In=/[#\?@]/g,Tn=/#/g;function En(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function _n(t){t.a||(t.a=new nn,t.b=0,t.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.c,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}function On(t,e){_n(t),e=Nn(t,e),on(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,on((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&rn(t)))}function Sn(t,e){return _n(t),e=Nn(t,e),on(t.a.b,e)}function Dn(t,e,n){On(t,e),0<n.length&&(t.c=null,t.a.set(Nn(t,e),J(n)),t.b+=n.length)}function Nn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}(j=En.prototype).add=function(t,e){_n(this),this.c=null,t=Nn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},j.forEach=function(t,e){_n(this),this.a.forEach(function(n,r){X(n,function(n){t.call(e,n,r,this)},this)},this)},j.L=function(){_n(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},j.K=function(t){_n(this);var e=[];if("string"==typeof t)Sn(this,t)&&(e=$(e,this.a.get(Nn(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=$(e,t[n])}return e},j.set=function(t,e){return _n(this),this.c=null,Sn(this,t=Nn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},j.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},j.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.K(r);for(var o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}}return this.c=t.join("&")};var An=function(){return function(t,e){this.b=t,this.a=e}}();function kn(t){this.g=t||xn,t=L.PerformanceNavigationTiming?0<(t=L.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(L.ja&&L.ja.za&&L.ja.za()&&L.ja.za().Qb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}var xn=10;function Cn(t){return!!t.b||!!t.a&&t.a.size>=t.f}function jn(t){return t.b?1:t.a?t.a.size:0}function Rn(t,e){return t.b?t.b==e:!!t.a&&t.a.has(e)}function Pn(t,e){t.a?t.a.add(e):t.b=e}function Ln(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function Vn(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null!=t.a&&0!==t.a.size){var r=t.c;try{for(var i=C(t.a.values()),o=i.next();!o.done;o=i.next())r=r.concat(o.value.s)}catch(s){e={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}return J(t.c)}function Un(){}function Mn(){this.a=new Un}function Fn(t,e,n){var r=n||"";try{en(t,function(t,n){var i=t;M(t)&&(i=ee(t)),e.push(r+n+"="+encodeURIComponent(i))})}catch(Yd){throw e.push(r+"type="+encodeURIComponent("_badmap")),Yd}}function qn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(o){}}kn.prototype.cancel=function(){var t,e;if(this.c=Vn(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=C(this.a.values()),r=n.next();!r.done;r=n.next())r.value.cancel()}catch(i){t={error:i}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},Un.prototype.stringify=function(t){return L.JSON.stringify(t,void 0)},Un.prototype.parse=function(t){return L.JSON.parse(t,void 0)};var Bn=L.JSON.parse;function Kn(t){Jt.call(this),this.headers=new nn,this.l=t||null,this.b=!1,this.u=this.a=null,this.C="",this.h=0,this.f="",this.g=this.B=this.m=this.A=!1,this.s=0,this.o=null,this.I=Gn,this.F=this.G=!1}H(Kn,Jt);var Gn="",zn=/^https?$/i,Qn=["POST","PUT"];function Hn(t){return"content-type"==t.toLowerCase()}function Wn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Yn(t),$n(t)}function Yn(t){t.A||(t.A=!0,Zt(t,"complete"),Zt(t,"error"))}function Xn(t){if(t.b&&void 0!==P&&(!t.u[1]||4!=Zn(t)||2!=t.W()))if(t.m&&4==Zn(t))pe(t.Aa,0,t);else if(Zt(t,"readystatechange"),4==Zn(t)){t.b=!1;try{var e,n=t.W();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var o=String(t.C).match(sn)[1]||null;if(!o&&L.self&&L.self.location){var s=L.self.location.protocol;o=s.substr(0,s.length-1)}i=!zn.test(o?o.toLowerCase():"")}e=i}if(e)Zt(t,"complete"),Zt(t,"success");else{t.h=6;try{var a=2<Zn(t)?t.a.statusText:""}catch(n){a=""}t.f=a+" ["+t.W()+"]",Yn(t)}}finally{$n(t)}}}function $n(t,e){if(t.a){Jn(t);var n=t.a,r=t.u[0]?V:null;t.a=null,t.u=null,e||Zt(t,"ready");try{n.onreadystatechange=r}catch(Yd){}}}function Jn(t){t.a&&t.F&&(t.a.ontimeout=null),t.o&&(L.clearTimeout(t.o),t.o=null)}function Zn(t){return t.a?t.a.readyState:0}function tr(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}r||(n=function(t){var e="";return st(t,function(t,n){e+=n,e+=":",e+=t,e+="\r\n"}),e}(n),"string"==typeof t?null!=n&&encodeURIComponent(String(n)):dn(t,e,n))}function er(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function nr(t){this.qa=0,this.g=[],this.c=new Ie,this.ha=this.ma=this.B=this.ga=this.a=this.oa=this.A=this.V=this.i=this.O=this.l=null,this.Pa=this.R=0,this.Ma=er("failFast",!1,t),this.G=this.m=this.j=this.h=this.f=null,this.S=!0,this.I=this.pa=this.P=-1,this.T=this.o=this.u=0,this.Ia=er("baseRetryDelayMs",5e3,t),this.Sa=er("retryDelaySeedMs",1e4,t),this.Na=er("forwardChannelMaxRetries",2,t),this.na=er("forwardChannelRequestTimeoutMs",2e4,t),this.Oa=t&&t.xmlHttpFactory||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new kn(t&&t.concurrentRequestLimit),this.la=new Mn,this.ea=t&&t.fastHandshake||!1,this.Ja=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.S=!1),this.U=!this.ea&&this.S&&t&&t.detectBufferingProxy||!1,this.fa=void 0,this.N=0,this.F=!1,this.s=null,(this.La=t&&t.c||!1)&&this.c.info("Opt-in to enable Chrome Origin Trials.")}function rr(t){if(or(t),3==t.v){var e=t.R++,n=un(t.B);dn(n,"SID",t.J),dn(n,"RID",e),dn(n,"TYPE","terminate"),cr(t,n),(e=new qe(t,t.c,e,void 0)).G=2,e.i=pn(un(n)),n=!1,L.navigator&&L.navigator.sendBeacon&&(n=L.navigator.sendBeacon(e.i.toString(),"")),!n&&L.Image&&((new Image).src=e.i,n=!0),n||(e.a=Ir(e.g,null),e.a.ba(e.i)),e.u=Q(),Ye(e)}br(t)}function ir(t){t.a&&(dr(t),t.a.cancel(),t.a=null)}function or(t){ir(t),t.j&&(L.clearTimeout(t.j),t.j=null),yr(t),t.b.cancel(),t.h&&("number"==typeof t.h&&L.clearTimeout(t.h),t.h=null)}function sr(t,e){t.g.push(new An(t.Pa++,e)),3==t.v&&ar(t)}function ar(t){Cn(t.b)||t.h||(t.h=!0,ue(t.Ca,t),t.u=0)}function ur(t,e){var n;n=e?e.f:t.R++;var r=un(t.B);dn(r,"SID",t.J),dn(r,"RID",n),dn(r,"AID",t.P),cr(t,r),t.i&&t.l&&tr(r,t.i,t.l),n=new qe(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=hr(t,n,1e3),n.setTimeout(Math.round(.5*t.na)+Math.round(.5*t.na*Math.random())),Pn(t.b,n),ze(n,r,e)}function cr(t,e){t.f&&en({},function(t,n){dn(e,n,t)})}function hr(t,e,n){n=Math.min(t.g.length,n);var r=t.f?G(t.f.Ka,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?s.push("ofs="+(o=i[0].b)):o=0:s.push("ofs="+o);for(var a=!0,u=0;u<n;u++){var c=i[u].b,h=i[u].a;if(0>(c-=o))o=Math.max(0,i[u].b-100),a=!1;else try{Fn(h,s,"req"+c+"_")}catch(ii){r&&r(h)}}if(a){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function lr(t){t.a||t.j||(t.T=1,ue(t.Ba,t),t.o=0)}function fr(t){return!(t.a||t.j||3<=t.o||(t.T++,t.j=xe(G(t.Ba,t),mr(t,t.o)),t.o++,0))}function dr(t){null!=t.s&&(L.clearTimeout(t.s),t.s=null)}function pr(t){t.a=new qe(t,t.c,"rpc",t.T),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=un(t.ma);dn(e,"RID","rpc"),dn(e,"SID",t.J),dn(e,"CI",t.G?"0":"1"),dn(e,"AID",t.P),cr(t,e),dn(e,"TYPE","xmlhttp"),t.i&&t.l&&tr(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ha,n.G=1,n.i=pn(un(e)),n.j=null,n.I=!0,Qe(n,t)}function yr(t){null!=t.m&&(L.clearTimeout(t.m),t.m=null)}function vr(t,e){var n=null;if(t.a==e){yr(t),dr(t),t.a=null;var r=2}else{if(!Rn(t.b,e))return;n=e.s,Ln(t.b,e),r=1}if(t.I=e.N,0!=t.v)if(e.b)if(1==r){n=e.j?e.j.length:0,e=Q()-e.u;var i=t.u;Zt(r=Oe(),new ke(r,n,e,i)),ar(t)}else lr(t);else if(3==(i=e.h)||0==i&&0<t.I||!(1==r&&function(t,e){return!(jn(t.b)>=t.b.f-(t.h?1:0)||(t.h?(t.g=e.s.concat(t.g),0):1==t.v||2==t.v||t.u>=(t.Ma?0:t.Na)||(t.h=xe(G(t.Ca,t,e),mr(t,t.u)),t.u++,0)))}(t,e)||2==r&&fr(t)))switch(n&&0<n.length&&(e=t.b,e.c=e.c.concat(n)),i){case 1:gr(t,5);break;case 4:gr(t,10);break;case 3:gr(t,6);break;default:gr(t,2)}}function mr(t,e){var n=t.Ia+Math.floor(Math.random()*t.Sa);return t.f||(n*=2),n*e}function gr(t,e){if(t.c.info("Error code "+e),2==e){var n=null;t.f&&(n=null);var r=G(t.cb,t);n||(n=new an("//www.google.com/images/cleardot.gif"),L.location&&"http"==L.location.protocol||cn(n,"https"),pn(n)),function(t,e){var n=new Ie;if(L.Image){var r=new Image;r.onload=z(qn,n,r,"TestLoadImage: loaded",!0,e),r.onerror=z(qn,n,r,"TestLoadImage: error",!1,e),r.onabort=z(qn,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=z(qn,n,r,"TestLoadImage: timeout",!1,e),L.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}else e(!1)}(n.toString(),r)}else Ae(2);t.v=0,t.f&&t.f.sa(e),br(t),or(t)}function br(t){t.v=0,t.I=-1,t.f&&(0==Vn(t.b).length&&0==t.g.length||(t.b.c.length=0,J(t.g),t.g.length=0),t.f.ra())}function wr(t,e,n){var r=function(t){return t instanceof an?un(t):new an(t,void 0)}(n);if(""!=r.c)e&&hn(r,e+"."+r.c),ln(r,r.h);else{var i=L.location;r=function(t,e,n,r){var i=new an(null,void 0);return t&&cn(i,t),e&&hn(i,e),n&&ln(i,n),r&&(i.g=r),i}(i.protocol,e?e+"."+i.hostname:i.hostname,+i.port,n)}return t.V&&st(t.V,function(t,e){dn(r,e,t)}),n=t.oa,(e=t.A)&&n&&dn(r,e,n),dn(r,"VER",t.ia),cr(t,r),r}function Ir(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Kn(t.Oa)).G=t.C,e}function Tr(){}function Er(){if(pt&&!(10<=Number(Ot)))throw Error("Environmental error: no available transport.")}function _r(t,e){Jt.call(this),this.a=new nr(e),this.g=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!Z(t)&&(this.a.i=t),this.o=e&&e.supportsCrossDomainXhr||!1,this.m=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Z(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&e in(t=this.b)&&delete t[e]),this.f=new Dr(this)}function Or(t){Ue.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function Sr(){Me.call(this),this.status=1}function Dr(t){this.a=t}function Nr(t){this.f=t}function Ar(t){Jt.call(this),this.u=t,this.h=void 0,this.readyState=kr,this.status=0,this.responseType=this.responseText=this.statusText="",this.onreadystatechange=null,this.l=new Headers,this.b=null,this.s="GET",this.o="",this.a=!1,this.m=this.f=this.g=null}(j=Kn.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.C+"; newUri="+t);e=e?e.toUpperCase():"GET",this.C=t,this.f="",this.h=0,this.A=!1,this.b=!0,this.a=this.l?this.l.a():Le.a(),this.u=function(t){return t.b||(t.b=t.c())}(this.l?this.l:Le),this.a.onreadystatechange=G(this.Aa,this);try{this.B=!0,this.a.open(e,String(t),!0),this.B=!1}catch(o){return void Wn(this,o)}t=n||"";var i=new nn(this.headers);r&&en(r,function(t,e){i.set(e,t)}),r=function(t){t:{for(var e=Hn,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:"string"==typeof t?t.charAt(e):t[e]}(i.L()),n=L.FormData&&t instanceof L.FormData,!(0<=Y(Qn,e))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.G&&(this.a.withCredentials=this.G);try{Jn(this),0<this.s&&((this.F=function(t){return pt&&_t(9)&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(this.a))?(this.a.timeout=this.s,this.a.ontimeout=G(this.ya,this)):this.o=pe(this.ya,this.s,this)),this.m=!0,this.a.send(t),this.m=!1}catch(o){Wn(this,o)}},j.ya=function(){void 0!==P&&this.a&&(this.f="Timed out after "+this.s+"ms, aborting",this.h=8,Zt(this,"timeout"),this.abort(8))},j.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,Zt(this,"complete"),Zt(this,"abort"),$n(this))},j.H=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),$n(this,!0)),Kn.X.H.call(this)},j.Aa=function(){this.j||(this.B||this.m||this.g?Xn(this):this.Za())},j.Za=function(){Xn(this)},j.W=function(){try{return 2<Zn(this)?this.a.status:-1}catch(ft){return-1}},j.$=function(){try{return this.a?this.a.responseText:""}catch(ft){return""}},j.Qa=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Bn(e)}},j.va=function(){return this.h},j.Ra=function(){return"string"==typeof this.f?this.f:String(this.f)},(j=nr.prototype).ia=8,j.v=1,j.Ca=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new qe(this,this.c,t,void 0),r=this.l;if(this.O&&(r?ct(r=at(r),this.O):r=this.O),null===this.i&&(n.B=r),this.ea)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=hr(this,n,e),dn(i=un(this.B),"RID",t),dn(i,"CVER",22),this.A&&dn(i,"X-HTTP-Session-Id",this.A),cr(this,i),this.i&&r&&tr(i,this.i,r),Pn(this.b,n),this.Ja&&dn(i,"TYPE","init"),this.ea?(dn(i,"$req",e),dn(i,"SID","null"),n.U=!0,ze(n,i,null)):ze(n,i,e),this.v=2}}else 3==this.v&&(t?ur(this,t):0==this.g.length||Cn(this.b)||ur(this))},j.Ba=function(){if(this.j=null,pr(this),this.U&&!(this.F||null==this.a||0>=this.N)){var t=2*this.N;this.c.info("BP detection timer enabled: "+t),this.s=xe(G(this.Ya,this),t)}},j.Ya=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.F=!0,Ae(10),ir(this),pr(this))},j.Xa=function(){null!=this.m&&(this.m=null,ir(this),fr(this),Ae(19))},j.cb=function(t){t?(this.c.info("Successfully pinged google.com"),Ae(2)):(this.c.info("Failed to ping google.com"),Ae(1))},(j=Tr.prototype).ua=function(){},j.ta=function(){},j.sa=function(){},j.ra=function(){},j.Ka=function(){},Er.prototype.a=function(t,e){return new _r(t,e)},H(_r,Jt),_r.prototype.h=function(){this.a.f=this.f,this.o&&(this.a.C=!0);var t=this.a,e=this.g,n=this.b||void 0;Ae(0),t.ga=e,t.V=n||{},t.G=t.S,t.B=wr(t,null,t.ga),ar(t)},_r.prototype.close=function(){rr(this.a)},_r.prototype.l=function(t){if("string"==typeof t){var e={};e.__data__=t,sr(this.a,e)}else this.m?((e={}).__data__=ee(t),sr(this.a,e)):sr(this.a,t)},_r.prototype.H=function(){this.a.f=null,delete this.f,rr(this.a),delete this.a,_r.X.H.call(this)},H(Or,Ue),H(Sr,Me),H(Dr,Tr),Dr.prototype.ua=function(){Zt(this.a,"a")},Dr.prototype.ta=function(t){Zt(this.a,new Or(t))},Dr.prototype.sa=function(t){Zt(this.a,new Sr(t))},Dr.prototype.ra=function(){Zt(this.a,"b")},H(Nr,Re),Nr.prototype.a=function(){return new Ar(this.f)},Nr.prototype.c=function(t){return function(){return t}}({}),H(Ar,Jt);var kr=0;function xr(t){t.f.read().then(t.Ta.bind(t)).catch(t.ca.bind(t))}function Cr(t){t.readyState=4,t.g=null,t.f=null,t.m=null,jr(t)}function jr(t){t.onreadystatechange&&t.onreadystatechange.call(t)}(j=Ar.prototype).open=function(t,e){if(this.readyState!=kr)throw this.abort(),Error("Error reopening a connection");this.s=t,this.o=e,this.readyState=1,jr(this)},j.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.a=!0;var e={headers:this.l,method:this.s,credentials:this.h,cache:void 0};t&&(e.body=t),this.u.fetch(new Request(this.o,e)).then(this.Wa.bind(this),this.ca.bind(this))},j.abort=function(){this.responseText="",this.l=new Headers,this.status=0,this.f&&this.f.cancel("Request was aborted."),1<=this.readyState&&this.a&&4!=this.readyState&&(this.a=!1,Cr(this)),this.readyState=kr},j.Wa=function(t){this.a&&(this.g=t,this.b||(this.status=this.g.status,this.statusText=this.g.statusText,this.b=t.headers,this.readyState=2,jr(this)),this.a&&(this.readyState=3,jr(this),this.a&&("arraybuffer"===this.responseType?t.arrayBuffer().then(this.Ua.bind(this),this.ca.bind(this)):void 0!==L.ReadableStream&&"body"in t?(this.responseText="",this.f=t.body.getReader(),this.m=new TextDecoder,xr(this)):t.text().then(this.Va.bind(this),this.ca.bind(this)))))},j.Ta=function(t){if(this.a){var e=this.m.decode(t.value?t.value:new Uint8Array(0),{stream:!t.done});e&&(this.responseText+=e),t.done?Cr(this):jr(this),3==this.readyState&&xr(this)}},j.Va=function(t){this.a&&(this.responseText=t,Cr(this))},j.Ua=function(){this.a&&Cr(this)},j.ca=function(){this.a&&Cr(this)},j.setRequestHeader=function(t,e){this.l.append(t,e)},j.getResponseHeader=function(t){return this.b&&this.b.get(t.toLowerCase())||""},j.getAllResponseHeaders=function(){if(!this.b)return"";for(var t=[],e=this.b.entries(),n=e.next();!n.done;)t.push((n=n.value)[0]+": "+n[1]),n=e.next();return t.join("\r\n")},Object.defineProperty(Ar.prototype,"withCredentials",{get:function(){return"include"===this.h},set:function(t){this.h=t?"include":"same-origin"}}),Er.prototype.createWebChannel=Er.prototype.a,_r.prototype.send=_r.prototype.l,_r.prototype.open=_r.prototype.h,_r.prototype.close=_r.prototype.close,Ce.NO_ERROR=0,Ce.TIMEOUT=8,Ce.HTTP_ERROR=6,je.COMPLETE="complete",Pe.EventType=Ve,Ve.OPEN="a",Ve.CLOSE="b",Ve.ERROR="c",Ve.MESSAGE="d",Jt.prototype.listen=Jt.prototype.wa,Kn.prototype.listenOnce=Kn.prototype.xa,Kn.prototype.getLastError=Kn.prototype.Ra,Kn.prototype.getLastErrorCode=Kn.prototype.va,Kn.prototype.getStatus=Kn.prototype.W,Kn.prototype.getResponseJson=Kn.prototype.Qa,Kn.prototype.getResponseText=Kn.prototype.$,Kn.prototype.send=Kn.prototype.ba;var Rr=Ce,Pr=je,Lr=Ee,Vr=Nr,Ur=Pe,Mr=Kn,Fr=n("mrSG"),qr=function(){function t(t,e){var n=this;this.previousValue=t,e&&(e.sequenceNumberHandler=function(t){return n.t(t)},this.i=function(t){return e.writeSequenceNumber(t)})}return t.prototype.t=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},t.prototype.next=function(){var t=++this.previousValue;return this.i&&this.i(t),t},t}();qr.o=-1;var Br={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Kr=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).code=e,r.message=n,r.name="FirebaseError",r.toString=function(){return r.name+": [code="+r.code+"]: "+r.message},r}return Object(Fr.c)(e,t),e}(Error),Gr=new k.b("@firebase/firestore");function zr(){return Gr.logLevel}function Qr(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Gr.logLevel<=k.a.DEBUG){var r=e.map(Yr);Gr.debug.apply(Gr,Object(Fr.f)(["Firestore (8.6.8): "+t],r))}}function Hr(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Gr.logLevel<=k.a.ERROR){var r=e.map(Yr);Gr.error.apply(Gr,Object(Fr.f)(["Firestore (8.6.8): "+t],r))}}function Wr(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Gr.logLevel<=k.a.WARN){var r=e.map(Yr);Gr.warn.apply(Gr,Object(Fr.f)(["Firestore (8.6.8): "+t],r))}}function Yr(t){if("string"==typeof t)return t;try{return JSON.stringify(t)}catch(Yd){return t}}function Xr(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE (8.6.8) INTERNAL ASSERTION FAILED: "+t;throw Hr(e),new Error(e)}function $r(t,e){t||Xr()}function Jr(t,e){return t}function Zr(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}var ti=function(){function t(){}return t.u=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=Zr(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},t}();function ei(t,e){return t<e?-1:t>e?1:0}function ni(t,e,n){return t.length===e.length&&t.every(function(t,r){return n(t,e[r])})}function ri(t){return t+"\0"}var ii=function(){function t(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new Kr(Br.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new Kr(Br.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Kr(Br.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new Kr(Br.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return t.now=function(){return t.fromMillis(Date.now())},t.fromDate=function(e){return t.fromMillis(e.getTime())},t.fromMillis=function(e){var n=Math.floor(e/1e3);return new t(n,Math.floor(1e6*(e-1e3*n)))},t.prototype.toDate=function(){return new Date(this.toMillis())},t.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},t.prototype._compareTo=function(t){return this.seconds===t.seconds?ei(this.nanoseconds,t.nanoseconds):ei(this.seconds,t.seconds)},t.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},t.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},t.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},t.prototype.valueOf=function(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},t}(),oi=function(){function t(t){this.timestamp=t}return t.fromTimestamp=function(e){return new t(e)},t.min=function(){return new t(new ii(0,0))},t.prototype.compareTo=function(t){return this.timestamp._compareTo(t.timestamp)},t.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},t.prototype.toMicroseconds=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},t.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},t.prototype.toTimestamp=function(){return this.timestamp},t}();function si(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function ai(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function ui(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var ci=function(){function t(t,e,n){void 0===e?e=0:e>t.length&&Xr(),void 0===n?n=t.length-e:n>t.length-e&&Xr(),this.segments=t,this.offset=e,this.len=n}return Object.defineProperty(t.prototype,"length",{get:function(){return this.len},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return 0===t.comparator(this,e)},t.prototype.child=function(e){var n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach(function(t){n.push(t)}):n.push(e),this.construct(n)},t.prototype.limit=function(){return this.offset+this.length},t.prototype.popFirst=function(t){return this.construct(this.segments,this.offset+(t=void 0===t?1:t),this.length-t)},t.prototype.popLast=function(){return this.construct(this.segments,this.offset,this.length-1)},t.prototype.firstSegment=function(){return this.segments[this.offset]},t.prototype.lastSegment=function(){return this.get(this.length-1)},t.prototype.get=function(t){return this.segments[this.offset+t]},t.prototype.isEmpty=function(){return 0===this.length},t.prototype.isPrefixOf=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.isImmediateParentOf=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},t.prototype.toArray=function(){return this.segments.slice(this.offset,this.limit())},t.comparator=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(i>o)return 1}return t.length<e.length?-1:t.length>e.length?1:0},t}(),hi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(Fr.c)(e,t),e.prototype.construct=function(t,n,r){return new e(t,n,r)},e.prototype.canonicalString=function(){return this.toArray().join("/")},e.prototype.toString=function(){return this.canonicalString()},e.fromString=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var r=[],i=0,o=t;i<o.length;i++){var s=o[i];if(s.indexOf("//")>=0)throw new Kr(Br.INVALID_ARGUMENT,"Invalid segment ("+s+"). Paths must not contain // in them.");r.push.apply(r,s.split("/").filter(function(t){return t.length>0}))}return new e(r)},e.emptyPath=function(){return new e([])},e}(ci),li=/^[_a-zA-Z][_a-zA-Z0-9]*$/,fi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(Fr.c)(e,t),e.prototype.construct=function(t,n,r){return new e(t,n,r)},e.isValidIdentifier=function(t){return li.test(t)},e.prototype.canonicalString=function(){return this.toArray().map(function(t){return t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),e.isValidIdentifier(t)||(t="`"+t+"`"),t}).join(".")},e.prototype.toString=function(){return this.canonicalString()},e.prototype.isKeyField=function(){return 1===this.length&&"__name__"===this.get(0)},e.keyField=function(){return new e(["__name__"])},e.fromServerFormat=function(t){for(var n=[],r="",i=0,o=function(){if(0===r.length)throw new Kr(Br.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");n.push(r),r=""},s=!1;i<t.length;){var a=t[i];if("\\"===a){if(i+1===t.length)throw new Kr(Br.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[i+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Kr(Br.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=u,i+=2}else"`"===a?(s=!s,i++):"."!==a||s?(r+=a,i++):(o(),i++)}if(o(),s)throw new Kr(Br.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new e(n)},e.emptyPath=function(){return new e([])},e}(ci),di=function(){function t(t){this.fields=t,t.sort(fi.comparator)}return t.prototype.covers=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].isPrefixOf(t))return!0;return!1},t.prototype.isEqual=function(t){return ni(this.fields,t.fields,function(t,e){return t.isEqual(e)})},t}(),pi=function(){function t(t){this.binaryString=t}return t.fromBase64String=function(e){return new t(atob(e))},t.fromUint8Array=function(e){return new t(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(e))},t.prototype.toBase64=function(){return btoa(this.binaryString)},t.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.binaryString)},t.prototype.approximateByteSize=function(){return 2*this.binaryString.length},t.prototype.compareTo=function(t){return ei(this.binaryString,t.binaryString)},t.prototype.isEqual=function(t){return this.binaryString===t.binaryString},t}();pi.EMPTY_BYTE_STRING=new pi("");var yi=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function vi(t){if($r(!!t),"string"==typeof t){var e=0,n=yi.exec(t);if($r(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:mi(t.seconds),nanos:mi(t.nanos)}}function mi(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function gi(t){return"string"==typeof t?pi.fromBase64String(t):pi.fromUint8Array(t)}function bi(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function wi(t){var e=t.mapValue.fields.__previous_value__;return bi(e)?wi(e):e}function Ii(t){var e=vi(t.mapValue.fields.__local_write_time__.timestampValue);return new ii(e.seconds,e.nanos)}function Ti(t){return null==t}function Ei(t){return 0===t&&1/t==-1/0}function _i(t){return"number"==typeof t&&Number.isInteger(t)&&!Ei(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}var Oi=function(){function t(t){this.path=t}return t.fromPath=function(e){return new t(hi.fromString(e))},t.fromName=function(e){return new t(hi.fromString(e).popFirst(5))},t.prototype.hasCollectionId=function(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t},t.prototype.isEqual=function(t){return null!==t&&0===hi.comparator(this.path,t.path)},t.prototype.toString=function(){return this.path.toString()},t.comparator=function(t,e){return hi.comparator(t.path,e.path)},t.isDocumentKey=function(t){return t.length%2==0},t.fromSegments=function(e){return new t(new hi(e.slice()))},t}();function Si(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?bi(t)?4:10:Xr()}function Di(t,e){var n=Si(t);if(n!==Si(e))return!1;switch(n){case 0:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Ii(t).isEqual(Ii(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;var n=vi(t.timestampValue),r=vi(e.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return gi(t.bytesValue).isEqual(gi(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return mi(t.geoPointValue.latitude)===mi(e.geoPointValue.latitude)&&mi(t.geoPointValue.longitude)===mi(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return mi(t.integerValue)===mi(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=mi(t.doubleValue),r=mi(e.doubleValue);return n===r?Ei(n)===Ei(r):isNaN(n)&&isNaN(r)}return!1}(t,e);case 9:return ni(t.arrayValue.values||[],e.arrayValue.values||[],Di);case 10:return function(t,e){var n=t.mapValue.fields||{},r=e.mapValue.fields||{};if(si(n)!==si(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!Di(n[i],r[i])))return!1;return!0}(t,e);default:return Xr()}}function Ni(t,e){return void 0!==(t.values||[]).find(function(t){return Di(t,e)})}function Ai(t,e){var n=Si(t),r=Si(e);if(n!==r)return ei(n,r);switch(n){case 0:return 0;case 1:return ei(t.booleanValue,e.booleanValue);case 2:return function(t,e){var n=mi(t.integerValue||t.doubleValue),r=mi(e.integerValue||e.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(t,e);case 3:return ki(t.timestampValue,e.timestampValue);case 4:return ki(Ii(t),Ii(e));case 5:return ei(t.stringValue,e.stringValue);case 6:return function(t,e){var n=gi(t),r=gi(e);return n.compareTo(r)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=ei(n[i],r[i]);if(0!==o)return o}return ei(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){var n=ei(mi(t.latitude),mi(e.latitude));return 0!==n?n:ei(mi(t.longitude),mi(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=Ai(n[i],r[i]);if(o)return o}return ei(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var a=ei(r[s],o[s]);if(0!==a)return a;var u=Ai(n[r[s]],i[o[s]]);if(0!==u)return u}return ei(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Xr()}}function ki(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return ei(t,e);var n=vi(t),r=vi(e),i=ei(n.seconds,r.seconds);return 0!==i?i:ei(n.nanos,r.nanos)}function xi(t){return Ci(t)}function Ci(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){var e=vi(t);return"time("+e.seconds+","+e.nanos+")"}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?gi(t.bytesValue).toBase64():"referenceValue"in t?Oi.fromName(t.referenceValue).toString():"geoPointValue"in t?"geo("+(e=t.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in t?function(t){for(var e="[",n=!0,r=0,i=t.values||[];r<i.length;r++)n?n=!1:e+=",",e+=Ci(i[r]);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+Ci(t.fields[o])}return e+"}"}(t.mapValue):Xr();var e}function ji(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.canonicalString()}}function Ri(t){return!!t&&"integerValue"in t}function Pi(t){return!!t&&"arrayValue"in t}function Li(t){return!!t&&"nullValue"in t}function Vi(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Ui(t){return!!t&&"mapValue"in t}function Mi(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue)return{timestampValue:Object.assign({},vi(t.timestampValue))};if(t.mapValue){var e={mapValue:{fields:{}}};return ai(t.mapValue.fields,function(t,n){return e.mapValue.fields[t]=Mi(n)}),e}if(t.arrayValue){for(var n={arrayValue:{values:[]}},r=0;r<(t.arrayValue.values||[]).length;++r)n.arrayValue.values[r]=Mi(t.arrayValue.values[r]);return n}return Object.assign({},t)}var Fi=function(){function t(t){this.value=t}return t.empty=function(){return new t({mapValue:{}})},t.prototype.field=function(t){if(t.isEmpty())return this.value;for(var e=this.value,n=0;n<t.length-1;++n)if(!Ui(e=(e.mapValue.fields||{})[t.get(n)]))return null;return(e=(e.mapValue.fields||{})[t.lastSegment()])||null},t.prototype.set=function(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=Mi(e)},t.prototype.setAll=function(t){var e=this,n=fi.emptyPath(),r={},i=[];t.forEach(function(t,o){if(!n.isImmediateParentOf(o)){var s=e.getFieldsMap(n);e.applyChanges(s,r,i),r={},i=[],n=o.popLast()}t?r[o.lastSegment()]=Mi(t):i.push(o.lastSegment())});var o=this.getFieldsMap(n);this.applyChanges(o,r,i)},t.prototype.delete=function(t){var e=this.field(t.popLast());Ui(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]},t.prototype.isEqual=function(t){return Di(this.value,t.value)},t.prototype.getFieldsMap=function(t){var e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(var n=0;n<t.length;++n){var r=e.mapValue.fields[t.get(n)];Ui(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},e.mapValue.fields[t.get(n)]=r),e=r}return e.mapValue.fields},t.prototype.applyChanges=function(t,e,n){ai(e,function(e,n){return t[e]=n});for(var r=0,i=n;r<i.length;r++)delete t[i[r]]},t.prototype.clone=function(){return new t(Mi(this.value))},t}();function qi(t){var e=[];return ai(t.fields,function(t,n){var r=new fi([t]);if(Ui(n)){var i=qi(n.mapValue).fields;if(0===i.length)e.push(r);else for(var o=0,s=i;o<s.length;o++)e.push(r.child(s[o]))}else e.push(r)}),new di(e)}var Bi=function(){function t(t,e,n,r,i){this.key=t,this.documentType=e,this.version=n,this.data=r,this.documentState=i}return t.newInvalidDocument=function(e){return new t(e,0,oi.min(),Fi.empty(),0)},t.newFoundDocument=function(e,n,r){return new t(e,1,n,r,0)},t.newNoDocument=function(e,n){return new t(e,2,n,Fi.empty(),0)},t.newUnknownDocument=function(e,n){return new t(e,3,n,Fi.empty(),2)},t.prototype.convertToFoundDocument=function(t,e){return this.version=t,this.documentType=1,this.data=e,this.documentState=0,this},t.prototype.convertToNoDocument=function(t){return this.version=t,this.documentType=2,this.data=Fi.empty(),this.documentState=0,this},t.prototype.convertToUnknownDocument=function(t){return this.version=t,this.documentType=3,this.data=Fi.empty(),this.documentState=2,this},t.prototype.setHasCommittedMutations=function(){return this.documentState=2,this},t.prototype.setHasLocalMutations=function(){return this.documentState=1,this},Object.defineProperty(t.prototype,"hasLocalMutations",{get:function(){return 1===this.documentState},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasCommittedMutations",{get:function(){return 2===this.documentState},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return this.hasLocalMutations||this.hasCommittedMutations},enumerable:!1,configurable:!0}),t.prototype.isValidDocument=function(){return 0!==this.documentType},t.prototype.isFoundDocument=function(){return 1===this.documentType},t.prototype.isNoDocument=function(){return 2===this.documentType},t.prototype.isUnknownDocument=function(){return 3===this.documentType},t.prototype.isEqual=function(e){return e instanceof t&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)},t.prototype.clone=function(){return new t(this.key,this.documentType,this.version,this.data.clone(),this.documentState)},t.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+JSON.stringify(this.data.value)+", {documentType: "+this.documentType+"}), {documentState: "+this.documentState+"})"},t}(),Ki=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.h=null};function Gi(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new Ki(t,e,n,r,i,o,s)}function zi(t){var e=Jr(t);if(null===e.h){var n=e.path.canonicalString();null!==e.collectionGroup&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(function(t){return function(t){return t.field.canonicalString()+t.op.toString()+xi(t.value)}(t)}).join(","),n+="|ob:",n+=e.orderBy.map(function(t){return function(t){return t.field.canonicalString()+t.dir}(t)}).join(","),Ti(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=io(e.startAt)),e.endAt&&(n+="|ub:",n+=io(e.endAt)),e.h=n}return e.h}function Qi(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n=0;n<t.orderBy.length;n++)if(!so(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(var r=0;r<t.filters.length;r++)if((i=t.filters[r]).op!==(o=e.filters[r]).op||!i.field.isEqual(o.field)||!Di(i.value,o.value))return!1;var i,o;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!uo(t.startAt,e.startAt)&&uo(t.endAt,e.endAt)}function Hi(t){return Oi.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}var Wi=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).field=e,i.op=n,i.value=r,i}return Object(Fr.c)(e,t),e.create=function(t,n,r){return t.isKeyField()?"in"===n||"not-in"===n?this.l(t,n,r):new Yi(t,n,r):"array-contains"===n?new Zi(t,r):"in"===n?new to(t,r):"not-in"===n?new eo(t,r):"array-contains-any"===n?new no(t,r):new e(t,n,r)},e.l=function(t,e,n){return"in"===e?new Xi(t,n):new $i(t,n)},e.prototype.matches=function(t){var e=t.data.field(this.field);return"!="===this.op?null!==e&&this.m(Ai(e,this.value)):null!==e&&Si(this.value)===Si(e)&&this.m(Ai(e,this.value))},e.prototype.m=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return Xr()}},e.prototype.g=function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0},e}(function(){}),Yi=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,r)||this).key=Oi.fromName(r.referenceValue),i}return Object(Fr.c)(e,t),e.prototype.matches=function(t){var e=Oi.comparator(t.key,this.key);return this.m(e)},e}(Wi),Xi=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"in",n)||this).keys=Ji(0,n),r}return Object(Fr.c)(e,t),e.prototype.matches=function(t){return this.keys.some(function(e){return e.isEqual(t.key)})},e}(Wi),$i=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"not-in",n)||this).keys=Ji(0,n),r}return Object(Fr.c)(e,t),e.prototype.matches=function(t){return!this.keys.some(function(e){return e.isEqual(t.key)})},e}(Wi);function Ji(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map(function(t){return Oi.fromName(t.referenceValue)})}var Zi=function(t){function e(e,n){return t.call(this,e,"array-contains",n)||this}return Object(Fr.c)(e,t),e.prototype.matches=function(t){var e=t.data.field(this.field);return Pi(e)&&Ni(e.arrayValue,this.value)},e}(Wi),to=function(t){function e(e,n){return t.call(this,e,"in",n)||this}return Object(Fr.c)(e,t),e.prototype.matches=function(t){var e=t.data.field(this.field);return null!==e&&Ni(this.value.arrayValue,e)},e}(Wi),eo=function(t){function e(e,n){return t.call(this,e,"not-in",n)||this}return Object(Fr.c)(e,t),e.prototype.matches=function(t){if(Ni(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var e=t.data.field(this.field);return null!==e&&!Ni(this.value.arrayValue,e)},e}(Wi),no=function(t){function e(e,n){return t.call(this,e,"array-contains-any",n)||this}return Object(Fr.c)(e,t),e.prototype.matches=function(t){var e=this,n=t.data.field(this.field);return!(!Pi(n)||!n.arrayValue.values)&&n.arrayValue.values.some(function(t){return Ni(e.value.arrayValue,t)})},e}(Wi),ro=function(t,e){this.position=t,this.before=e};function io(t){return(t.before?"b":"a")+":"+t.position.map(function(t){return xi(t)}).join(",")}var oo=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function so(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}function ao(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i];if(r=o.field.isKeyField()?Oi.comparator(Oi.fromName(s.referenceValue),n.key):Ai(s,n.data.field(o.field)),"desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function uo(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!Di(t.position[n],e.position[n]))return!1;return!0}var co=function(t,e,n,r,i,o,s,a){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===a&&(a=null),this.path=t,this.collectionGroup=e,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=a,this.p=null,this.T=null};function ho(t,e,n,r,i,o,s,a){return new co(t,e,n,r,i,o,s,a)}function lo(t){return new co(t)}function fo(t){return!Ti(t.limit)&&"F"===t.limitType}function po(t){return!Ti(t.limit)&&"L"===t.limitType}function yo(t){return t.explicitOrderBy.length>0?t.explicitOrderBy[0].field:null}function vo(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.g())return r.field}return null}function mo(t){return null!==t.collectionGroup}function go(t){var e=Jr(t);if(null===e.p){e.p=[];var n=vo(e),r=yo(e);if(null!==n&&null===r)n.isKeyField()||e.p.push(new oo(n)),e.p.push(new oo(fi.keyField(),"asc"));else{for(var i=!1,o=0,s=e.explicitOrderBy;o<s.length;o++){var a=s[o];e.p.push(a),a.field.isKeyField()&&(i=!0)}if(!i){var u=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.p.push(new oo(fi.keyField(),u))}}}return e.p}function bo(t){var e=Jr(t);if(!e.T)if("F"===e.limitType)e.T=Gi(e.path,e.collectionGroup,go(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=go(e);r<i.length;r++){var o=i[r];n.push(new oo(o.field,"desc"===o.dir?"asc":"desc"))}var s=e.endAt?new ro(e.endAt.position,!e.endAt.before):null,a=e.startAt?new ro(e.startAt.position,!e.startAt.before):null;e.T=Gi(e.path,e.collectionGroup,n,e.filters,e.limit,s,a)}return e.T}function wo(t,e,n){return new co(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Io(t,e){return Qi(bo(t),bo(e))&&t.limitType===e.limitType}function To(t){return zi(bo(t))+"|lt:"+t.limitType}function Eo(t){return"Query(target="+function(t){var e=t.path.canonicalString();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=", filters: ["+t.filters.map(function(t){return(e=t).field.canonicalString()+" "+e.op+" "+xi(e.value);var e}).join(", ")+"]"),Ti(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=", orderBy: ["+t.orderBy.map(function(t){return function(t){return t.field.canonicalString()+" ("+t.dir+")"}(t)}).join(", ")+"]"),t.startAt&&(e+=", startAt: "+io(t.startAt)),t.endAt&&(e+=", endAt: "+io(t.endAt)),"Target("+e+")"}(bo(t))+"; limitType="+t.limitType+")"}function _o(t,e){return e.isFoundDocument()&&function(t,e){var n=e.key.path;return null!==t.collectionGroup?e.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(n):Oi.isDocumentKey(t.path)?t.path.isEqual(n):t.path.isImmediateParentOf(n)}(t,e)&&function(t,e){for(var n=0,r=t.explicitOrderBy;n<r.length;n++){var i=r[n];if(!i.field.isKeyField()&&null===e.data.field(i.field))return!1}return!0}(t,e)&&function(t,e){for(var n=0,r=t.filters;n<r.length;n++)if(!r[n].matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!ao(t.startAt,go(t),e)||t.endAt&&ao(t.endAt,go(t),e))}(t,e)}function Oo(t){return function(e,n){for(var r=!1,i=0,o=go(t);i<o.length;i++){var s=o[i],a=So(s,e,n);if(0!==a)return a;r=r||s.field.isKeyField()}return 0}}function So(t,e,n){var r=t.field.isKeyField()?Oi.comparator(e.key,n.key):function(t,e,n){var r=e.data.field(t),i=n.data.field(t);return null!==r&&null!==i?Ai(r,i):Xr()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return Xr()}}function Do(t,e){if(t.I){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ei(e)?"-0":e}}function No(t){return{integerValue:""+t}}function Ao(t,e){return _i(e)?No(e):Do(t,e)}var ko=function(){this._=void 0};function xo(t,e,n){return t instanceof Ro?function(t,e){var n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&(n.fields.__previous_value__=e),{mapValue:n}}(n,e):t instanceof Po?Lo(t,e):t instanceof Vo?Uo(t,e):function(t,e){var n=jo(t,e),r=Fo(n)+Fo(t.A);return Ri(n)&&Ri(t.A)?No(r):Do(t.R,r)}(t,e)}function Co(t,e,n){return t instanceof Po?Lo(t,e):t instanceof Vo?Uo(t,e):n}function jo(t,e){return t instanceof Mo?Ri(n=e)||function(t){return!!t&&"doubleValue"in t}(n)?e:{integerValue:0}:null;var n}var Ro=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(Fr.c)(e,t),e}(ko),Po=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return Object(Fr.c)(e,t),e}(ko);function Lo(t,e){for(var n=qo(e),r=function(t){n.some(function(e){return Di(e,t)})||n.push(t)},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var Vo=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return Object(Fr.c)(e,t),e}(ko);function Uo(t,e){for(var n=qo(e),r=function(t){n=n.filter(function(e){return!Di(e,t)})},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var Mo=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).R=e,r.A=n,r}return Object(Fr.c)(e,t),e}(ko);function Fo(t){return mi(t.integerValue||t.doubleValue)}function qo(t){return Pi(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var Bo=function(t,e){this.field=t,this.transform=e},Ko=function(t,e){this.version=t,this.transformResults=e},Go=function(){function t(t,e){this.updateTime=t,this.exists=e}return t.none=function(){return new t},t.exists=function(e){return new t(void 0,e)},t.updateTime=function(e){return new t(e)},Object.defineProperty(t.prototype,"isNone",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},t}();function zo(t,e){return void 0!==t.updateTime?e.isFoundDocument()&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e.isFoundDocument()}var Qo=function(){};function Ho(t,e,n){t instanceof Jo?function(t,e,n){var r=t.value.clone(),i=es(t.fieldTransforms,e,n.transformResults);r.setAll(i),e.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(t,e,n):t instanceof Zo?function(t,e,n){if(zo(t.precondition,e)){var r=es(t.fieldTransforms,e,n.transformResults),i=e.data;i.setAll(ts(t)),i.setAll(r),e.convertToFoundDocument(n.version,i).setHasCommittedMutations()}else e.convertToUnknownDocument(n.version)}(t,e,n):function(t,e,n){e.convertToNoDocument(n.version).setHasCommittedMutations()}(0,e,n)}function Wo(t,e,n){t instanceof Jo?function(t,e,n){if(zo(t.precondition,e)){var r=t.value.clone(),i=ns(t.fieldTransforms,n,e);r.setAll(i),e.convertToFoundDocument($o(e),r).setHasLocalMutations()}}(t,e,n):t instanceof Zo?function(t,e,n){if(zo(t.precondition,e)){var r=ns(t.fieldTransforms,n,e),i=e.data;i.setAll(ts(t)),i.setAll(r),e.convertToFoundDocument($o(e),i).setHasLocalMutations()}}(t,e,n):function(t,e){zo(t.precondition,e)&&e.convertToNoDocument(oi.min())}(t,e)}function Yo(t,e){for(var n=null,r=0,i=t.fieldTransforms;r<i.length;r++){var o=i[r],s=e.data.field(o.field),a=jo(o.transform,s||null);null!=a&&(null==n&&(n=Fi.empty()),n.set(o.field,a))}return n||null}function Xo(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(t,e){return void 0===t&&void 0===e||!(!t||!e)&&ni(t,e,function(t,e){return function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof Po&&e instanceof Po||t instanceof Vo&&e instanceof Vo?ni(t.elements,e.elements,Di):t instanceof Mo&&e instanceof Mo?Di(t.A,e.A):t instanceof Ro&&e instanceof Ro}(t.transform,e.transform)}(t,e)})}(t.fieldTransforms,e.fieldTransforms)&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}function $o(t){return t.isFoundDocument()?t.version:oi.min()}var Jo=function(t){function e(e,n,r,i){void 0===i&&(i=[]);var o=this;return(o=t.call(this)||this).key=e,o.value=n,o.precondition=r,o.fieldTransforms=i,o.type=0,o}return Object(Fr.c)(e,t),e}(Qo),Zo=function(t){function e(e,n,r,i,o){void 0===o&&(o=[]);var s=this;return(s=t.call(this)||this).key=e,s.data=n,s.fieldMask=r,s.precondition=i,s.fieldTransforms=o,s.type=1,s}return Object(Fr.c)(e,t),e}(Qo);function ts(t){var e=new Map;return t.fieldMask.fields.forEach(function(n){if(!n.isEmpty()){var r=t.data.field(n);e.set(n,r)}}),e}function es(t,e,n){var r=new Map;$r(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,a=e.data.field(o.field);r.set(o.field,Co(s,a,n[i]))}return r}function ns(t,e,n){for(var r=new Map,i=0,o=t;i<o.length;i++){var s=o[i],a=s.transform,u=n.data.field(s.field);r.set(s.field,xo(a,u,e))}return r}var rs,is,os=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.precondition=n,r.type=2,r.fieldTransforms=[],r}return Object(Fr.c)(e,t),e}(Qo),ss=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.precondition=n,r.type=3,r.fieldTransforms=[],r}return Object(Fr.c)(e,t),e}(Qo),as=function(t){this.count=t};function us(t){switch(t){case Br.OK:return Xr();case Br.CANCELLED:case Br.UNKNOWN:case Br.DEADLINE_EXCEEDED:case Br.RESOURCE_EXHAUSTED:case Br.INTERNAL:case Br.UNAVAILABLE:case Br.UNAUTHENTICATED:return!1;case Br.INVALID_ARGUMENT:case Br.NOT_FOUND:case Br.ALREADY_EXISTS:case Br.PERMISSION_DENIED:case Br.FAILED_PRECONDITION:case Br.ABORTED:case Br.OUT_OF_RANGE:case Br.UNIMPLEMENTED:case Br.DATA_LOSS:return!0;default:return Xr()}}function cs(t){if(void 0===t)return Hr("GRPC error has no .code"),Br.UNKNOWN;switch(t){case rs.OK:return Br.OK;case rs.CANCELLED:return Br.CANCELLED;case rs.UNKNOWN:return Br.UNKNOWN;case rs.DEADLINE_EXCEEDED:return Br.DEADLINE_EXCEEDED;case rs.RESOURCE_EXHAUSTED:return Br.RESOURCE_EXHAUSTED;case rs.INTERNAL:return Br.INTERNAL;case rs.UNAVAILABLE:return Br.UNAVAILABLE;case rs.UNAUTHENTICATED:return Br.UNAUTHENTICATED;case rs.INVALID_ARGUMENT:return Br.INVALID_ARGUMENT;case rs.NOT_FOUND:return Br.NOT_FOUND;case rs.ALREADY_EXISTS:return Br.ALREADY_EXISTS;case rs.PERMISSION_DENIED:return Br.PERMISSION_DENIED;case rs.FAILED_PRECONDITION:return Br.FAILED_PRECONDITION;case rs.ABORTED:return Br.ABORTED;case rs.OUT_OF_RANGE:return Br.OUT_OF_RANGE;case rs.UNIMPLEMENTED:return Br.UNIMPLEMENTED;case rs.DATA_LOSS:return Br.DATA_LOSS;default:return Xr()}}(is=rs||(rs={}))[is.OK=0]="OK",is[is.CANCELLED=1]="CANCELLED",is[is.UNKNOWN=2]="UNKNOWN",is[is.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",is[is.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",is[is.NOT_FOUND=5]="NOT_FOUND",is[is.ALREADY_EXISTS=6]="ALREADY_EXISTS",is[is.PERMISSION_DENIED=7]="PERMISSION_DENIED",is[is.UNAUTHENTICATED=16]="UNAUTHENTICATED",is[is.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",is[is.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",is[is.ABORTED=10]="ABORTED",is[is.OUT_OF_RANGE=11]="OUT_OF_RANGE",is[is.UNIMPLEMENTED=12]="UNIMPLEMENTED",is[is.INTERNAL=13]="INTERNAL",is[is.UNAVAILABLE=14]="UNAVAILABLE",is[is.DATA_LOSS=15]="DATA_LOSS";var hs=function(){function t(t,e){this.comparator=t,this.root=e||fs.EMPTY}return t.prototype.insert=function(e,n){return new t(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,fs.BLACK,null,null))},t.prototype.remove=function(e){return new t(this.comparator,this.root.remove(e,this.comparator).copy(null,null,fs.BLACK,null,null))},t.prototype.get=function(t){for(var e=this.root;!e.isEmpty();){var n=this.comparator(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null},t.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.isEmpty();){var r=this.comparator(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1},t.prototype.isEmpty=function(){return this.root.isEmpty()},Object.defineProperty(t.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),t.prototype.minKey=function(){return this.root.minKey()},t.prototype.maxKey=function(){return this.root.maxKey()},t.prototype.inorderTraversal=function(t){return this.root.inorderTraversal(t)},t.prototype.forEach=function(t){this.inorderTraversal(function(e,n){return t(e,n),!1})},t.prototype.toString=function(){var t=[];return this.inorderTraversal(function(e,n){return t.push(e+":"+n),!1}),"{"+t.join(", ")+"}"},t.prototype.reverseTraversal=function(t){return this.root.reverseTraversal(t)},t.prototype.getIterator=function(){return new ls(this.root,null,this.comparator,!1)},t.prototype.getIteratorFrom=function(t){return new ls(this.root,t,this.comparator,!1)},t.prototype.getReverseIterator=function(){return new ls(this.root,null,this.comparator,!0)},t.prototype.getReverseIteratorFrom=function(t){return new ls(this.root,t,this.comparator,!0)},t}(),ls=function(){function t(t,e,n,r){this.isReverse=r,this.nodeStack=[];for(var i=1;!t.isEmpty();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.isReverse?t.left:t.right;else{if(0===i){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}return t.prototype.getNext=function(){var t=this.nodeStack.pop(),e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e},t.prototype.hasNext=function(){return this.nodeStack.length>0},t.prototype.peek=function(){if(0===this.nodeStack.length)return null;var t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}},t}(),fs=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:t.EMPTY,this.right=null!=o?o:t.EMPTY,this.size=this.left.size+1+this.right.size}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.isEmpty=function(){return!1},t.prototype.inorderTraversal=function(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)},t.prototype.min=function(){return this.left.isEmpty()?this:this.left.min()},t.prototype.minKey=function(){return this.min().key},t.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},t.prototype.insert=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.insert(t,e,n))).fixUp()},t.prototype.removeMin=function(){if(this.left.isEmpty())return t.EMPTY;var e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),(e=e.copy(null,null,null,e.left.removeMin(),null)).fixUp()},t.prototype.remove=function(e,n){var r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===n(e,i.key)){if(i.right.isEmpty())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()},t.prototype.isRed=function(){return this.color},t.prototype.fixUp=function(){var t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t},t.prototype.moveRedLeft=function(){var t=this.colorFlip();return t.right.left.isRed()&&(t=(t=(t=t.copy(null,null,null,null,t.right.rotateRight())).rotateLeft()).colorFlip()),t},t.prototype.moveRedRight=function(){var t=this.colorFlip();return t.left.left.isRed()&&(t=(t=t.rotateRight()).colorFlip()),t},t.prototype.rotateLeft=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.rotateRight=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.colorFlip=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.checkMaxDepth=function(){var t=this.check();return Math.pow(2,t)<=this.size+1},t.prototype.check=function(){if(this.isRed()&&this.left.isRed())throw Xr();if(this.right.isRed())throw Xr();var t=this.left.check();if(t!==this.right.check())throw Xr();return t+(this.isRed()?0:1)},t}();fs.EMPTY=null,fs.RED=!0,fs.BLACK=!1,fs.EMPTY=new(function(){function t(){this.size=0}return Object.defineProperty(t.prototype,"key",{get:function(){throw Xr()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){throw Xr()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){throw Xr()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){throw Xr()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){throw Xr()},enumerable:!1,configurable:!0}),t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.insert=function(t,e,n){return new fs(t,e)},t.prototype.remove=function(t,e){return this},t.prototype.isEmpty=function(){return!0},t.prototype.inorderTraversal=function(t){return!1},t.prototype.reverseTraversal=function(t){return!1},t.prototype.minKey=function(){return null},t.prototype.maxKey=function(){return null},t.prototype.isRed=function(){return!1},t.prototype.checkMaxDepth=function(){return!0},t.prototype.check=function(){return 0},t}());var ds=function(){function t(t){this.comparator=t,this.data=new hs(this.comparator)}return t.prototype.has=function(t){return null!==this.data.get(t)},t.prototype.first=function(){return this.data.minKey()},t.prototype.last=function(){return this.data.maxKey()},Object.defineProperty(t.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),t.prototype.indexOf=function(t){return this.data.indexOf(t)},t.prototype.forEach=function(t){this.data.inorderTraversal(function(e,n){return t(e),!1})},t.prototype.forEachInRange=function(t,e){for(var n=this.data.getIteratorFrom(t[0]);n.hasNext();){var r=n.getNext();if(this.comparator(r.key,t[1])>=0)return;e(r.key)}},t.prototype.forEachWhile=function(t,e){var n;for(n=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return},t.prototype.firstAfterOrEqual=function(t){var e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null},t.prototype.getIterator=function(){return new ps(this.data.getIterator())},t.prototype.getIteratorFrom=function(t){return new ps(this.data.getIteratorFrom(t))},t.prototype.add=function(t){return this.copy(this.data.remove(t).insert(t,!0))},t.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},t.prototype.isEmpty=function(){return this.data.isEmpty()},t.prototype.unionWith=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.data.getIterator(),r=e.data.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(0!==this.comparator(i,o))return!1}return!0},t.prototype.toArray=function(){var t=[];return this.forEach(function(e){t.push(e)}),t},t.prototype.toString=function(){var t=[];return this.forEach(function(e){return t.push(e)}),"SortedSet("+t.toString()+")"},t.prototype.copy=function(e){var n=new t(this.comparator);return n.data=e,n},t}(),ps=function(){function t(t){this.iter=t}return t.prototype.getNext=function(){return this.iter.getNext().key},t.prototype.hasNext=function(){return this.iter.hasNext()},t}(),ys=new hs(Oi.comparator);function vs(){return ys}var ms=new hs(Oi.comparator);function gs(){return ms}var bs=new hs(Oi.comparator);function ws(){return bs}var Is=new ds(Oi.comparator);function Ts(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Is,r=0,i=t;r<i.length;r++){var o=i[r];n=n.add(o)}return n}var Es=new ds(ei);function _s(){return Es}var Os=function(){function t(t,e,n,r,i){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}return t.createSynthesizedRemoteEventForCurrentChange=function(e,n){var r=new Map;return r.set(e,Ss.createSynthesizedTargetChangeForCurrentChange(e,n)),new t(oi.min(),r,_s(),vs(),Ts())},t}(),Ss=function(){function t(t,e,n,r,i){this.resumeToken=t,this.current=e,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}return t.createSynthesizedTargetChangeForCurrentChange=function(e,n){return new t(pi.EMPTY_BYTE_STRING,n,Ts(),Ts(),Ts())},t}(),Ds=function(t,e,n,r){this.v=t,this.removedTargetIds=e,this.key=n,this.P=r},Ns=function(t,e){this.targetId=t,this.V=e},As=function(t,e,n,r){void 0===n&&(n=pi.EMPTY_BYTE_STRING),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},ks=function(){function t(){this.S=0,this.D=js(),this.C=pi.EMPTY_BYTE_STRING,this.N=!1,this.F=!0}return Object.defineProperty(t.prototype,"current",{get:function(){return this.N},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"resumeToken",{get:function(){return this.C},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"k",{get:function(){return 0!==this.S},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"$",{get:function(){return this.F},enumerable:!1,configurable:!0}),t.prototype.O=function(t){t.approximateByteSize()>0&&(this.F=!0,this.C=t)},t.prototype.M=function(){var t=Ts(),e=Ts(),n=Ts();return this.D.forEach(function(r,i){switch(i){case 0:t=t.add(r);break;case 2:e=e.add(r);break;case 1:n=n.add(r);break;default:Xr()}}),new Ss(this.C,this.N,t,e,n)},t.prototype.L=function(){this.F=!1,this.D=js()},t.prototype.B=function(t,e){this.F=!0,this.D=this.D.insert(t,e)},t.prototype.q=function(t){this.F=!0,this.D=this.D.remove(t)},t.prototype.U=function(){this.S+=1},t.prototype.K=function(){this.S-=1},t.prototype.j=function(){this.F=!0,this.N=!0},t}(),xs=function(){function t(t){this.W=t,this.G=new Map,this.H=vs(),this.J=Cs(),this.Y=new ds(ei)}return t.prototype.X=function(t){for(var e=0,n=t.v;e<n.length;e++){var r=n[e];t.P&&t.P.isFoundDocument()?this.Z(r,t.P):this.tt(r,t.key,t.P)}for(var i=0,o=t.removedTargetIds;i<o.length;i++)this.tt(r=o[i],t.key,t.P)},t.prototype.et=function(t){var e=this;this.forEachTarget(t,function(n){var r=e.nt(n);switch(t.state){case 0:e.st(n)&&r.O(t.resumeToken);break;case 1:r.K(),r.k||r.L(),r.O(t.resumeToken);break;case 2:r.K(),r.k||e.removeTarget(n);break;case 3:e.st(n)&&(r.j(),r.O(t.resumeToken));break;case 4:e.st(n)&&(e.it(n),r.O(t.resumeToken));break;default:Xr()}})},t.prototype.forEachTarget=function(t,e){var n=this;t.targetIds.length>0?t.targetIds.forEach(e):this.G.forEach(function(t,r){n.st(r)&&e(r)})},t.prototype.rt=function(t){var e=t.targetId,n=t.V.count,r=this.ot(e);if(r){var i=r.target;if(Hi(i))if(0===n){var o=new Oi(i.path);this.tt(e,o,Bi.newNoDocument(o,oi.min()))}else $r(1===n);else this.ct(e)!==n&&(this.it(e),this.Y=this.Y.add(e))}},t.prototype.ut=function(t){var e=this,n=new Map;this.G.forEach(function(r,i){var o=e.ot(i);if(o){if(r.current&&Hi(o.target)){var s=new Oi(o.target.path);null!==e.H.get(s)||e.at(i,s)||e.tt(i,s,Bi.newNoDocument(s,t))}r.$&&(n.set(i,r.M()),r.L())}});var r=Ts();this.J.forEach(function(t,n){var i=!0;n.forEachWhile(function(t){var n=e.ot(t);return!n||2===n.purpose||(i=!1,!1)}),i&&(r=r.add(t))});var i=new Os(t,n,this.Y,this.H,r);return this.H=vs(),this.J=Cs(),this.Y=new ds(ei),i},t.prototype.Z=function(t,e){if(this.st(t)){var n=this.at(t,e.key)?2:0;this.nt(t).B(e.key,n),this.H=this.H.insert(e.key,e),this.J=this.J.insert(e.key,this.ht(e.key).add(t))}},t.prototype.tt=function(t,e,n){if(this.st(t)){var r=this.nt(t);this.at(t,e)?r.B(e,1):r.q(e),this.J=this.J.insert(e,this.ht(e).delete(t)),n&&(this.H=this.H.insert(e,n))}},t.prototype.removeTarget=function(t){this.G.delete(t)},t.prototype.ct=function(t){var e=this.nt(t).M();return this.W.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size},t.prototype.U=function(t){this.nt(t).U()},t.prototype.nt=function(t){var e=this.G.get(t);return e||(e=new ks,this.G.set(t,e)),e},t.prototype.ht=function(t){var e=this.J.get(t);return e||(e=new ds(ei),this.J=this.J.insert(t,e)),e},t.prototype.st=function(t){var e=null!==this.ot(t);return e||Qr("WatchChangeAggregator","Detected inactive target",t),e},t.prototype.ot=function(t){var e=this.G.get(t);return e&&e.k?null:this.W.lt(t)},t.prototype.it=function(t){var e=this;this.G.set(t,new ks),this.W.getRemoteKeysForTarget(t).forEach(function(n){e.tt(t,n,null)})},t.prototype.at=function(t,e){return this.W.getRemoteKeysForTarget(t).has(e)},t}();function Cs(){return new hs(Oi.comparator)}function js(){return new hs(Oi.comparator)}var Rs={asc:"ASCENDING",desc:"DESCENDING"},Ps={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Ls=function(t,e){this.databaseId=t,this.I=e};function Vs(t,e){return t.I?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function Us(t,e){return t.I?e.toBase64():e.toUint8Array()}function Ms(t,e){return Vs(t,e.toTimestamp())}function Fs(t){return $r(!!t),oi.fromTimestamp(function(t){var e=vi(t);return new ii(e.seconds,e.nanos)}(t))}function qs(t,e){return function(t){return new hi(["projects",t.projectId,"databases",t.database])}(t).child("documents").child(e).canonicalString()}function Bs(t){var e=hi.fromString(t);return $r(fa(e)),e}function Ks(t,e){return qs(t.databaseId,e.path)}function Gs(t,e){var n=Bs(e);if(n.get(1)!==t.databaseId.projectId)throw new Kr(Br.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new Kr(Br.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new Oi(Ws(n))}function zs(t,e){return qs(t.databaseId,e)}function Qs(t){var e=Bs(t);return 4===e.length?hi.emptyPath():Ws(e)}function Hs(t){return new hi(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Ws(t){return $r(t.length>4&&"documents"===t.get(4)),t.popFirst(5)}function Ys(t,e,n){return{name:Ks(t,e),fields:n.value.mapValue.fields}}function Xs(t,e,n){var r=Gs(t,e.name),i=Fs(e.updateTime),o=new Fi({mapValue:{fields:e.fields}}),s=Bi.newFoundDocument(r,i,o);return n&&s.setHasCommittedMutations(),n?s.setHasCommittedMutations():s}function $s(t,e){var n;if(e instanceof Jo)n={update:Ys(t,e.key,e.value)};else if(e instanceof os)n={delete:Ks(t,e.key)};else if(e instanceof Zo)n={update:Ys(t,e.key,e.data),updateMask:la(e.fieldMask)};else{if(!(e instanceof ss))return Xr();n={verify:Ks(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(function(t){return function(t,e){var n=e.transform;if(n instanceof Ro)return{fieldPath:e.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof Po)return{fieldPath:e.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof Vo)return{fieldPath:e.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof Mo)return{fieldPath:e.field.canonicalString(),increment:n.A};throw Xr()}(0,t)})),e.precondition.isNone||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:Ms(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:Xr()}(t,e.precondition)),n}function Js(t,e){var n=e.currentDocument?function(t){return void 0!==t.updateTime?Go.updateTime(Fs(t.updateTime)):void 0!==t.exists?Go.exists(t.exists):Go.none()}(e.currentDocument):Go.none(),r=e.updateTransforms?e.updateTransforms.map(function(e){return function(t,e){var n=null;"setToServerValue"in e?($r("REQUEST_TIME"===e.setToServerValue),n=new Ro):"appendMissingElements"in e?n=new Po(e.appendMissingElements.values||[]):"removeAllFromArray"in e?n=new Vo(e.removeAllFromArray.values||[]):"increment"in e?n=new Mo(t,e.increment):Xr();var r=fi.fromServerFormat(e.fieldPath);return new Bo(r,n)}(t,e)}):[];if(e.update){var i=Gs(t,e.update.name),o=new Fi({mapValue:{fields:e.update.fields}});if(e.updateMask){var s=function(t){return new di((t.fieldPaths||[]).map(function(t){return fi.fromServerFormat(t)}))}(e.updateMask);return new Zo(i,o,s,n,r)}return new Jo(i,o,n,r)}if(e.delete){var a=Gs(t,e.delete);return new os(a,n)}if(e.verify){var u=Gs(t,e.verify);return new ss(u,n)}return Xr()}function Zs(t,e){return{documents:[zs(t,e.path)]}}function ta(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=zs(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=zs(t,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);var i=function(t){if(0!==t.length){var e=t.map(function(t){return function(t){if("=="===t.op){if(Vi(t.value))return{unaryFilter:{field:aa(t.field),op:"IS_NAN"}};if(Li(t.value))return{unaryFilter:{field:aa(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Vi(t.value))return{unaryFilter:{field:aa(t.field),op:"IS_NOT_NAN"}};if(Li(t.value))return{unaryFilter:{field:aa(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:aa(t.field),op:sa(t.op),value:t.value}}}(t)});return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);i&&(n.structuredQuery.where=i);var o=function(t){if(0!==t.length)return t.map(function(t){return function(t){return{field:aa(t.field),direction:oa(t.dir)}}(t)})}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var s=function(t,e){return t.I||Ti(e)?e:{value:e}}(t,e.limit);return null!==s&&(n.structuredQuery.limit=s),e.startAt&&(n.structuredQuery.startAt=ra(e.startAt)),e.endAt&&(n.structuredQuery.endAt=ra(e.endAt)),n}function ea(t){var e=Qs(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){$r(1===r);var o=n.from[0];o.allDescendants?i=o.collectionId:e=e.child(o.collectionId)}var s=[];n.where&&(s=na(n.where));var a=[];n.orderBy&&(a=n.orderBy.map(function(t){return function(t){return new oo(ua(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}(t)}));var u=null;n.limit&&(u=function(t){var e;return Ti(e="object"==typeof t?t.value:t)?null:e}(n.limit));var c=null;n.startAt&&(c=ia(n.startAt));var h=null;return n.endAt&&(h=ia(n.endAt)),ho(e,i,a,s,u,"F",c,h)}function na(t){return t?void 0!==t.unaryFilter?[ha(t)]:void 0!==t.fieldFilter?[ca(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map(function(t){return na(t)}).reduce(function(t,e){return t.concat(e)}):Xr():[]}function ra(t){return{before:t.before,values:t.position}}function ia(t){return new ro(t.values||[],!!t.before)}function oa(t){return Rs[t]}function sa(t){return Ps[t]}function aa(t){return{fieldPath:t.canonicalString()}}function ua(t){return fi.fromServerFormat(t.fieldPath)}function ca(t){return Wi.create(ua(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return Xr()}}(t.fieldFilter.op),t.fieldFilter.value)}function ha(t){switch(t.unaryFilter.op){case"IS_NAN":var e=ua(t.unaryFilter.field);return Wi.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=ua(t.unaryFilter.field);return Wi.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=ua(t.unaryFilter.field);return Wi.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=ua(t.unaryFilter.field);return Wi.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return Xr()}}function la(t){var e=[];return t.fields.forEach(function(t){return e.push(t.canonicalString())}),{fieldPaths:e}}function fa(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}function da(t){for(var e="",n=0;n<t.length;n++)e.length>0&&(e=ya(e)),e=pa(t.get(n),e);return ya(e)}function pa(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="\x01\x10";break;case"\x01":n+="\x01\x11";break;default:n+=o}}return n}function ya(t){return t+"\x01\x01"}function va(t){var e=t.length;if($r(e>=2),2===e)return $r("\x01"===t.charAt(0)&&"\x01"===t.charAt(1)),hi.emptyPath();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("\x01",o);switch((s<0||s>n)&&Xr(),t.charAt(s+1)){case"\x01":var a=t.substring(o,s),u=void 0;0===i.length?u=a:(u=i+=a,i=""),r.push(u);break;case"\x10":i+=t.substring(o,s),i+="\0";break;case"\x11":i+=t.substring(o,s+1);break;default:Xr()}o=s+2}return new hi(r)}var ma=function(t,e){this.seconds=t,this.nanoseconds=e},ga=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};ga.store="owner",ga.key="owner";var ba=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};ba.store="mutationQueues",ba.keyPath="userId";var wa=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};wa.store="mutations",wa.keyPath="batchId",wa.userMutationsIndex="userMutationsIndex",wa.userMutationsKeyPath=["userId","batchId"];var Ia=function(){function t(){}return t.prefixForUser=function(t){return[t]},t.prefixForPath=function(t,e){return[t,da(e)]},t.key=function(t,e,n){return[t,da(e),n]},t}();Ia.store="documentMutations",Ia.PLACEHOLDER=new Ia;var Ta=function(t,e){this.path=t,this.readTime=e},Ea=function(t,e){this.path=t,this.version=e},_a=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};_a.store="remoteDocuments",_a.readTimeIndex="readTimeIndex",_a.readTimeIndexPath="readTime",_a.collectionReadTimeIndex="collectionReadTimeIndex",_a.collectionReadTimeIndexPath=["parentPath","readTime"];var Oa=function(t){this.byteSize=t};Oa.store="remoteDocumentGlobal",Oa.key="remoteDocumentGlobalKey";var Sa=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};Sa.store="targets",Sa.keyPath="targetId",Sa.queryTargetsIndexName="queryTargetsIndex",Sa.queryTargetsKeyPath=["canonicalId","targetId"];var Da=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};Da.store="targetDocuments",Da.keyPath=["targetId","path"],Da.documentTargetsIndex="documentTargetsIndex",Da.documentTargetsKeyPath=["path","targetId"];var Na=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};Na.key="targetGlobalKey",Na.store="targetGlobal";var Aa=function(t,e){this.collectionId=t,this.parent=e};Aa.store="collectionParents",Aa.keyPath=["collectionId","parent"];var ka=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};ka.store="clientMetadata",ka.keyPath="clientId";var xa=function(t,e,n){this.bundleId=t,this.createTime=e,this.version=n};xa.store="bundles",xa.keyPath="bundleId";var Ca=function(t,e,n){this.name=t,this.readTime=e,this.bundledQuery=n};Ca.store="namedQueries",Ca.keyPath="name";var ja=Object(Fr.f)(Object(Fr.f)([],Object(Fr.f)(Object(Fr.f)([],Object(Fr.f)(Object(Fr.f)([],Object(Fr.f)(Object(Fr.f)([],[ba.store,wa.store,Ia.store,_a.store,Sa.store,ga.store,Na.store,Da.store]),[ka.store])),[Oa.store])),[Aa.store])),[xa.store,Ca.store]),Ra="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Pa=function(){function t(){this.onCommittedListeners=[]}return t.prototype.addOnCommittedListener=function(t){this.onCommittedListeners.push(t)},t.prototype.raiseOnCommittedEvent=function(){this.onCommittedListeners.forEach(function(t){return t()})},t}(),La=function(){var t=this;this.promise=new Promise(function(e,n){t.resolve=e,t.reject=n})},Va=function(){function t(t){var e=this;this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(function(t){e.isDone=!0,e.result=t,e.nextCallback&&e.nextCallback(t)},function(t){e.isDone=!0,e.error=t,e.catchCallback&&e.catchCallback(t)})}return t.prototype.catch=function(t){return this.next(void 0,t)},t.prototype.next=function(e,n){var r=this;return this.callbackAttached&&Xr(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new t(function(t,i){r.nextCallback=function(n){r.wrapSuccess(e,n).next(t,i)},r.catchCallback=function(e){r.wrapFailure(n,e).next(t,i)}})},t.prototype.toPromise=function(){var t=this;return new Promise(function(e,n){t.next(e,n)})},t.prototype.wrapUserFunction=function(e){try{var n=e();return n instanceof t?n:t.resolve(n)}catch(e){return t.reject(e)}},t.prototype.wrapSuccess=function(e,n){return e?this.wrapUserFunction(function(){return e(n)}):t.resolve(n)},t.prototype.wrapFailure=function(e,n){return e?this.wrapUserFunction(function(){return e(n)}):t.reject(n)},t.resolve=function(e){return new t(function(t,n){t(e)})},t.reject=function(e){return new t(function(t,n){n(e)})},t.waitFor=function(e){return new t(function(t,n){var r=0,i=0,o=!1;e.forEach(function(e){++r,e.next(function(){++i,o&&i===r&&t()},function(t){return n(t)})}),o=!0,i===r&&t()})},t.or=function(e){for(var n=t.resolve(!1),r=function(e){n=n.next(function(n){return n?t.resolve(n):e()})},i=0,o=e;i<o.length;i++)r(o[i]);return n},t.forEach=function(t,e){var n=this,r=[];return t.forEach(function(t,i){r.push(e.call(n,t,i))}),this.waitFor(r)},t}(),Ua=function(){function t(t,e){var n=this;this.action=t,this.transaction=e,this.aborted=!1,this.ft=new La,this.transaction.oncomplete=function(){n.ft.resolve()},this.transaction.onabort=function(){e.error?n.ft.reject(new qa(t,e.error)):n.ft.resolve()},this.transaction.onerror=function(e){var r=Qa(e.target.error);n.ft.reject(new qa(t,r))}}return t.open=function(e,n,r,i){try{return new t(n,e.transaction(i,r))}catch(e){throw new qa(n,e)}},Object.defineProperty(t.prototype,"dt",{get:function(){return this.ft.promise},enumerable:!1,configurable:!0}),t.prototype.abort=function(t){t&&this.ft.reject(t),this.aborted||(Qr("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},t.prototype.store=function(t){var e=this.transaction.objectStore(t);return new Ka(e)},t}(),Ma=function(){function t(e,n,r){this.name=e,this.version=n,this.wt=r,12.2===t._t(Object(A.j)())&&Hr("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return t.delete=function(t){return Qr("SimpleDb","Removing database:",t),Ga(window.indexedDB.deleteDatabase(t)).toPromise()},t.yt=function(){if("undefined"==typeof indexedDB)return!1;if(t.gt())return!0;var e=Object(A.j)(),n=t._t(e),r=0<n&&n<10,i=t.Et(e),o=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||o)},t.gt=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.Tt)},t.It=function(t,e){return t.store(e)},t._t=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},t.Et=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},t.prototype.At=function(t){return Object(Fr.b)(this,void 0,void 0,function(){var e,n=this;return Object(Fr.d)(this,function(r){switch(r.label){case 0:return this.db?[3,2]:(Qr("SimpleDb","Opening database:",this.name),e=this,[4,new Promise(function(e,r){var i=indexedDB.open(n.name,n.version);i.onsuccess=function(t){e(t.target.result)},i.onblocked=function(){r(new qa(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(e){var n=e.target.error;r("VersionError"===n.name?new Kr(Br.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh."):new qa(t,n))},i.onupgradeneeded=function(t){Qr("SimpleDb",'Database "'+n.name+'" requires upgrade from version:',t.oldVersion),n.wt.Rt(t.target.result,i.transaction,t.oldVersion,n.version).next(function(){Qr("SimpleDb","Database upgrade to version "+n.version+" complete")})}})]);case 1:e.db=r.sent(),r.label=2;case 2:return[2,(this.bt&&(this.db.onversionchange=function(t){return n.bt(t)}),this.db)]}})})},t.prototype.vt=function(t){this.bt=t,this.db&&(this.db.onversionchange=function(e){return t(e)})},t.prototype.runTransaction=function(t,e,n,r){return Object(Fr.b)(this,void 0,void 0,function(){var i,o,s,a,u;return Object(Fr.d)(this,function(c){switch(c.label){case 0:i="readonly"===e,o=0,s=function(){var e,s,u,c,h;return Object(Fr.d)(this,function(l){switch(l.label){case 0:++o,l.label=1;case 1:return l.trys.push([1,4,,5]),[4,a.At(t)];case 2:return a.db=l.sent(),e=Ua.open(a.db,t,i?"readonly":"readwrite",n),s=r(e).catch(function(t){return e.abort(t),Va.reject(t)}).toPromise(),u={},s.catch(function(){}),[4,e.dt];case 3:return[2,(u.value=(l.sent(),s),u)];case 4:return Qr("SimpleDb","Transaction failed with error:",(c=l.sent()).message,"Retrying:",h="FirebaseError"!==c.name&&o<3),a.close(),h?[3,5]:[2,{value:Promise.reject(c)}];case 5:return[2]}})},a=this,c.label=1;case 1:return[5,s()];case 2:if("object"==typeof(u=c.sent()))return[2,u.value];c.label=3;case 3:return[3,1];case 4:return[2]}})})},t.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},t}(),Fa=function(){function t(t){this.Pt=t,this.Vt=!1,this.St=null}return Object.defineProperty(t.prototype,"isDone",{get:function(){return this.Vt},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Dt",{get:function(){return this.St},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cursor",{set:function(t){this.Pt=t},enumerable:!1,configurable:!0}),t.prototype.done=function(){this.Vt=!0},t.prototype.Ct=function(t){this.St=t},t.prototype.delete=function(){return Ga(this.Pt.delete())},t}(),qa=function(t){function e(e,n){var r=this;return(r=t.call(this,Br.UNAVAILABLE,"IndexedDB transaction '"+e+"' failed: "+n)||this).name="IndexedDbTransactionError",r}return Object(Fr.c)(e,t),e}(Kr);function Ba(t){return"IndexedDbTransactionError"===t.name}var Ka=function(){function t(t){this.store=t}return t.prototype.put=function(t,e){var n;return void 0!==e?(Qr("SimpleDb","PUT",this.store.name,t,e),n=this.store.put(e,t)):(Qr("SimpleDb","PUT",this.store.name,"<auto-key>",t),n=this.store.put(t)),Ga(n)},t.prototype.add=function(t){return Qr("SimpleDb","ADD",this.store.name,t,t),Ga(this.store.add(t))},t.prototype.get=function(t){var e=this;return Ga(this.store.get(t)).next(function(n){return void 0===n&&(n=null),Qr("SimpleDb","GET",e.store.name,t,n),n})},t.prototype.delete=function(t){return Qr("SimpleDb","DELETE",this.store.name,t),Ga(this.store.delete(t))},t.prototype.count=function(){return Qr("SimpleDb","COUNT",this.store.name),Ga(this.store.count())},t.prototype.Nt=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.xt(n,function(t,e){r.push(e)}).next(function(){return r})},t.prototype.Ft=function(t,e){Qr("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.kt=!1;var r=this.cursor(n);return this.xt(r,function(t,e,n){return n.delete()})},t.prototype.$t=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.xt(r,e)},t.prototype.Ot=function(t){var e=this.cursor({});return new Va(function(n,r){e.onerror=function(t){var e=Qa(t.target.error);r(e)},e.onsuccess=function(e){var r=e.target.result;r?t(r.primaryKey,r.value).next(function(t){t?r.continue():n()}):n()}})},t.prototype.xt=function(t,e){var n=[];return new Va(function(r,i){t.onerror=function(t){i(t.target.error)},t.onsuccess=function(t){var i=t.target.result;if(i){var o=new Fa(i),s=e(i.primaryKey,i.value,o);if(s instanceof Va){var a=s.catch(function(t){return o.done(),Va.reject(t)});n.push(a)}o.isDone?r():null===o.Dt?i.continue():i.continue(o.Dt)}else r()}}).next(function(){return Va.waitFor(n)})},t.prototype.options=function(t,e){var n;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},t.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.kt?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},t}();function Ga(t){return new Va(function(e,n){t.onsuccess=function(t){e(t.target.result)},t.onerror=function(t){var e=Qa(t.target.error);n(e)}})}var za=!1;function Qa(t){var e=Ma._t(Object(A.j)());if(e>=12.2&&e<13){var n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){var r=new Kr("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return za||(za=!0,setTimeout(function(){throw r},0)),r}}return t}var Ha=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Mt=e,r.currentSequenceNumber=n,r}return Object(Fr.c)(e,t),e}(Pa);function Wa(t,e){var n=Jr(t);return Ma.It(n.Mt,e)}var Ya=function(){function t(t,e,n,r){this.batchId=t,this.localWriteTime=e,this.baseMutations=n,this.mutations=r}return t.prototype.applyToRemoteDocument=function(t,e){for(var n=e.mutationResults,r=0;r<this.mutations.length;r++){var i=this.mutations[r];i.key.isEqual(t.key)&&Ho(i,t,n[r])}},t.prototype.applyToLocalView=function(t){for(var e=0,n=this.baseMutations;e<n.length;e++)(o=n[e]).key.isEqual(t.key)&&Wo(o,t,this.localWriteTime);for(var r=0,i=this.mutations;r<i.length;r++){var o;(o=i[r]).key.isEqual(t.key)&&Wo(o,t,this.localWriteTime)}},t.prototype.applyToLocalDocumentSet=function(t){var e=this;this.mutations.forEach(function(n){var r=t.get(n.key),i=r;e.applyToLocalView(i),r.isValidDocument()||i.convertToNoDocument(oi.min())})},t.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},Ts())},t.prototype.isEqual=function(t){return this.batchId===t.batchId&&ni(this.mutations,t.mutations,function(t,e){return Xo(t,e)})&&ni(this.baseMutations,t.baseMutations,function(t,e){return Xo(t,e)})},t}(),Xa=function(){function t(t,e,n,r){this.batch=t,this.commitVersion=e,this.mutationResults=n,this.docVersions=r}return t.from=function(e,n,r){$r(e.mutations.length===r.length);for(var i=ws(),o=e.mutations,s=0;s<o.length;s++)i=i.insert(o[s].key,r[s].version);return new t(e,n,r,i)},t}(),$a=function(){function t(t,e,n,r,i,o,s){void 0===i&&(i=oi.min()),void 0===o&&(o=oi.min()),void 0===s&&(s=pi.EMPTY_BYTE_STRING),this.target=t,this.targetId=e,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}return t.prototype.withSequenceNumber=function(e){return new t(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)},t.prototype.withResumeToken=function(e,n){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)},t.prototype.withLastLimboFreeSnapshotVersion=function(e){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)},t}(),Ja=function(t){this.Lt=t};function Za(t,e){if(e.document)return Xs(t.Lt,e.document,!!e.hasCommittedMutations);if(e.noDocument){var n=Oi.fromSegments(e.noDocument.path),r=iu(e.noDocument.readTime),i=Bi.newNoDocument(n,r);return e.hasCommittedMutations?i.setHasCommittedMutations():i}if(e.unknownDocument){var o=Oi.fromSegments(e.unknownDocument.path);return r=iu(e.unknownDocument.version),Bi.newUnknownDocument(o,r)}return Xr()}function tu(t,e,n){var r=eu(n),i=e.key.path.popLast().toArray();if(e.isFoundDocument()){var o=function(t,e){return{name:Ks(t,e.key),fields:e.data.value.mapValue.fields,updateTime:Vs(t,e.version.toTimestamp())}}(t.Lt,e),s=e.hasCommittedMutations;return new _a(null,null,o,s,r,i)}if(e.isNoDocument()){var a=e.key.path.toArray(),u=ru(e.version);return s=e.hasCommittedMutations,new _a(null,new Ta(a,u),null,s,r,i)}if(e.isUnknownDocument()){var c=e.key.path.toArray(),h=ru(e.version);return new _a(new Ea(c,h),null,null,!0,r,i)}return Xr()}function eu(t){var e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function nu(t){var e=new ii(t[0],t[1]);return oi.fromTimestamp(e)}function ru(t){var e=t.toTimestamp();return new ma(e.seconds,e.nanoseconds)}function iu(t){var e=new ii(t.seconds,t.nanoseconds);return oi.fromTimestamp(e)}function ou(t,e){for(var n=(e.baseMutations||[]).map(function(e){return Js(t.Lt,e)}),r=0;r<e.mutations.length-1;++r)r+1<e.mutations.length&&void 0!==e.mutations[r+1].transform&&(e.mutations[r].updateTransforms=e.mutations[r+1].transform.fieldTransforms,e.mutations.splice(r+1,1),++r);var i=e.mutations.map(function(e){return Js(t.Lt,e)}),o=ii.fromMillis(e.localWriteTimeMs);return new Ya(e.batchId,o,n,i)}function su(t){var e,n,r=iu(t.readTime),i=void 0!==t.lastLimboFreeSnapshotVersion?iu(t.lastLimboFreeSnapshotVersion):oi.min();return void 0!==t.query.documents?($r(1===(n=t.query).documents.length),e=bo(lo(Qs(n.documents[0])))):e=function(t){return bo(ea(t))}(t.query),new $a(e,t.targetId,0,t.lastListenSequenceNumber,r,i,pi.fromBase64String(t.resumeToken))}function au(t,e){var n,r=ru(e.snapshotVersion),i=ru(e.lastLimboFreeSnapshotVersion);n=Hi(e.target)?Zs(t.Lt,e.target):ta(t.Lt,e.target);var o=e.resumeToken.toBase64();return new Sa(e.targetId,zi(e.target),r,o,e.sequenceNumber,i,n)}function uu(t){var e=ea({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?wo(e,e.limit,"L"):e}var cu=function(){function t(){}return t.prototype.getBundleMetadata=function(t,e){return hu(t).get(e).next(function(t){if(t)return{id:(e=t).bundleId,createTime:iu(e.createTime),version:e.version};var e})},t.prototype.saveBundleMetadata=function(t,e){return hu(t).put({bundleId:(n=e).id,createTime:ru(Fs(n.createTime)),version:n.version});var n},t.prototype.getNamedQuery=function(t,e){return lu(t).get(e).next(function(t){if(t)return{name:(e=t).name,query:uu(e.bundledQuery),readTime:iu(e.readTime)};var e})},t.prototype.saveNamedQuery=function(t,e){return lu(t).put(function(t){return{name:t.name,readTime:ru(Fs(t.readTime)),bundledQuery:t.bundledQuery}}(e))},t}();function hu(t){return Wa(t,xa.store)}function lu(t){return Wa(t,Ca.store)}var fu=function(){function t(){this.Bt=new du}return t.prototype.addToCollectionParentIndex=function(t,e){return this.Bt.add(e),Va.resolve()},t.prototype.getCollectionParents=function(t,e){return Va.resolve(this.Bt.getEntries(e))},t}(),du=function(){function t(){this.index={}}return t.prototype.add=function(t){var e=t.lastSegment(),n=t.popLast(),r=this.index[e]||new ds(hi.comparator),i=!r.has(n);return this.index[e]=r.add(n),i},t.prototype.has=function(t){var e=t.lastSegment(),n=t.popLast(),r=this.index[e];return r&&r.has(n)},t.prototype.getEntries=function(t){return(this.index[t]||new ds(hi.comparator)).toArray()},t}(),pu=function(){function t(){this.qt=new du}return t.prototype.addToCollectionParentIndex=function(t,e){var n=this;if(!this.qt.has(e)){var r=e.lastSegment(),i=e.popLast();t.addOnCommittedListener(function(){n.qt.add(e)});var o={collectionId:r,parent:da(i)};return yu(t).put(o)}return Va.resolve()},t.prototype.getCollectionParents=function(t,e){var n=[],r=IDBKeyRange.bound([e,""],[ri(e),""],!1,!0);return yu(t).Nt(r).next(function(t){for(var r=0,i=t;r<i.length;r++){var o=i[r];if(o.collectionId!==e)break;n.push(va(o.parent))}return n})},t}();function yu(t){return Wa(t,Aa.store)}var vu={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},mu=function(){function t(t,e,n){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=n}return t.withCacheSize=function(e){return new t(e,t.DEFAULT_COLLECTION_PERCENTILE,t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)},t}();function gu(t,e,n){var r=t.store(wa.store),i=t.store(Ia.store),o=[],s=IDBKeyRange.only(n.batchId),a=0,u=r.$t({range:s},function(t,e,n){return a++,n.delete()});o.push(u.next(function(){$r(1===a)}));for(var c=[],h=0,l=n.mutations;h<l.length;h++){var f=l[h],d=Ia.key(e,f.key.path,n.batchId);o.push(i.delete(d)),c.push(f.key)}return Va.waitFor(o).next(function(){return c})}function bu(t){if(!t)return 0;var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Xr();e=t.noDocument}return JSON.stringify(e).length}mu.DEFAULT_COLLECTION_PERCENTILE=10,mu.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,mu.DEFAULT=new mu(41943040,mu.DEFAULT_COLLECTION_PERCENTILE,mu.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),mu.DISABLED=new mu(-1,0,0);var wu=function(){function t(t,e,n,r){this.userId=t,this.R=e,this.Ut=n,this.referenceDelegate=r,this.Qt={}}return t.Kt=function(e,n,r,i){return $r(""!==e.uid),new t(e.isAuthenticated()?e.uid:"",n,r,i)},t.prototype.checkEmpty=function(t){var e=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Tu(t).$t({index:wa.userMutationsIndex,range:n},function(t,n,r){e=!1,r.done()}).next(function(){return e})},t.prototype.addMutationBatch=function(t,e,n,r){var i=this,o=Eu(t),s=Tu(t);return s.add({}).next(function(a){$r("number"==typeof a);for(var u=new Ya(a,e,n,r),c=function(t,e,n){var r=n.baseMutations.map(function(e){return $s(t.Lt,e)}),i=n.mutations.map(function(e){return $s(t.Lt,e)});return new wa(e,n.batchId,n.localWriteTime.toMillis(),r,i)}(i.R,i.userId,u),h=[],l=new ds(function(t,e){return ei(t.canonicalString(),e.canonicalString())}),f=0,d=r;f<d.length;f++){var p=d[f],y=Ia.key(i.userId,p.key.path,a);l=l.add(p.key.path.popLast()),h.push(s.put(c)),h.push(o.put(y,Ia.PLACEHOLDER))}return l.forEach(function(e){h.push(i.Ut.addToCollectionParentIndex(t,e))}),t.addOnCommittedListener(function(){i.Qt[a]=u.keys()}),Va.waitFor(h).next(function(){return u})})},t.prototype.lookupMutationBatch=function(t,e){var n=this;return Tu(t).get(e).next(function(t){return t?($r(t.userId===n.userId),ou(n.R,t)):null})},t.prototype.jt=function(t,e){var n=this;return this.Qt[e]?Va.resolve(this.Qt[e]):this.lookupMutationBatch(t,e).next(function(t){if(t){var r=t.keys();return n.Qt[e]=r,r}return null})},t.prototype.getNextMutationBatchAfterBatchId=function(t,e){var n=this,r=e+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return Tu(t).$t({index:wa.userMutationsIndex,range:i},function(t,e,i){e.userId===n.userId&&($r(e.batchId>=r),o=ou(n.R,e)),i.done()}).next(function(){return o})},t.prototype.getHighestUnacknowledgedBatchId=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return Tu(t).$t({index:wa.userMutationsIndex,range:e,reverse:!0},function(t,e,r){n=e.batchId,r.done()}).next(function(){return n})},t.prototype.getAllMutationBatches=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Tu(t).Nt(wa.userMutationsIndex,n).next(function(t){return t.map(function(t){return ou(e.R,t)})})},t.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=Ia.prefixForPath(this.userId,e.path),i=IDBKeyRange.lowerBound(r),o=[];return Eu(t).$t({range:i},function(r,i,s){var a=r[0],u=r[2],c=va(r[1]);if(a===n.userId&&e.path.isEqual(c))return Tu(t).get(u).next(function(t){if(!t)throw Xr();$r(t.userId===n.userId),o.push(ou(n.R,t))});s.done()}).next(function(){return o})},t.prototype.getAllMutationBatchesAffectingDocumentKeys=function(t,e){var n=this,r=new ds(ei),i=[];return e.forEach(function(e){var o=Ia.prefixForPath(n.userId,e.path),s=IDBKeyRange.lowerBound(o),a=Eu(t).$t({range:s},function(t,i,o){var s=t[0],a=t[2],u=va(t[1]);s===n.userId&&e.path.isEqual(u)?r=r.add(a):o.done()});i.push(a)}),Va.waitFor(i).next(function(){return n.Wt(t,r)})},t.prototype.getAllMutationBatchesAffectingQuery=function(t,e){var n=this,r=e.path,i=r.length+1,o=Ia.prefixForPath(this.userId,r),s=IDBKeyRange.lowerBound(o),a=new ds(ei);return Eu(t).$t({range:s},function(t,e,o){var s=t[0],u=t[2],c=va(t[1]);s===n.userId&&r.isPrefixOf(c)?c.length===i&&(a=a.add(u)):o.done()}).next(function(){return n.Wt(t,a)})},t.prototype.Wt=function(t,e){var n=this,r=[],i=[];return e.forEach(function(e){i.push(Tu(t).get(e).next(function(t){if(null===t)throw Xr();$r(t.userId===n.userId),r.push(ou(n.R,t))}))}),Va.waitFor(i).next(function(){return r})},t.prototype.removeMutationBatch=function(t,e){var n=this;return gu(t.Mt,this.userId,e).next(function(r){return t.addOnCommittedListener(function(){n.Gt(e.batchId)}),Va.forEach(r,function(e){return n.referenceDelegate.markPotentiallyOrphaned(t,e)})})},t.prototype.Gt=function(t){delete this.Qt[t]},t.prototype.performConsistencyCheck=function(t){var e=this;return this.checkEmpty(t).next(function(n){if(!n)return Va.resolve();var r=IDBKeyRange.lowerBound(Ia.prefixForUser(e.userId)),i=[];return Eu(t).$t({range:r},function(t,n,r){if(t[0]===e.userId){var o=va(t[1]);i.push(o)}else r.done()}).next(function(){$r(0===i.length)})})},t.prototype.containsKey=function(t,e){return Iu(t,this.userId,e)},t.prototype.zt=function(t){var e=this;return _u(t).get(this.userId).next(function(t){return t||new ba(e.userId,-1,"")})},t}();function Iu(t,e,n){var r=Ia.prefixForPath(e,n.path),i=r[1],o=IDBKeyRange.lowerBound(r),s=!1;return Eu(t).$t({range:o,kt:!0},function(t,n,r){t[0]===e&&t[1]===i&&(s=!0),r.done()}).next(function(){return s})}function Tu(t){return Wa(t,wa.store)}function Eu(t){return Wa(t,Ia.store)}function _u(t){return Wa(t,ba.store)}var Ou=function(){function t(t){this.Ht=t}return t.prototype.next=function(){return this.Ht+=2,this.Ht},t.Jt=function(){return new t(0)},t.Yt=function(){return new t(-1)},t}(),Su=function(){function t(t,e){this.referenceDelegate=t,this.R=e}return t.prototype.allocateTargetId=function(t){var e=this;return this.Xt(t).next(function(n){var r=new Ou(n.highestTargetId);return n.highestTargetId=r.next(),e.Zt(t,n).next(function(){return n.highestTargetId})})},t.prototype.getLastRemoteSnapshotVersion=function(t){return this.Xt(t).next(function(t){return oi.fromTimestamp(new ii(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))})},t.prototype.getHighestSequenceNumber=function(t){return this.Xt(t).next(function(t){return t.highestListenSequenceNumber})},t.prototype.setTargetsMetadata=function(t,e,n){var r=this;return this.Xt(t).next(function(i){return i.highestListenSequenceNumber=e,n&&(i.lastRemoteSnapshotVersion=n.toTimestamp()),e>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=e),r.Zt(t,i)})},t.prototype.addTargetData=function(t,e){var n=this;return this.te(t,e).next(function(){return n.Xt(t).next(function(r){return r.targetCount+=1,n.ee(e,r),n.Zt(t,r)})})},t.prototype.updateTargetData=function(t,e){return this.te(t,e)},t.prototype.removeTargetData=function(t,e){var n=this;return this.removeMatchingKeysForTargetId(t,e.targetId).next(function(){return Du(t).delete(e.targetId)}).next(function(){return n.Xt(t)}).next(function(e){return $r(e.targetCount>0),e.targetCount-=1,n.Zt(t,e)})},t.prototype.removeTargets=function(t,e,n){var r=this,i=0,o=[];return Du(t).$t(function(s,a){var u=su(a);u.sequenceNumber<=e&&null===n.get(u.targetId)&&(i++,o.push(r.removeTargetData(t,u)))}).next(function(){return Va.waitFor(o)}).next(function(){return i})},t.prototype.forEachTarget=function(t,e){return Du(t).$t(function(t,n){var r=su(n);e(r)})},t.prototype.Xt=function(t){return Nu(t).get(Na.key).next(function(t){return $r(null!==t),t})},t.prototype.Zt=function(t,e){return Nu(t).put(Na.key,e)},t.prototype.te=function(t,e){return Du(t).put(au(this.R,e))},t.prototype.ee=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},t.prototype.getTargetCount=function(t){return this.Xt(t).next(function(t){return t.targetCount})},t.prototype.getTargetData=function(t,e){var n=zi(e),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),i=null;return Du(t).$t({range:r,index:Sa.queryTargetsIndexName},function(t,n,r){var o=su(n);Qi(e,o.target)&&(i=o,r.done())}).next(function(){return i})},t.prototype.addMatchingKeys=function(t,e,n){var r=this,i=[],o=Au(t);return e.forEach(function(e){var s=da(e.path);i.push(o.put(new Da(n,s))),i.push(r.referenceDelegate.addReference(t,n,e))}),Va.waitFor(i)},t.prototype.removeMatchingKeys=function(t,e,n){var r=this,i=Au(t);return Va.forEach(e,function(e){var o=da(e.path);return Va.waitFor([i.delete([n,o]),r.referenceDelegate.removeReference(t,n,e)])})},t.prototype.removeMatchingKeysForTargetId=function(t,e){var n=Au(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},t.prototype.getMatchingKeysForTargetId=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=Au(t),i=Ts();return r.$t({range:n,kt:!0},function(t,e,n){var r=va(t[1]),o=new Oi(r);i=i.add(o)}).next(function(){return i})},t.prototype.containsKey=function(t,e){var n=da(e.path),r=IDBKeyRange.bound([n],[ri(n)],!1,!0),i=0;return Au(t).$t({index:Da.documentTargetsIndex,kt:!0,range:r},function(t,e,n){0!==t[0]&&(i++,n.done())}).next(function(){return i>0})},t.prototype.lt=function(t,e){return Du(t).get(e).next(function(t){return t?su(t):null})},t}();function Du(t){return Wa(t,Sa.store)}function Nu(t){return Wa(t,Na.store)}function Au(t){return Wa(t,Da.store)}function ku(t){return Object(Fr.b)(this,void 0,void 0,function(){return Object(Fr.d)(this,function(e){if(t.code!==Br.FAILED_PRECONDITION||t.message!==Ra)throw t;return Qr("LocalStore","Unexpectedly lost primary lease"),[2]})})}function xu(t,e){var n=t[1],r=e[1],i=ei(t[0],e[0]);return 0===i?ei(n,r):i}var Cu=function(){function t(t){this.ne=t,this.buffer=new ds(xu),this.se=0}return t.prototype.ie=function(){return++this.se},t.prototype.re=function(t){var e=[t,this.ie()];if(this.buffer.size<this.ne)this.buffer=this.buffer.add(e);else{var n=this.buffer.last();xu(e,n)<0&&(this.buffer=this.buffer.delete(n).add(e))}},Object.defineProperty(t.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),t}(),ju=function(){function t(t,e){this.garbageCollector=t,this.asyncQueue=e,this.oe=!1,this.ce=null}return t.prototype.start=function(t){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.ue(t)},t.prototype.stop=function(){this.ce&&(this.ce.cancel(),this.ce=null)},Object.defineProperty(t.prototype,"started",{get:function(){return null!==this.ce},enumerable:!1,configurable:!0}),t.prototype.ue=function(t){var e=this,n=this.oe?3e5:6e4;Qr("LruGarbageCollector","Garbage collection scheduled in "+n+"ms"),this.ce=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",n,function(){return Object(Fr.b)(e,void 0,void 0,function(){var e;return Object(Fr.d)(this,function(n){switch(n.label){case 0:this.ce=null,this.oe=!0,n.label=1;case 1:return n.trys.push([1,3,,7]),[4,t.collectGarbage(this.garbageCollector)];case 2:return n.sent(),[3,7];case 3:return Ba(e=n.sent())?(Qr("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,ku(e)];case 5:n.sent(),n.label=6;case 6:return[3,7];case 7:return[4,this.ue(t)];case 8:return n.sent(),[2]}})})})},t}(),Ru=function(){function t(t,e){this.ae=t,this.params=e}return t.prototype.calculateTargetCount=function(t,e){return this.ae.he(t).next(function(t){return Math.floor(e/100*t)})},t.prototype.nthSequenceNumber=function(t,e){var n=this;if(0===e)return Va.resolve(qr.o);var r=new Cu(e);return this.ae.forEachTarget(t,function(t){return r.re(t.sequenceNumber)}).next(function(){return n.ae.le(t,function(t){return r.re(t)})}).next(function(){return r.maxValue})},t.prototype.removeTargets=function(t,e,n){return this.ae.removeTargets(t,e,n)},t.prototype.removeOrphanedDocuments=function(t,e){return this.ae.removeOrphanedDocuments(t,e)},t.prototype.collect=function(t,e){var n=this;return-1===this.params.cacheSizeCollectionThreshold?(Qr("LruGarbageCollector","Garbage collection skipped; disabled"),Va.resolve(vu)):this.getCacheSize(t).next(function(r){return r<n.params.cacheSizeCollectionThreshold?(Qr("LruGarbageCollector","Garbage collection skipped; Cache size "+r+" is lower than threshold "+n.params.cacheSizeCollectionThreshold),vu):n.fe(t,e)})},t.prototype.getCacheSize=function(t){return this.ae.getCacheSize(t)},t.prototype.fe=function(t,e){var n,r,i,o,s,a,u,c=this,h=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next(function(e){return e>c.params.maximumSequenceNumbersToCollect?(Qr("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+c.params.maximumSequenceNumbersToCollect+" from "+e),r=c.params.maximumSequenceNumbersToCollect):r=e,o=Date.now(),c.nthSequenceNumber(t,r)}).next(function(r){return n=r,s=Date.now(),c.removeTargets(t,n,e)}).next(function(e){return i=e,a=Date.now(),c.removeOrphanedDocuments(t,n)}).next(function(t){return u=Date.now(),zr()<=k.a.DEBUG&&Qr("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(o-h)+"ms\n\tDetermined least recently used "+r+" in "+(s-o)+"ms\n\tRemoved "+i+" targets in "+(a-s)+"ms\n\tRemoved "+t+" documents in "+(u-a)+"ms\nTotal Duration: "+(u-h)+"ms"),Va.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:t})})},t}(),Pu=function(){function t(t,e){this.db=t,this.garbageCollector=function(t,e){return new Ru(t,e)}(this,e)}return t.prototype.he=function(t){var e=this.de(t);return this.db.getTargetCache().getTargetCount(t).next(function(t){return e.next(function(e){return t+e})})},t.prototype.de=function(t){var e=0;return this.le(t,function(t){e++}).next(function(){return e})},t.prototype.forEachTarget=function(t,e){return this.db.getTargetCache().forEachTarget(t,e)},t.prototype.le=function(t,e){return this.we(t,function(t,n){return e(n)})},t.prototype.addReference=function(t,e,n){return Lu(t,n)},t.prototype.removeReference=function(t,e,n){return Lu(t,n)},t.prototype.removeTargets=function(t,e,n){return this.db.getTargetCache().removeTargets(t,e,n)},t.prototype.markPotentiallyOrphaned=function(t,e){return Lu(t,e)},t.prototype._e=function(t,e){return function(t,e){var n=!1;return _u(t).Ot(function(r){return Iu(t,r,e).next(function(t){return t&&(n=!0),Va.resolve(!t)})}).next(function(){return n})}(t,e)},t.prototype.removeOrphanedDocuments=function(t,e){var n=this,r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],o=0;return this.we(t,function(s,a){if(a<=e){var u=n._e(t,s).next(function(e){if(!e)return o++,r.getEntry(t,s).next(function(){return r.removeEntry(s),Au(t).delete([0,da(s.path)])})});i.push(u)}}).next(function(){return Va.waitFor(i)}).next(function(){return r.apply(t)}).next(function(){return o})},t.prototype.removeTarget=function(t,e){var n=e.withSequenceNumber(t.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(t,n)},t.prototype.updateLimboDocument=function(t,e){return Lu(t,e)},t.prototype.we=function(t,e){var n,r=Au(t),i=qr.o;return r.$t({index:Da.documentTargetsIndex},function(t,r){var o=r.path,s=r.sequenceNumber;0===t[0]?(i!==qr.o&&e(new Oi(va(n)),i),i=s,n=o):i=qr.o}).next(function(){i!==qr.o&&e(new Oi(va(n)),i)})},t.prototype.getCacheSize=function(t){return this.db.getRemoteDocumentCache().getSize(t)},t}();function Lu(t,e){return Au(t).put(function(t,e){return new Da(0,da(t.path),e)}(e,t.currentSequenceNumber))}var Vu=function(){function t(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={}}return t.prototype.get=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[1];if(this.equalsFn(o[0],t))return s}},t.prototype.has=function(t){return void 0!==this.get(t)},t.prototype.set=function(t,e){var n=this.mapKeyFn(t),r=this.inner[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.equalsFn(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.inner[n]=[[t,e]]},t.prototype.delete=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.equalsFn(n[r][0],t))return 1===n.length?delete this.inner[e]:n.splice(r,1),!0;return!1},t.prototype.forEach=function(t){ai(this.inner,function(e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];t(o[0],o[1])}})},t.prototype.isEmpty=function(){return ui(this.inner)},t}(),Uu=function(){function t(){this.changes=new Vu(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.changesApplied=!1}return t.prototype.getReadTime=function(t){var e=this.changes.get(t);return e?e.readTime:oi.min()},t.prototype.addEntry=function(t,e){this.assertNotApplied(),this.changes.set(t.key,{document:t,readTime:e})},t.prototype.removeEntry=function(t,e){void 0===e&&(e=null),this.assertNotApplied(),this.changes.set(t,{document:Bi.newInvalidDocument(t),readTime:e})},t.prototype.getEntry=function(t,e){this.assertNotApplied();var n=this.changes.get(e);return void 0!==n?Va.resolve(n.document):this.getFromCache(t,e)},t.prototype.getEntries=function(t,e){return this.getAllFromCache(t,e)},t.prototype.apply=function(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)},t.prototype.assertNotApplied=function(){},t}(),Mu=function(){function t(t,e){this.R=t,this.Ut=e}return t.prototype.addEntry=function(t,e,n){return Bu(t).put(Ku(e),n)},t.prototype.removeEntry=function(t,e){var n=Bu(t),r=Ku(e);return n.delete(r)},t.prototype.updateMetadata=function(t,e){var n=this;return this.getMetadata(t).next(function(r){return r.byteSize+=e,n.me(t,r)})},t.prototype.getEntry=function(t,e){var n=this;return Bu(t).get(Ku(e)).next(function(t){return n.ye(e,t)})},t.prototype.ge=function(t,e){var n=this;return Bu(t).get(Ku(e)).next(function(t){return{document:n.ye(e,t),size:bu(t)}})},t.prototype.getEntries=function(t,e){var n=this,r=vs();return this.pe(t,e,function(t,e){var i=n.ye(t,e);r=r.insert(t,i)}).next(function(){return r})},t.prototype.Ee=function(t,e){var n=this,r=vs(),i=new hs(Oi.comparator);return this.pe(t,e,function(t,e){var o=n.ye(t,e);r=r.insert(t,o),i=i.insert(t,bu(e))}).next(function(){return{documents:r,Te:i}})},t.prototype.pe=function(t,e,n){if(e.isEmpty())return Va.resolve();var r=IDBKeyRange.bound(e.first().path.toArray(),e.last().path.toArray()),i=e.getIterator(),o=i.getNext();return Bu(t).$t({range:r},function(t,e,r){for(var s=Oi.fromSegments(t);o&&Oi.comparator(o,s)<0;)n(o,null),o=i.getNext();o&&o.isEqual(s)&&(n(o,e),o=i.hasNext()?i.getNext():null),o?r.Ct(o.path.toArray()):r.done()}).next(function(){for(;o;)n(o,null),o=i.hasNext()?i.getNext():null})},t.prototype.getDocumentsMatchingQuery=function(t,e,n){var r=this,i=vs(),o=e.path.length+1,s={};if(n.isEqual(oi.min())){var a=e.path.toArray();s.range=IDBKeyRange.lowerBound(a)}else{var u=e.path.toArray(),c=eu(n);s.range=IDBKeyRange.lowerBound([u,c],!0),s.index=_a.collectionReadTimeIndex}return Bu(t).$t(s,function(t,n,s){if(t.length===o){var a=Za(r.R,n);e.path.isPrefixOf(a.key.path)?_o(e,a)&&(i=i.insert(a.key,a)):s.done()}}).next(function(){return i})},t.prototype.newChangeBuffer=function(t){return new Fu(this,!!t&&t.trackRemovals)},t.prototype.getSize=function(t){return this.getMetadata(t).next(function(t){return t.byteSize})},t.prototype.getMetadata=function(t){return qu(t).get(Oa.key).next(function(t){return $r(!!t),t})},t.prototype.me=function(t,e){return qu(t).put(Oa.key,e)},t.prototype.ye=function(t,e){if(e){var n=Za(this.R,e);if(!n.isNoDocument()||!n.version.isEqual(oi.min()))return n}return Bi.newInvalidDocument(t)},t}(),Fu=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Ie=e,r.trackRemovals=n,r.Ae=new Vu(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),r}return Object(Fr.c)(e,t),e.prototype.applyChanges=function(t){var e=this,n=[],r=0,i=new ds(function(t,e){return ei(t.canonicalString(),e.canonicalString())});return this.changes.forEach(function(o,s){var a=e.Ae.get(o);if(s.document.isValidDocument()){var u=tu(e.Ie.R,s.document,e.getReadTime(o));i=i.add(o.path.popLast());var c=bu(u);r+=c-a,n.push(e.Ie.addEntry(t,o,u))}else if(r-=a,e.trackRemovals){var h=tu(e.Ie.R,Bi.newNoDocument(o,oi.min()),e.getReadTime(o));n.push(e.Ie.addEntry(t,o,h))}else n.push(e.Ie.removeEntry(t,o))}),i.forEach(function(r){n.push(e.Ie.Ut.addToCollectionParentIndex(t,r))}),n.push(this.Ie.updateMetadata(t,r)),Va.waitFor(n)},e.prototype.getFromCache=function(t,e){var n=this;return this.Ie.ge(t,e).next(function(t){return n.Ae.set(e,t.size),t.document})},e.prototype.getAllFromCache=function(t,e){var n=this;return this.Ie.Ee(t,e).next(function(t){var e=t.documents;return t.Te.forEach(function(t,e){n.Ae.set(t,e)}),e})},e}(Uu);function qu(t){return Wa(t,Oa.store)}function Bu(t){return Wa(t,_a.store)}function Ku(t){return t.path.toArray()}var Gu=function(){function t(t){this.R=t}return t.prototype.Rt=function(t,e,n,r){var i=this;$r(n<r&&n>=0&&r<=11);var o=new Ua("createOrUpgrade",e);n<1&&r>=1&&(function(t){t.createObjectStore(ga.store)}(t),function(t){t.createObjectStore(ba.store,{keyPath:ba.keyPath}),t.createObjectStore(wa.store,{keyPath:wa.keyPath,autoIncrement:!0}).createIndex(wa.userMutationsIndex,wa.userMutationsKeyPath,{unique:!0}),t.createObjectStore(Ia.store)}(t),zu(t),function(t){t.createObjectStore(_a.store)}(t));var s=Va.resolve();return n<3&&r>=3&&(0!==n&&(function(t){t.deleteObjectStore(Da.store),t.deleteObjectStore(Sa.store),t.deleteObjectStore(Na.store)}(t),zu(t)),s=s.next(function(){return function(t){var e=t.store(Na.store),n=new Na(0,0,oi.min().toTimestamp(),0);return e.put(Na.key,n)}(o)})),n<4&&r>=4&&(0!==n&&(s=s.next(function(){return function(t,e){return e.store(wa.store).Nt().next(function(n){t.deleteObjectStore(wa.store),t.createObjectStore(wa.store,{keyPath:wa.keyPath,autoIncrement:!0}).createIndex(wa.userMutationsIndex,wa.userMutationsKeyPath,{unique:!0});var r=e.store(wa.store),i=n.map(function(t){return r.put(t)});return Va.waitFor(i)})}(t,o)})),s=s.next(function(){!function(t){t.createObjectStore(ka.store,{keyPath:ka.keyPath})}(t)})),n<5&&r>=5&&(s=s.next(function(){return i.Re(o)})),n<6&&r>=6&&(s=s.next(function(){return function(t){t.createObjectStore(Oa.store)}(t),i.be(o)})),n<7&&r>=7&&(s=s.next(function(){return i.ve(o)})),n<8&&r>=8&&(s=s.next(function(){return i.Pe(t,o)})),n<9&&r>=9&&(s=s.next(function(){!function(t){t.objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges")}(t),function(t){var e=t.objectStore(_a.store);e.createIndex(_a.readTimeIndex,_a.readTimeIndexPath,{unique:!1}),e.createIndex(_a.collectionReadTimeIndex,_a.collectionReadTimeIndexPath,{unique:!1})}(e)})),n<10&&r>=10&&(s=s.next(function(){return i.Ve(o)})),n<11&&r>=11&&(s=s.next(function(){!function(t){t.createObjectStore(xa.store,{keyPath:xa.keyPath})}(t),function(t){t.createObjectStore(Ca.store,{keyPath:Ca.keyPath})}(t)})),s},t.prototype.be=function(t){var e=0;return t.store(_a.store).$t(function(t,n){e+=bu(n)}).next(function(){var n=new Oa(e);return t.store(Oa.store).put(Oa.key,n)})},t.prototype.Re=function(t){var e=this,n=t.store(ba.store),r=t.store(wa.store);return n.Nt().next(function(n){return Va.forEach(n,function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.Nt(wa.userMutationsIndex,i).next(function(r){return Va.forEach(r,function(r){$r(r.userId===n.userId);var i=ou(e.R,r);return gu(t,n.userId,i).next(function(){})})})})})},t.prototype.ve=function(t){var e=t.store(Da.store),n=t.store(_a.store);return t.store(Na.store).get(Na.key).next(function(t){var r=[];return n.$t(function(n,i){var o=new hi(n),s=function(t){return[0,da(t)]}(o);r.push(e.get(s).next(function(n){return n?Va.resolve():function(n){return e.put(new Da(0,da(n),t.highestListenSequenceNumber))}(o)}))}).next(function(){return Va.waitFor(r)})})},t.prototype.Pe=function(t,e){t.createObjectStore(Aa.store,{keyPath:Aa.keyPath});var n=e.store(Aa.store),r=new du,i=function(t){if(r.add(t)){var e=t.lastSegment(),i=t.popLast();return n.put({collectionId:e,parent:da(i)})}};return e.store(_a.store).$t({kt:!0},function(t,e){var n=new hi(t);return i(n.popLast())}).next(function(){return e.store(Ia.store).$t({kt:!0},function(t,e){var n=va(t[1]);return i(n.popLast())})})},t.prototype.Ve=function(t){var e=this,n=t.store(Sa.store);return n.$t(function(t,r){var i=su(r),o=au(e.R,i);return n.put(o)})},t}();function zu(t){t.createObjectStore(Da.store,{keyPath:Da.keyPath}).createIndex(Da.documentTargetsIndex,Da.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(Sa.store,{keyPath:Sa.keyPath}).createIndex(Sa.queryTargetsIndexName,Sa.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(Na.store)}var Qu="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Hu=function(){function t(e,n,r,i,o,s,a,u,c,h){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.Se=o,this.window=s,this.document=a,this.De=c,this.Ce=h,this.Ne=null,this.xe=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Fe=null,this.inForeground=!1,this.ke=null,this.$e=null,this.Oe=Number.NEGATIVE_INFINITY,this.Me=function(t){return Promise.resolve()},!t.yt())throw new Kr(Br.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new Pu(this,i),this.Le=n+"main",this.R=new Ja(u),this.Be=new Ma(this.Le,11,new Gu(this.R)),this.qe=new Su(this.referenceDelegate,this.R),this.Ut=new pu,this.Ue=function(t,e){return new Mu(t,e)}(this.R,this.Ut),this.Qe=new cu,this.window&&this.window.localStorage?this.Ke=this.window.localStorage:(this.Ke=null,!1===h&&Hr("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}return t.prototype.start=function(){var t=this;return this.je().then(function(){if(!t.isPrimary&&!t.allowTabSynchronization)throw new Kr(Br.FAILED_PRECONDITION,Qu);return t.We(),t.Ge(),t.ze(),t.runTransaction("getHighestListenSequenceNumber","readonly",function(e){return t.qe.getHighestSequenceNumber(e)})}).then(function(e){t.Ne=new qr(e,t.De)}).then(function(){t.xe=!0}).catch(function(e){return t.Be&&t.Be.close(),Promise.reject(e)})},t.prototype.He=function(t){var e=this;return this.Me=function(n){return Object(Fr.b)(e,void 0,void 0,function(){return Object(Fr.d)(this,function(e){return this.started?[2,t(n)]:[2]})})},t(this.isPrimary)},t.prototype.setDatabaseDeletedListener=function(t){var e=this;this.Be.vt(function(n){return Object(Fr.b)(e,void 0,void 0,function(){return Object(Fr.d)(this,function(e){switch(e.label){case 0:return null===n.newVersion?[4,t()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})})},t.prototype.setNetworkEnabled=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.Se.enqueueAndForget(function(){return Object(Fr.b)(e,void 0,void 0,function(){return Object(Fr.d)(this,function(t){switch(t.label){case 0:return this.started?[4,this.je()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})}))},t.prototype.je=function(){var t=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",function(e){return Yu(e).put(new ka(t.clientId,Date.now(),t.networkEnabled,t.inForeground)).next(function(){if(t.isPrimary)return t.Je(e).next(function(e){e||(t.isPrimary=!1,t.Se.enqueueRetryable(function(){return t.Me(!1)}))})}).next(function(){return t.Ye(e)}).next(function(n){return t.isPrimary&&!n?t.Xe(e).next(function(){return!1}):!!n&&t.Ze(e).next(function(){return!0})})}).catch(function(e){if(Ba(e))return Qr("IndexedDbPersistence","Failed to extend owner lease: ",e),t.isPrimary;if(!t.allowTabSynchronization)throw e;return Qr("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(function(e){t.isPrimary!==e&&t.Se.enqueueRetryable(function(){return t.Me(e)}),t.isPrimary=e})},t.prototype.Je=function(t){var e=this;return Wu(t).get(ga.key).next(function(t){return Va.resolve(e.tn(t))})},t.prototype.en=function(t){return Yu(t).delete(this.clientId)},t.prototype.nn=function(){return Object(Fr.b)(this,void 0,void 0,function(){var t,e,n,r=this;return Object(Fr.d)(this,function(i){switch(i.label){case 0:return!this.isPrimary||this.sn(this.Oe,18e5)?[3,2]:(this.Oe=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",function(t){var e=Wa(t,ka.store);return e.Nt().next(function(t){var n=r.rn(t,18e5),i=t.filter(function(t){return-1===n.indexOf(t)});return Va.forEach(i,function(t){return e.delete(t.clientId)}).next(function(){return i})})}).catch(function(){return[]})]);case 1:if(t=i.sent(),this.Ke)for(e=0,n=t;e<n.length;e++)this.Ke.removeItem(this.on(n[e].clientId));i.label=2;case 2:return[2]}})})},t.prototype.ze=function(){var t=this;this.$e=this.Se.enqueueAfterDelay("client_metadata_refresh",4e3,function(){return t.je().then(function(){return t.nn()}).then(function(){return t.ze()})})},t.prototype.tn=function(t){return!!t&&t.ownerId===this.clientId},t.prototype.Ye=function(t){var e=this;return this.Ce?Va.resolve(!0):Wu(t).get(ga.key).next(function(n){if(null!==n&&e.sn(n.leaseTimestampMs,5e3)&&!e.cn(n.ownerId)){if(e.tn(n)&&e.networkEnabled)return!0;if(!e.tn(n)){if(!n.allowTabSynchronization)throw new Kr(Br.FAILED_PRECONDITION,Qu);return!1}}return!(!e.networkEnabled||!e.inForeground)||Yu(t).Nt().next(function(t){return void 0===e.rn(t,5e3).find(function(t){return!(e.clientId===t.clientId||!(!e.networkEnabled&&t.networkEnabled||!e.inForeground&&t.inForeground&&e.networkEnabled===t.networkEnabled))})})}).next(function(t){return e.isPrimary!==t&&Qr("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t})},t.prototype.shutdown=function(){return Object(Fr.b)(this,void 0,void 0,function(){var t=this;return Object(Fr.d)(this,function(e){switch(e.label){case 0:return this.xe=!1,this.un(),this.$e&&(this.$e.cancel(),this.$e=null),this.an(),this.hn(),[4,this.Be.runTransaction("shutdown","readwrite",[ga.store,ka.store],function(e){var n=new Ha(e,qr.o);return t.Xe(n).next(function(){return t.en(n)})})];case 1:return e.sent(),this.Be.close(),this.ln(),[2]}})})},t.prototype.rn=function(t,e){var n=this;return t.filter(function(t){return n.sn(t.updateTimeMs,e)&&!n.cn(t.clientId)})},t.prototype.fn=function(){var t=this;return this.runTransaction("getActiveClients","readonly",function(e){return Yu(e).Nt().next(function(e){return t.rn(e,18e5).map(function(t){return t.clientId})})})},Object.defineProperty(t.prototype,"started",{get:function(){return this.xe},enumerable:!1,configurable:!0}),t.prototype.getMutationQueue=function(t){return wu.Kt(t,this.R,this.Ut,this.referenceDelegate)},t.prototype.getTargetCache=function(){return this.qe},t.prototype.getRemoteDocumentCache=function(){return this.Ue},t.prototype.getIndexManager=function(){return this.Ut},t.prototype.getBundleCache=function(){return this.Qe},t.prototype.runTransaction=function(t,e,n){var r,i=this;return Qr("IndexedDbPersistence","Starting transaction:",t),this.Be.runTransaction(t,"readonly"===e?"readonly":"readwrite",ja,function(o){return r=new Ha(o,i.Ne?i.Ne.next():qr.o),"readwrite-primary"===e?i.Je(r).next(function(t){return!!t||i.Ye(r)}).next(function(e){if(!e)throw Hr("Failed to obtain primary lease for action '"+t+"'."),i.isPrimary=!1,i.Se.enqueueRetryable(function(){return i.Me(!1)}),new Kr(Br.FAILED_PRECONDITION,Ra);return n(r)}).next(function(t){return i.Ze(r).next(function(){return t})}):i.dn(r).next(function(){return n(r)})}).then(function(t){return r.raiseOnCommittedEvent(),t})},t.prototype.dn=function(t){var e=this;return Wu(t).get(ga.key).next(function(t){if(null!==t&&e.sn(t.leaseTimestampMs,5e3)&&!e.cn(t.ownerId)&&!e.tn(t)&&!(e.Ce||e.allowTabSynchronization&&t.allowTabSynchronization))throw new Kr(Br.FAILED_PRECONDITION,Qu)})},t.prototype.Ze=function(t){var e=new ga(this.clientId,this.allowTabSynchronization,Date.now());return Wu(t).put(ga.key,e)},t.yt=function(){return Ma.yt()},t.prototype.Xe=function(t){var e=this,n=Wu(t);return n.get(ga.key).next(function(t){return e.tn(t)?(Qr("IndexedDbPersistence","Releasing primary lease."),n.delete(ga.key)):Va.resolve()})},t.prototype.sn=function(t,e){var n=Date.now();return!(t<n-e||t>n&&(Hr("Detected an update time that is in the future: "+t+" > "+n),1))},t.prototype.We=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.ke=function(){t.Se.enqueueAndForget(function(){return t.inForeground="visible"===t.document.visibilityState,t.je()})},this.document.addEventListener("visibilitychange",this.ke),this.inForeground="visible"===this.document.visibilityState)},t.prototype.an=function(){this.ke&&(this.document.removeEventListener("visibilitychange",this.ke),this.ke=null)},t.prototype.Ge=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.Fe=function(){e.un(),e.Se.enqueueAndForget(function(){return e.shutdown()})},this.window.addEventListener("pagehide",this.Fe))},t.prototype.hn=function(){this.Fe&&(this.window.removeEventListener("pagehide",this.Fe),this.Fe=null)},t.prototype.cn=function(t){var e;try{var n=null!==(null===(e=this.Ke)||void 0===e?void 0:e.getItem(this.on(t)));return Qr("IndexedDbPersistence","Client '"+t+"' "+(n?"is":"is not")+" zombied in LocalStorage"),n}catch(t){return Hr("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},t.prototype.un=function(){if(this.Ke)try{this.Ke.setItem(this.on(this.clientId),String(Date.now()))}catch(t){Hr("Failed to set zombie client id.",t)}},t.prototype.ln=function(){if(this.Ke)try{this.Ke.removeItem(this.on(this.clientId))}catch(t){}},t.prototype.on=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},t}();function Wu(t){return Wa(t,ga.store)}function Yu(t){return Wa(t,ka.store)}function Xu(t,e){var n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var $u=function(t,e){this.progress=t,this.wn=e},Ju=function(){function t(t,e,n){this.Ue=t,this._n=e,this.Ut=n}return t.prototype.mn=function(t,e){var n=this;return this._n.getAllMutationBatchesAffectingDocumentKey(t,e).next(function(r){return n.yn(t,e,r)})},t.prototype.yn=function(t,e,n){return this.Ue.getEntry(t,e).next(function(t){for(var e=0,r=n;e<r.length;e++)r[e].applyToLocalView(t);return t})},t.prototype.gn=function(t,e){t.forEach(function(t,n){for(var r=0,i=e;r<i.length;r++)i[r].applyToLocalView(n)})},t.prototype.pn=function(t,e){var n=this;return this.Ue.getEntries(t,e).next(function(e){return n.En(t,e).next(function(){return e})})},t.prototype.En=function(t,e){var n=this;return this._n.getAllMutationBatchesAffectingDocumentKeys(t,e).next(function(t){return n.gn(e,t)})},t.prototype.getDocumentsMatchingQuery=function(t,e,n){return function(t){return Oi.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.Tn(t,e.path):mo(e)?this.In(t,e,n):this.An(t,e,n)},t.prototype.Tn=function(t,e){return this.mn(t,new Oi(e)).next(function(t){var e=gs();return t.isFoundDocument()&&(e=e.insert(t.key,t)),e})},t.prototype.In=function(t,e,n){var r=this,i=e.collectionGroup,o=gs();return this.Ut.getCollectionParents(t,i).next(function(s){return Va.forEach(s,function(s){var a=function(t,e){return new co(e,null,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(e,s.child(i));return r.An(t,a,n).next(function(t){t.forEach(function(t,e){o=o.insert(t,e)})})}).next(function(){return o})})},t.prototype.An=function(t,e,n){var r,i,o=this;return this.Ue.getDocumentsMatchingQuery(t,e,n).next(function(n){return r=n,o._n.getAllMutationBatchesAffectingQuery(t,e)}).next(function(e){return o.Rn(t,i=e,r).next(function(t){r=t;for(var e=0,n=i;e<n.length;e++)for(var o=n[e],s=0,a=o.mutations;s<a.length;s++){var u=a[s],c=u.key,h=r.get(c);null==h&&(h=Bi.newInvalidDocument(c),r=r.insert(c,h)),Wo(u,h,o.localWriteTime),h.isFoundDocument()||(r=r.remove(c))}})}).next(function(){return r.forEach(function(t,n){_o(e,n)||(r=r.remove(t))}),r})},t.prototype.Rn=function(t,e,n){for(var r=Ts(),i=0,o=e;i<o.length;i++)for(var s=0,a=o[i].mutations;s<a.length;s++){var u=a[s];u instanceof Zo&&null===n.get(u.key)&&(r=r.add(u.key))}var c=n;return this.Ue.getEntries(t,r).next(function(t){return t.forEach(function(t,e){e.isFoundDocument()&&(c=c.insert(t,e))}),c})},t}(),Zu=function(){function t(t,e,n,r){this.targetId=t,this.fromCache=e,this.bn=n,this.vn=r}return t.Pn=function(e,n){for(var r=Ts(),i=Ts(),o=0,s=n.docChanges;o<s.length;o++){var a=s[o];switch(a.type){case 0:r=r.add(a.doc.key);break;case 1:i=i.add(a.doc.key)}}return new t(e,n.fromCache,r,i)},t}(),tc=function(){function t(){}return t.prototype.Vn=function(t){this.Sn=t},t.prototype.getDocumentsMatchingQuery=function(t,e,n,r){var i=this;return function(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.explicitOrderBy.length||1===t.explicitOrderBy.length&&t.explicitOrderBy[0].field.isKeyField())}(e)||n.isEqual(oi.min())?this.Dn(t,e):this.Sn.pn(t,r).next(function(o){var s=i.Cn(e,o);return(fo(e)||po(e))&&i.Nn(e.limitType,s,r,n)?i.Dn(t,e):(zr()<=k.a.DEBUG&&Qr("QueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),Eo(e)),i.Sn.getDocumentsMatchingQuery(t,e,n).next(function(t){return s.forEach(function(e){t=t.insert(e.key,e)}),t}))})},t.prototype.Cn=function(t,e){var n=new ds(Oo(t));return e.forEach(function(e,r){_o(t,r)&&(n=n.add(r))}),n},t.prototype.Nn=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)},t.prototype.Dn=function(t,e){return zr()<=k.a.DEBUG&&Qr("QueryEngine","Using full collection scan to execute query:",Eo(e)),this.Sn.getDocumentsMatchingQuery(t,e,oi.min())},t}(),ec=function(){function t(t,e,n,r){this.persistence=t,this.xn=e,this.R=r,this.Fn=new hs(ei),this.kn=new Vu(function(t){return zi(t)},Qi),this.$n=oi.min(),this._n=t.getMutationQueue(n),this.On=t.getRemoteDocumentCache(),this.qe=t.getTargetCache(),this.Mn=new Ju(this.On,this._n,this.persistence.getIndexManager()),this.Qe=t.getBundleCache(),this.xn.Vn(this.Mn)}return t.prototype.collectGarbage=function(t){var e=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(n){return t.collect(n,e.Fn)})},t}();function nc(t,e,n,r){return new ec(t,e,n,r)}function rc(t,e){return Object(Fr.b)(this,void 0,void 0,function(){var n,r,i,o;return Object(Fr.d)(this,function(s){switch(s.label){case 0:return n=Jr(t),r=n._n,i=n.Mn,[4,n.persistence.runTransaction("Handle user change","readonly",function(t){var o;return n._n.getAllMutationBatches(t).next(function(s){return o=s,r=n.persistence.getMutationQueue(e),i=new Ju(n.On,r,n.persistence.getIndexManager()),r.getAllMutationBatches(t)}).next(function(e){for(var n=[],r=[],s=Ts(),a=0,u=o;a<u.length;a++){var c=u[a];n.push(c.batchId);for(var h=0,l=c.mutations;h<l.length;h++)s=s.add(l[h].key)}for(var f=0,d=e;f<d.length;f++){var p=d[f];r.push(p.batchId);for(var y=0,v=p.mutations;y<v.length;y++)s=s.add(v[y].key)}return i.pn(t,s).next(function(t){return{Ln:t,removedBatchIds:n,addedBatchIds:r}})})})];case 1:return o=s.sent(),[2,(n._n=r,n.Mn=i,n.xn.Vn(n.Mn),o)]}})})}function ic(t,e){var n=Jr(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var r=e.batch.keys(),i=n.On.newChangeBuffer({trackRemovals:!0});return function(t,e,n,r){var i=n.batch,o=i.keys(),s=Va.resolve();return o.forEach(function(t){s=s.next(function(){return r.getEntry(e,t)}).next(function(e){var o=n.docVersions.get(t);$r(null!==o),e.version.compareTo(o)<0&&(i.applyToRemoteDocument(e,n),e.isValidDocument()&&r.addEntry(e,n.commitVersion))})}),s.next(function(){return t._n.removeMutationBatch(e,i)})}(n,t,e,i).next(function(){return i.apply(t)}).next(function(){return n._n.performConsistencyCheck(t)}).next(function(){return n.Mn.pn(t,r)})})}function oc(t){var e=Jr(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.qe.getLastRemoteSnapshotVersion(t)})}function sc(t,e){var n=Jr(t),r=e.snapshotVersion,i=n.Fn;return n.persistence.runTransaction("Apply remote event","readwrite-primary",function(t){var o=n.On.newChangeBuffer({trackRemovals:!0});i=n.Fn;var s=[];e.targetChanges.forEach(function(e,o){var a=i.get(o);if(a){s.push(n.qe.removeMatchingKeys(t,e.removedDocuments,o).next(function(){return n.qe.addMatchingKeys(t,e.addedDocuments,o)}));var u=e.resumeToken;if(u.approximateByteSize()>0){var c=a.withResumeToken(u,r).withSequenceNumber(t.currentSequenceNumber);i=i.insert(o,c),function(t,e,n){return $r(e.resumeToken.approximateByteSize()>0),0===t.resumeToken.approximateByteSize()||e.snapshotVersion.toMicroseconds()-t.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0}(a,c,e)&&s.push(n.qe.updateTargetData(t,c))}}});var a=vs();if(e.documentUpdates.forEach(function(r,i){e.resolvedLimboDocuments.has(r)&&s.push(n.persistence.referenceDelegate.updateLimboDocument(t,r))}),s.push(ac(t,o,e.documentUpdates,r,void 0).next(function(t){a=t})),!r.isEqual(oi.min())){var u=n.qe.getLastRemoteSnapshotVersion(t).next(function(e){return n.qe.setTargetsMetadata(t,t.currentSequenceNumber,r)});s.push(u)}return Va.waitFor(s).next(function(){return o.apply(t)}).next(function(){return n.Mn.En(t,a)}).next(function(){return a})}).then(function(t){return n.Fn=i,t})}function ac(t,e,n,r,i){var o=Ts();return n.forEach(function(t){return o=o.add(t)}),e.getEntries(t,o).next(function(t){var o=vs();return n.forEach(function(n,s){var a=t.get(n),u=(null==i?void 0:i.get(n))||r;s.isNoDocument()&&s.version.isEqual(oi.min())?(e.removeEntry(n,u),o=o.insert(n,s)):!a.isValidDocument()||s.version.compareTo(a.version)>0||0===s.version.compareTo(a.version)&&a.hasPendingWrites?(e.addEntry(s,u),o=o.insert(n,s)):Qr("LocalStore","Ignoring outdated watch update for ",n,". Current version:",a.version," Watch version:",s.version)}),o})}function uc(t,e){var n=Jr(t);return n.persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===e&&(e=-1),n._n.getNextMutationBatchAfterBatchId(t,e)})}function cc(t,e){var n=Jr(t);return n.persistence.runTransaction("Allocate target","readwrite",function(t){var r;return n.qe.getTargetData(t,e).next(function(i){return i?Va.resolve(r=i):n.qe.allocateTargetId(t).next(function(i){return r=new $a(e,i,0,t.currentSequenceNumber),n.qe.addTargetData(t,r).next(function(){return r})})})}).then(function(t){var r=n.Fn.get(t.targetId);return(null===r||t.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.Fn=n.Fn.insert(t.targetId,t),n.kn.set(e,t.targetId)),t})}function hc(t,e,n){return Object(Fr.b)(this,void 0,void 0,function(){var r,i,o,s;return Object(Fr.d)(this,function(a){switch(a.label){case 0:r=Jr(t),i=r.Fn.get(e),o=n?"readwrite":"readwrite-primary",a.label=1;case 1:return a.trys.push([1,4,,5]),n?[3,3]:[4,r.persistence.runTransaction("Release target",o,function(t){return r.persistence.referenceDelegate.removeTarget(t,i)})];case 2:a.sent(),a.label=3;case 3:return[3,5];case 4:if(!Ba(s=a.sent()))throw s;return Qr("LocalStore","Failed to update sequence numbers for target "+e+": "+s),[3,5];case 5:return r.Fn=r.Fn.remove(e),r.kn.delete(i.target),[2]}})})}function lc(t,e,n){var r=Jr(t),i=oi.min(),o=Ts();return r.persistence.runTransaction("Execute query","readonly",function(t){return function(t,e,n){var r=Jr(t),i=r.kn.get(n);return void 0!==i?Va.resolve(r.Fn.get(i)):r.qe.getTargetData(e,n)}(r,t,bo(e)).next(function(e){if(e)return i=e.lastLimboFreeSnapshotVersion,r.qe.getMatchingKeysForTargetId(t,e.targetId).next(function(t){o=t})}).next(function(){return r.xn.getDocumentsMatchingQuery(t,e,n?i:oi.min(),n?o:Ts())}).next(function(t){return{documents:t,Bn:o}})})}function fc(t,e){var n=Jr(t),r=Jr(n.qe),i=n.Fn.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",function(t){return r.lt(t,e).next(function(t){return t?t.target:null})})}function dc(t){var e=Jr(t);return e.persistence.runTransaction("Get new document changes","readonly",function(t){return function(t,e,n){var r=Jr(t),i=vs(),o=eu(n),s=Bu(e),a=IDBKeyRange.lowerBound(o,!0);return s.$t({index:_a.readTimeIndex,range:a},function(t,e){var n=Za(r.R,e);i=i.insert(n.key,n),o=e.readTime}).next(function(){return{wn:i,readTime:nu(o)}})}(e.On,t,e.$n)}).then(function(t){var n=t.wn;return e.$n=t.readTime,n})}function pc(t){return Object(Fr.b)(this,void 0,void 0,function(){var e;return Object(Fr.d)(this,function(n){return[2,(e=Jr(t)).persistence.runTransaction("Synchronize last document change read time","readonly",function(t){return function(t){var e=Bu(t),n=oi.min();return e.$t({index:_a.readTimeIndex,reverse:!0},function(t,e,r){e.readTime&&(n=nu(e.readTime)),r.done()}).next(function(){return n})}(t)}).then(function(t){e.$n=t})]})})}function yc(t,e,n,r){return Object(Fr.b)(this,void 0,void 0,function(){var i,o,s,a,u,c,h,l,f,d;return Object(Fr.d)(this,function(p){switch(p.label){case 0:for(i=Jr(t),o=Ts(),s=vs(),a=ws(),u=0,c=n;u<c.length;u++)l=e.qn((h=c[u]).metadata.name),h.document&&(o=o.add(l)),s=s.insert(l,e.Un(h)),a=a.insert(l,e.Qn(h.metadata.readTime));return f=i.On.newChangeBuffer({trackRemovals:!0}),[4,cc(i,function(t){return bo(lo(hi.fromString("__bundle__/docs/"+t)))}(r))];case 1:return d=p.sent(),[2,i.persistence.runTransaction("Apply bundle documents","readwrite",function(t){return ac(t,f,s,oi.min(),a).next(function(e){return f.apply(t),e}).next(function(e){return i.qe.removeMatchingKeysForTargetId(t,d.targetId).next(function(){return i.qe.addMatchingKeys(t,o,d.targetId)}).next(function(){return i.Mn.En(t,e)}).next(function(){return e})})})]}})})}function vc(t,e,n){return void 0===n&&(n=Ts()),Object(Fr.b)(this,void 0,void 0,function(){var r,i;return Object(Fr.d)(this,function(o){switch(o.label){case 0:return[4,cc(t,bo(uu(e.bundledQuery)))];case 1:return r=o.sent(),[2,(i=Jr(t)).persistence.runTransaction("Save named query","readwrite",function(t){var o=Fs(e.readTime);if(r.snapshotVersion.compareTo(o)>=0)return i.Qe.saveNamedQuery(t,e);var s=r.withResumeToken(pi.EMPTY_BYTE_STRING,o);return i.Fn=i.Fn.insert(s.targetId,s),i.qe.updateTargetData(t,s).next(function(){return i.qe.removeMatchingKeysForTargetId(t,r.targetId)}).next(function(){return i.qe.addMatchingKeys(t,n,r.targetId)}).next(function(){return i.Qe.saveNamedQuery(t,e)})})]}})})}var mc=function(){function t(t){this.R=t,this.Kn=new Map,this.jn=new Map}return t.prototype.getBundleMetadata=function(t,e){return Va.resolve(this.Kn.get(e))},t.prototype.saveBundleMetadata=function(t,e){var n;return this.Kn.set(e.id,{id:(n=e).id,version:n.version,createTime:Fs(n.createTime)}),Va.resolve()},t.prototype.getNamedQuery=function(t,e){return Va.resolve(this.jn.get(e))},t.prototype.saveNamedQuery=function(t,e){return this.jn.set(e.name,function(t){return{name:t.name,query:uu(t.bundledQuery),readTime:Fs(t.readTime)}}(e)),Va.resolve()},t}(),gc=function(){function t(){this.Wn=new ds(bc.Gn),this.zn=new ds(bc.Hn)}return t.prototype.isEmpty=function(){return this.Wn.isEmpty()},t.prototype.addReference=function(t,e){var n=new bc(t,e);this.Wn=this.Wn.add(n),this.zn=this.zn.add(n)},t.prototype.Jn=function(t,e){var n=this;t.forEach(function(t){return n.addReference(t,e)})},t.prototype.removeReference=function(t,e){this.Yn(new bc(t,e))},t.prototype.Xn=function(t,e){var n=this;t.forEach(function(t){return n.removeReference(t,e)})},t.prototype.Zn=function(t){var e=this,n=new Oi(new hi([])),r=new bc(n,t),i=new bc(n,t+1),o=[];return this.zn.forEachInRange([r,i],function(t){e.Yn(t),o.push(t.key)}),o},t.prototype.ts=function(){var t=this;this.Wn.forEach(function(e){return t.Yn(e)})},t.prototype.Yn=function(t){this.Wn=this.Wn.delete(t),this.zn=this.zn.delete(t)},t.prototype.es=function(t){var e=new Oi(new hi([])),n=new bc(e,t),r=new bc(e,t+1),i=Ts();return this.zn.forEachInRange([n,r],function(t){i=i.add(t.key)}),i},t.prototype.containsKey=function(t){var e=new bc(t,0),n=this.Wn.firstAfterOrEqual(e);return null!==n&&t.isEqual(n.key)},t}(),bc=function(){function t(t,e){this.key=t,this.ns=e}return t.Gn=function(t,e){return Oi.comparator(t.key,e.key)||ei(t.ns,e.ns)},t.Hn=function(t,e){return ei(t.ns,e.ns)||Oi.comparator(t.key,e.key)},t}(),wc=function(){function t(t,e){this.Ut=t,this.referenceDelegate=e,this._n=[],this.ss=1,this.rs=new ds(bc.Gn)}return t.prototype.checkEmpty=function(t){return Va.resolve(0===this._n.length)},t.prototype.addMutationBatch=function(t,e,n,r){var i=this.ss;this.ss++;var o=new Ya(i,e,n,r);this._n.push(o);for(var s=0,a=r;s<a.length;s++){var u=a[s];this.rs=this.rs.add(new bc(u.key,i)),this.Ut.addToCollectionParentIndex(t,u.key.path.popLast())}return Va.resolve(o)},t.prototype.lookupMutationBatch=function(t,e){return Va.resolve(this.os(e))},t.prototype.getNextMutationBatchAfterBatchId=function(t,e){var n=this.cs(e+1),r=n<0?0:n;return Va.resolve(this._n.length>r?this._n[r]:null)},t.prototype.getHighestUnacknowledgedBatchId=function(){return Va.resolve(0===this._n.length?-1:this.ss-1)},t.prototype.getAllMutationBatches=function(t){return Va.resolve(this._n.slice())},t.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=new bc(e,0),i=new bc(e,Number.POSITIVE_INFINITY),o=[];return this.rs.forEachInRange([r,i],function(t){var e=n.os(t.ns);o.push(e)}),Va.resolve(o)},t.prototype.getAllMutationBatchesAffectingDocumentKeys=function(t,e){var n=this,r=new ds(ei);return e.forEach(function(t){var e=new bc(t,0),i=new bc(t,Number.POSITIVE_INFINITY);n.rs.forEachInRange([e,i],function(t){r=r.add(t.ns)})}),Va.resolve(this.us(r))},t.prototype.getAllMutationBatchesAffectingQuery=function(t,e){var n=e.path,r=n.length+1,i=n;Oi.isDocumentKey(i)||(i=i.child(""));var o=new bc(new Oi(i),0),s=new ds(ei);return this.rs.forEachWhile(function(t){var e=t.key.path;return!!n.isPrefixOf(e)&&(e.length===r&&(s=s.add(t.ns)),!0)},o),Va.resolve(this.us(s))},t.prototype.us=function(t){var e=this,n=[];return t.forEach(function(t){var r=e.os(t);null!==r&&n.push(r)}),n},t.prototype.removeMutationBatch=function(t,e){var n=this;$r(0===this.hs(e.batchId,"removed")),this._n.shift();var r=this.rs;return Va.forEach(e.mutations,function(i){var o=new bc(i.key,e.batchId);return r=r.delete(o),n.referenceDelegate.markPotentiallyOrphaned(t,i.key)}).next(function(){n.rs=r})},t.prototype.Gt=function(t){},t.prototype.containsKey=function(t,e){var n=new bc(e,0),r=this.rs.firstAfterOrEqual(n);return Va.resolve(e.isEqual(r&&r.key))},t.prototype.performConsistencyCheck=function(t){return Va.resolve()},t.prototype.hs=function(t,e){return this.cs(t)},t.prototype.cs=function(t){return 0===this._n.length?0:t-this._n[0].batchId},t.prototype.os=function(t){var e=this.cs(t);return e<0||e>=this._n.length?null:this._n[e]},t}(),Ic=function(){function t(t,e){this.Ut=t,this.ls=e,this.docs=new hs(Oi.comparator),this.size=0}return t.prototype.addEntry=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,s=this.ls(e);return this.docs=this.docs.insert(r,{document:e.clone(),size:s,readTime:n}),this.size+=s-o,this.Ut.addToCollectionParentIndex(t,r.path.popLast())},t.prototype.removeEntry=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},t.prototype.getEntry=function(t,e){var n=this.docs.get(e);return Va.resolve(n?n.document.clone():Bi.newInvalidDocument(e))},t.prototype.getEntries=function(t,e){var n=this,r=vs();return e.forEach(function(t){var e=n.docs.get(t);r=r.insert(t,e?e.document.clone():Bi.newInvalidDocument(t))}),Va.resolve(r)},t.prototype.getDocumentsMatchingQuery=function(t,e,n){for(var r=vs(),i=new Oi(e.path.child("")),o=this.docs.getIteratorFrom(i);o.hasNext();){var s=o.getNext(),a=s.value,u=a.document,c=a.readTime;if(!e.path.isPrefixOf(s.key.path))break;c.compareTo(n)<=0||_o(e,u)&&(r=r.insert(u.key,u.clone()))}return Va.resolve(r)},t.prototype.fs=function(t,e){return Va.forEach(this.docs,function(t){return e(t)})},t.prototype.newChangeBuffer=function(t){return new Tc(this)},t.prototype.getSize=function(t){return Va.resolve(this.size)},t}(),Tc=function(t){function e(e){var n=this;return(n=t.call(this)||this).Ie=e,n}return Object(Fr.c)(e,t),e.prototype.applyChanges=function(t){var e=this,n=[];return this.changes.forEach(function(r,i){i.document.isValidDocument()?n.push(e.Ie.addEntry(t,i.document,e.getReadTime(r))):e.Ie.removeEntry(r)}),Va.waitFor(n)},e.prototype.getFromCache=function(t,e){return this.Ie.getEntry(t,e)},e.prototype.getAllFromCache=function(t,e){return this.Ie.getEntries(t,e)},e}(Uu),Ec=function(){function t(t){this.persistence=t,this.ds=new Vu(function(t){return zi(t)},Qi),this.lastRemoteSnapshotVersion=oi.min(),this.highestTargetId=0,this.ws=0,this._s=new gc,this.targetCount=0,this.ys=Ou.Jt()}return t.prototype.forEachTarget=function(t,e){return this.ds.forEach(function(t,n){return e(n)}),Va.resolve()},t.prototype.getLastRemoteSnapshotVersion=function(t){return Va.resolve(this.lastRemoteSnapshotVersion)},t.prototype.getHighestSequenceNumber=function(t){return Va.resolve(this.ws)},t.prototype.allocateTargetId=function(t){return this.highestTargetId=this.ys.next(),Va.resolve(this.highestTargetId)},t.prototype.setTargetsMetadata=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.ws&&(this.ws=e),Va.resolve()},t.prototype.te=function(t){this.ds.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.ys=new Ou(e),this.highestTargetId=e),t.sequenceNumber>this.ws&&(this.ws=t.sequenceNumber)},t.prototype.addTargetData=function(t,e){return this.te(e),this.targetCount+=1,Va.resolve()},t.prototype.updateTargetData=function(t,e){return this.te(e),Va.resolve()},t.prototype.removeTargetData=function(t,e){return this.ds.delete(e.target),this._s.Zn(e.targetId),this.targetCount-=1,Va.resolve()},t.prototype.removeTargets=function(t,e,n){var r=this,i=0,o=[];return this.ds.forEach(function(s,a){a.sequenceNumber<=e&&null===n.get(a.targetId)&&(r.ds.delete(s),o.push(r.removeMatchingKeysForTargetId(t,a.targetId)),i++)}),Va.waitFor(o).next(function(){return i})},t.prototype.getTargetCount=function(t){return Va.resolve(this.targetCount)},t.prototype.getTargetData=function(t,e){var n=this.ds.get(e)||null;return Va.resolve(n)},t.prototype.addMatchingKeys=function(t,e,n){return this._s.Jn(e,n),Va.resolve()},t.prototype.removeMatchingKeys=function(t,e,n){this._s.Xn(e,n);var r=this.persistence.referenceDelegate,i=[];return r&&e.forEach(function(e){i.push(r.markPotentiallyOrphaned(t,e))}),Va.waitFor(i)},t.prototype.removeMatchingKeysForTargetId=function(t,e){return this._s.Zn(e),Va.resolve()},t.prototype.getMatchingKeysForTargetId=function(t,e){var n=this._s.es(e);return Va.resolve(n)},t.prototype.containsKey=function(t,e){return Va.resolve(this._s.containsKey(e))},t}(),_c=function(){function t(t,e){var n=this;this.gs={},this.Ne=new qr(0),this.xe=!1,this.xe=!0,this.referenceDelegate=t(this),this.qe=new Ec(this),this.Ut=new fu,this.Ue=function(t,e){return new Ic(t,function(t){return n.referenceDelegate.ps(t)})}(this.Ut),this.R=new Ja(e),this.Qe=new mc(this.R)}return t.prototype.start=function(){return Promise.resolve()},t.prototype.shutdown=function(){return this.xe=!1,Promise.resolve()},Object.defineProperty(t.prototype,"started",{get:function(){return this.xe},enumerable:!1,configurable:!0}),t.prototype.setDatabaseDeletedListener=function(){},t.prototype.setNetworkEnabled=function(){},t.prototype.getIndexManager=function(){return this.Ut},t.prototype.getMutationQueue=function(t){var e=this.gs[t.toKey()];return e||(e=new wc(this.Ut,this.referenceDelegate),this.gs[t.toKey()]=e),e},t.prototype.getTargetCache=function(){return this.qe},t.prototype.getRemoteDocumentCache=function(){return this.Ue},t.prototype.getBundleCache=function(){return this.Qe},t.prototype.runTransaction=function(t,e,n){var r=this;Qr("MemoryPersistence","Starting transaction:",t);var i=new Oc(this.Ne.next());return this.referenceDelegate.Es(),n(i).next(function(t){return r.referenceDelegate.Ts(i).next(function(){return t})}).toPromise().then(function(t){return i.raiseOnCommittedEvent(),t})},t.prototype.Is=function(t,e){return Va.or(Object.values(this.gs).map(function(n){return function(){return n.containsKey(t,e)}}))},t}(),Oc=function(t){function e(e){var n=this;return(n=t.call(this)||this).currentSequenceNumber=e,n}return Object(Fr.c)(e,t),e}(Pa),Sc=function(){function t(t){this.persistence=t,this.As=new gc,this.Rs=null}return t.bs=function(e){return new t(e)},Object.defineProperty(t.prototype,"vs",{get:function(){if(this.Rs)return this.Rs;throw Xr()},enumerable:!1,configurable:!0}),t.prototype.addReference=function(t,e,n){return this.As.addReference(n,e),this.vs.delete(n.toString()),Va.resolve()},t.prototype.removeReference=function(t,e,n){return this.As.removeReference(n,e),this.vs.add(n.toString()),Va.resolve()},t.prototype.markPotentiallyOrphaned=function(t,e){return this.vs.add(e.toString()),Va.resolve()},t.prototype.removeTarget=function(t,e){var n=this;this.As.Zn(e.targetId).forEach(function(t){return n.vs.add(t.toString())});var r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(t,e.targetId).next(function(t){t.forEach(function(t){return n.vs.add(t.toString())})}).next(function(){return r.removeTargetData(t,e)})},t.prototype.Es=function(){this.Rs=new Set},t.prototype.Ts=function(t){var e=this,n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Va.forEach(this.vs,function(r){var i=Oi.fromPath(r);return e.Ps(t,i).next(function(t){t||n.removeEntry(i)})}).next(function(){return e.Rs=null,n.apply(t)})},t.prototype.updateLimboDocument=function(t,e){var n=this;return this.Ps(t,e).next(function(t){t?n.vs.delete(e.toString()):n.vs.add(e.toString())})},t.prototype.ps=function(t){return 0},t.prototype.Ps=function(t,e){var n=this;return Va.or([function(){return Va.resolve(n.As.containsKey(e))},function(){return n.persistence.getTargetCache().containsKey(t,e)},function(){return n.persistence.Is(t,e)}])},t}(),Dc=function(){function t(t){this.uid=t}return t.prototype.isAuthenticated=function(){return null!=this.uid},t.prototype.toKey=function(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"},t.prototype.isEqual=function(t){return t.uid===this.uid},t}();function Nc(t,e){return"firestore_clients_"+t+"_"+e}function Ac(t,e,n){var r="firestore_mutations_"+t+"_"+n;return e.isAuthenticated()&&(r+="_"+e.uid),r}function kc(t,e){return"firestore_targets_"+t+"_"+e}Dc.UNAUTHENTICATED=new Dc(null),Dc.GOOGLE_CREDENTIALS=new Dc("google-credentials-uid"),Dc.FIRST_PARTY=new Dc("first-party-uid");var xc=function(){function t(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}return t.Vs=function(e,n,r){var i,o=JSON.parse(r),s="object"==typeof o&&-1!==["pending","acknowledged","rejected"].indexOf(o.state)&&(void 0===o.error||"object"==typeof o.error);return s&&o.error&&(s="string"==typeof o.error.message&&"string"==typeof o.error.code)&&(i=new Kr(o.error.code,o.error.message)),s?new t(e,n,o.state,i):(Hr("SharedClientState","Failed to parse mutation state for ID '"+n+"': "+r),null)},t.prototype.Ss=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),Cc=function(){function t(t,e,n){this.targetId=t,this.state=e,this.error=n}return t.Vs=function(e,n){var r,i=JSON.parse(n),o="object"==typeof i&&-1!==["not-current","current","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error);return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(r=new Kr(i.error.code,i.error.message)),o?new t(e,i.state,r):(Hr("SharedClientState","Failed to parse target state for ID '"+e+"': "+n),null)},t.prototype.Ss=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),jc=function(){function t(t,e){this.clientId=t,this.activeTargetIds=e}return t.Vs=function(e,n){for(var r=JSON.parse(n),i="object"==typeof r&&r.activeTargetIds instanceof Array,o=_s(),s=0;i&&s<r.activeTargetIds.length;++s)i=_i(r.activeTargetIds[s]),o=o.add(r.activeTargetIds[s]);return i?new t(e,o):(Hr("SharedClientState","Failed to parse client data for instance '"+e+"': "+n),null)},t}(),Rc=function(){function t(t,e){this.clientId=t,this.onlineState=e}return t.Vs=function(e){var n=JSON.parse(e);return"object"==typeof n&&-1!==["Unknown","Online","Offline"].indexOf(n.onlineState)&&"string"==typeof n.clientId?new t(n.clientId,n.onlineState):(Hr("SharedClientState","Failed to parse online state: "+e),null)},t}(),Pc=function(){function t(){this.activeTargetIds=_s()}return t.prototype.Ds=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},t.prototype.Cs=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},t.prototype.Ss=function(){var t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)},t}(),Lc=function(){function t(t,e,n,r,i){this.window=t,this.Se=e,this.persistenceKey=n,this.Ns=r,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.xs=this.Fs.bind(this),this.ks=new hs(ei),this.started=!1,this.$s=[];var o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Os=Nc(this.persistenceKey,this.Ns),this.Ms=function(t){return"firestore_sequence_number_"+t}(this.persistenceKey),this.ks=this.ks.insert(this.Ns,new Pc),this.Ls=new RegExp("^firestore_clients_"+o+"_([^_]*)$"),this.Bs=new RegExp("^firestore_mutations_"+o+"_(\\d+)(?:_(.*))?$"),this.qs=new RegExp("^firestore_targets_"+o+"_(\\d+)$"),this.Us=function(t){return"firestore_online_state_"+t}(this.persistenceKey),this.Qs=function(t){return"firestore_bundle_loaded_"+t}(this.persistenceKey),this.window.addEventListener("storage",this.xs)}return t.yt=function(t){return!(!t||!t.localStorage)},t.prototype.start=function(){return Object(Fr.b)(this,void 0,void 0,function(){var t,e,n,r,i,o,s,a,u,c,h=this;return Object(Fr.d)(this,function(l){switch(l.label){case 0:return[4,this.syncEngine.fn()];case 1:for(t=l.sent(),e=0,n=t;e<n.length;e++)(r=n[e])!==this.Ns&&(i=this.getItem(Nc(this.persistenceKey,r)))&&(o=jc.Vs(r,i))&&(this.ks=this.ks.insert(o.clientId,o));for(this.Ks(),(s=this.storage.getItem(this.Us))&&(a=this.js(s))&&this.Ws(a),u=0,c=this.$s;u<c.length;u++)this.Fs(c[u]);return this.$s=[],this.window.addEventListener("pagehide",function(){return h.shutdown()}),this.started=!0,[2]}})})},t.prototype.writeSequenceNumber=function(t){this.setItem(this.Ms,JSON.stringify(t))},t.prototype.getAllActiveQueryTargets=function(){return this.Gs(this.ks)},t.prototype.isActiveQueryTarget=function(t){var e=!1;return this.ks.forEach(function(n,r){r.activeTargetIds.has(t)&&(e=!0)}),e},t.prototype.addPendingMutation=function(t){this.zs(t,"pending")},t.prototype.updateMutationState=function(t,e,n){this.zs(t,e,n),this.Hs(t)},t.prototype.addLocalQueryTarget=function(t){var e="not-current";if(this.isActiveQueryTarget(t)){var n=this.storage.getItem(kc(this.persistenceKey,t));if(n){var r=Cc.Vs(t,n);r&&(e=r.state)}}return this.Js.Ds(t),this.Ks(),e},t.prototype.removeLocalQueryTarget=function(t){this.Js.Cs(t),this.Ks()},t.prototype.isLocalQueryTarget=function(t){return this.Js.activeTargetIds.has(t)},t.prototype.clearQueryState=function(t){this.removeItem(kc(this.persistenceKey,t))},t.prototype.updateQueryState=function(t,e,n){this.Ys(t,e,n)},t.prototype.handleUserChange=function(t,e,n){var r=this;e.forEach(function(t){r.Hs(t)}),this.currentUser=t,n.forEach(function(t){r.addPendingMutation(t)})},t.prototype.setOnlineState=function(t){this.Xs(t)},t.prototype.notifyBundleLoaded=function(){this.Zs()},t.prototype.shutdown=function(){this.started&&(this.window.removeEventListener("storage",this.xs),this.removeItem(this.Os),this.started=!1)},t.prototype.getItem=function(t){var e=this.storage.getItem(t);return Qr("SharedClientState","READ",t,e),e},t.prototype.setItem=function(t,e){Qr("SharedClientState","SET",t,e),this.storage.setItem(t,e)},t.prototype.removeItem=function(t){Qr("SharedClientState","REMOVE",t),this.storage.removeItem(t)},t.prototype.Fs=function(t){var e=this,n=t;if(n.storageArea===this.storage){if(Qr("SharedClientState","EVENT",n.key,n.newValue),n.key===this.Os)return void Hr("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Se.enqueueRetryable(function(){return Object(Fr.b)(e,void 0,void 0,function(){var t,e,r,i,o,s;return Object(Fr.d)(this,function(a){if(this.started){if(null!==n.key)if(this.Ls.test(n.key)){if(null==n.newValue)return t=this.ti(n.key),[2,this.ei(t,null)];if(e=this.ni(n.key,n.newValue))return[2,this.ei(e.clientId,e)]}else if(this.Bs.test(n.key)){if(null!==n.newValue&&(r=this.si(n.key,n.newValue)))return[2,this.ii(r)]}else if(this.qs.test(n.key)){if(null!==n.newValue&&(i=this.ri(n.key,n.newValue)))return[2,this.oi(i)]}else if(n.key===this.Us){if(null!==n.newValue&&(o=this.js(n.newValue)))return[2,this.Ws(o)]}else if(n.key===this.Ms)(s=function(t){var e=qr.o;if(null!=t)try{var n=JSON.parse(t);$r("number"==typeof n),e=n}catch(t){Hr("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(n.newValue))!==qr.o&&this.sequenceNumberHandler(s);else if(n.key===this.Qs)return[2,this.syncEngine.ci()]}else this.$s.push(n);return[2]})})})}},Object.defineProperty(t.prototype,"Js",{get:function(){return this.ks.get(this.Ns)},enumerable:!1,configurable:!0}),t.prototype.Ks=function(){this.setItem(this.Os,this.Js.Ss())},t.prototype.zs=function(t,e,n){var r=new xc(this.currentUser,t,e,n),i=Ac(this.persistenceKey,this.currentUser,t);this.setItem(i,r.Ss())},t.prototype.Hs=function(t){var e=Ac(this.persistenceKey,this.currentUser,t);this.removeItem(e)},t.prototype.Xs=function(t){this.storage.setItem(this.Us,JSON.stringify({clientId:this.Ns,onlineState:t}))},t.prototype.Ys=function(t,e,n){var r=kc(this.persistenceKey,t),i=new Cc(t,e,n);this.setItem(r,i.Ss())},t.prototype.Zs=function(){this.setItem(this.Qs,"value-not-used")},t.prototype.ti=function(t){var e=this.Ls.exec(t);return e?e[1]:null},t.prototype.ni=function(t,e){var n=this.ti(t);return jc.Vs(n,e)},t.prototype.si=function(t,e){var n=this.Bs.exec(t),r=Number(n[1]);return xc.Vs(new Dc(void 0!==n[2]?n[2]:null),r,e)},t.prototype.ri=function(t,e){var n=this.qs.exec(t),r=Number(n[1]);return Cc.Vs(r,e)},t.prototype.js=function(t){return Rc.Vs(t)},t.prototype.ii=function(t){return Object(Fr.b)(this,void 0,void 0,function(){return Object(Fr.d)(this,function(e){return t.user.uid===this.currentUser.uid?[2,this.syncEngine.ui(t.batchId,t.state,t.error)]:(Qr("SharedClientState","Ignoring mutation for non-active user "+t.user.uid),[2])})})},t.prototype.oi=function(t){return this.syncEngine.ai(t.targetId,t.state,t.error)},t.prototype.ei=function(t,e){var n=this,r=e?this.ks.insert(t,e):this.ks.remove(t),i=this.Gs(this.ks),o=this.Gs(r),s=[],a=[];return o.forEach(function(t){i.has(t)||s.push(t)}),i.forEach(function(t){o.has(t)||a.push(t)}),this.syncEngine.hi(s,a).then(function(){n.ks=r})},t.prototype.Ws=function(t){this.ks.get(t.clientId)&&this.onlineStateHandler(t.onlineState)},t.prototype.Gs=function(t){var e=_s();return t.forEach(function(t,n){e=e.unionWith(n.activeTargetIds)}),e},t}(),Vc=function(){function t(){this.li=new Pc,this.fi={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}return t.prototype.addPendingMutation=function(t){},t.prototype.updateMutationState=function(t,e,n){},t.prototype.addLocalQueryTarget=function(t){return this.li.Ds(t),this.fi[t]||"not-current"},t.prototype.updateQueryState=function(t,e,n){this.fi[t]=e},t.prototype.removeLocalQueryTarget=function(t){this.li.Cs(t)},t.prototype.isLocalQueryTarget=function(t){return this.li.activeTargetIds.has(t)},t.prototype.clearQueryState=function(t){delete this.fi[t]},t.prototype.getAllActiveQueryTargets=function(){return this.li.activeTargetIds},t.prototype.isActiveQueryTarget=function(t){return this.li.activeTargetIds.has(t)},t.prototype.start=function(){return this.li=new Pc,Promise.resolve()},t.prototype.handleUserChange=function(t,e,n){},t.prototype.setOnlineState=function(t){},t.prototype.shutdown=function(){},t.prototype.writeSequenceNumber=function(t){},t.prototype.notifyBundleLoaded=function(){},t}(),Uc=function(){function t(){}return t.prototype.di=function(t){},t.prototype.shutdown=function(){},t}(),Mc=function(){function t(){var t=this;this.wi=function(){return t._i()},this.mi=function(){return t.yi()},this.gi=[],this.pi()}return t.prototype.di=function(t){this.gi.push(t)},t.prototype.shutdown=function(){window.removeEventListener("online",this.wi),window.removeEventListener("offline",this.mi)},t.prototype.pi=function(){window.addEventListener("online",this.wi),window.addEventListener("offline",this.mi)},t.prototype._i=function(){Qr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.gi;t<e.length;t++)(0,e[t])(0)},t.prototype.yi=function(){Qr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.gi;t<e.length;t++)(0,e[t])(1)},t.yt=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},t}(),Fc={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},qc=function(){function t(t){this.Ei=t.Ei,this.Ti=t.Ti}return t.prototype.Ii=function(t){this.Ai=t},t.prototype.Ri=function(t){this.bi=t},t.prototype.onMessage=function(t){this.vi=t},t.prototype.close=function(){this.Ti()},t.prototype.send=function(t){this.Ei(t)},t.prototype.Pi=function(){this.Ai()},t.prototype.Vi=function(t){this.bi(t)},t.prototype.Si=function(t){this.vi(t)},t}(),Bc=function(t){function e(e){var n=this;return(n=t.call(this,e)||this).forceLongPolling=e.forceLongPolling,n.autoDetectLongPolling=e.autoDetectLongPolling,n.useFetchStreams=e.useFetchStreams,n}return Object(Fr.c)(e,t),e.prototype.ki=function(t,e,n,r){return new Promise(function(i,o){var s=new Mr;s.listenOnce(Pr.COMPLETE,function(){try{switch(s.getLastErrorCode()){case Rr.NO_ERROR:var e=s.getResponseJson();Qr("Connection","XHR received:",JSON.stringify(e)),i(e);break;case Rr.TIMEOUT:Qr("Connection",'RPC "'+t+'" timed out'),o(new Kr(Br.DEADLINE_EXCEEDED,"Request time out"));break;case Rr.HTTP_ERROR:var n=s.getStatus();if(Qr("Connection",'RPC "'+t+'" failed with status:',n,"response text:",s.getResponseText()),n>0){var r=s.getResponseJson().error;if(r&&r.status&&r.message){var a=function(t){var e=t.toLowerCase().replace(/_/g,"-");return Object.values(Br).indexOf(e)>=0?e:Br.UNKNOWN}(r.status);o(new Kr(a,r.message))}else o(new Kr(Br.UNKNOWN,"Server responded with status "+s.getStatus()))}else o(new Kr(Br.UNAVAILABLE,"Connection failed."));break;default:Xr()}}finally{Qr("Connection",'RPC "'+t+'" completed.')}});var a=JSON.stringify(r);s.send(e,"POST",a,n,15)})},e.prototype.Oi=function(t,e){var n=[this.Di,"/","google.firestore.v1.Firestore","/",t,"/channel"],r=new Er,i=Oe(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(o.xmlHttpFactory=new Vr({})),this.Fi(o.initMessageHeaders,e),Object(A.o)()||Object(A.q)()||Object(A.m)()||Object(A.n)()||Object(A.r)()||Object(A.l)()||(o.httpHeadersOverwriteParam="$httpHeaders");var s=n.join("");Qr("Connection","Creating WebChannel: "+s,o);var a=r.createWebChannel(s,o),u=!1,c=!1,h=new qc({Ei:function(t){c?Qr("Connection","Not sending because WebChannel is closed:",t):(u||(Qr("Connection","Opening WebChannel transport."),a.open(),u=!0),Qr("Connection","WebChannel sending:",t),a.send(t))},Ti:function(){return a.close()}}),l=function(t,e,n){t.listen(e,function(t){try{n(t)}catch(t){setTimeout(function(){throw t},0)}})};return l(a,Ur.EventType.OPEN,function(){c||Qr("Connection","WebChannel transport opened.")}),l(a,Ur.EventType.CLOSE,function(){c||(c=!0,Qr("Connection","WebChannel transport closed"),h.Vi())}),l(a,Ur.EventType.ERROR,function(t){c||(c=!0,Wr("Connection","WebChannel transport errored:",t),h.Vi(new Kr(Br.UNAVAILABLE,"The operation could not be completed")))}),l(a,Ur.EventType.MESSAGE,function(t){var e;if(!c){var n=t.data[0];$r(!!n);var r=n.error||(null===(e=n[0])||void 0===e?void 0:e.error);if(r){Qr("Connection","WebChannel received error:",r);var i=r.status,o=function(t){var e=rs[t];if(void 0!==e)return cs(e)}(i),s=r.message;void 0===o&&(o=Br.INTERNAL,s="Unknown error status: "+i+" with message "+r.message),c=!0,h.Vi(new Kr(o,s)),a.close()}else Qr("Connection","WebChannel received:",n),h.Si(n)}}),l(i,Lr.STAT_EVENT,function(t){10===t.stat?Qr("Connection","Detected buffering proxy"):11===t.stat&&Qr("Connection","Detected no buffering proxy")}),setTimeout(function(){h.Pi()},0),h},e}(function(){function t(t){this.databaseInfo=t,this.databaseId=t.databaseId,this.Di=(t.ssl?"https":"http")+"://"+t.host,this.Ci="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}return t.prototype.Ni=function(t,e,n,r){var i=this.xi(t,e);Qr("RestConnection","Sending: ",i,n);var o={};return this.Fi(o,r),this.ki(t,i,o,n).then(function(t){return Qr("RestConnection","Received: ",t),t},function(e){throw Wr("RestConnection",t+" failed with error: ",e,"url: ",i,"request:",n),e})},t.prototype.$i=function(t,e,n,r){return this.Ni(t,e,n,r)},t.prototype.Fi=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.6.8",t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e)for(var n in e.authHeaders)e.authHeaders.hasOwnProperty(n)&&(t[n]=e.authHeaders[n])},t.prototype.xi=function(t,e){return this.Di+"/v1/"+e+":"+Fc[t]},t}());function Kc(){return"undefined"!=typeof window?window:null}function Gc(){return"undefined"!=typeof document?document:null}function zc(t){return new Ls(t,!0)}var Qc=function(){function t(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.Se=t,this.timerId=e,this.Mi=n,this.Li=r,this.Bi=i,this.qi=0,this.Ui=null,this.Qi=Date.now(),this.reset()}return t.prototype.reset=function(){this.qi=0},t.prototype.Ki=function(){this.qi=this.Bi},t.prototype.ji=function(t){var e=this;this.cancel();var n=Math.floor(this.qi+this.Wi()),r=Math.max(0,Date.now()-this.Qi),i=Math.max(0,n-r);i>0&&Qr("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.qi+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Ui=this.Se.enqueueAfterDelay(this.timerId,i,function(){return e.Qi=Date.now(),t()}),this.qi*=this.Li,this.qi<this.Mi&&(this.qi=this.Mi),this.qi>this.Bi&&(this.qi=this.Bi)},t.prototype.Gi=function(){null!==this.Ui&&(this.Ui.skipDelay(),this.Ui=null)},t.prototype.cancel=function(){null!==this.Ui&&(this.Ui.cancel(),this.Ui=null)},t.prototype.Wi=function(){return(Math.random()-.5)*this.qi},t}(),Hc=function(){function t(t,e,n,r,i,o){this.Se=t,this.zi=n,this.Hi=r,this.Ji=i,this.listener=o,this.state=0,this.Yi=0,this.Xi=null,this.stream=null,this.Zi=new Qc(t,e)}return t.prototype.tr=function(){return 1===this.state||2===this.state||4===this.state},t.prototype.er=function(){return 2===this.state},t.prototype.start=function(){3!==this.state?this.auth():this.nr()},t.prototype.stop=function(){return Object(Fr.b)(this,void 0,void 0,function(){return Object(Fr.d)(this,function(t){switch(t.label){case 0:return this.tr()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},t.prototype.sr=function(){this.state=0,this.Zi.reset()},t.prototype.ir=function(){var t=this;this.er()&&null===this.Xi&&(this.Xi=this.Se.enqueueAfterDelay(this.zi,6e4,function(){return t.rr()}))},t.prototype.cr=function(t){this.ur(),this.stream.send(t)},t.prototype.rr=function(){return Object(Fr.b)(this,void 0,void 0,function(){return Object(Fr.d)(this,function(t){return this.er()?[2,this.close(0)]:[2]})})},t.prototype.ur=function(){this.Xi&&(this.Xi.cancel(),this.Xi=null)},t.prototype.close=function(t,e){return Object(Fr.b)(this,void 0,void 0,function(){return Object(Fr.d)(this,function(n){switch(n.label){case 0:return this.ur(),this.Zi.cancel(),this.Yi++,3!==t?this.Zi.reset():e&&e.code===Br.RESOURCE_EXHAUSTED?(Hr(e.toString()),Hr("Using maximum backoff delay to prevent overloading the backend."),this.Zi.Ki()):e&&e.code===Br.UNAUTHENTICATED&&this.Ji.invalidateToken(),null!==this.stream&&(this.ar(),this.stream.close(),this.stream=null),this.state=t,[4,this.listener.Ri(e)];case 1:return n.sent(),[2]}})})},t.prototype.ar=function(){},t.prototype.auth=function(){var t=this;this.state=1;var e=this.hr(this.Yi),n=this.Yi;this.Ji.getToken().then(function(e){t.Yi===n&&t.lr(e)},function(n){e(function(){var e=new Kr(Br.UNKNOWN,"Fetching auth token failed: "+n.message);return t.dr(e)})})},t.prototype.lr=function(t){var e=this,n=this.hr(this.Yi);this.stream=this.wr(t),this.stream.Ii(function(){n(function(){return e.state=2,e.listener.Ii()})}),this.stream.Ri(function(t){n(function(){return e.dr(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},t.prototype.nr=function(){var t=this;this.state=4,this.Zi.ji(function(){return Object(Fr.b)(t,void 0,void 0,function(){return Object(Fr.d)(this,function(t){return this.state=0,this.start(),[2]})})})},t.prototype.dr=function(t){return Qr("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},t.prototype.hr=function(t){var e=this;return function(n){e.Se.enqueueAndForget(function(){return e.Yi===t?n():(Qr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},t}(),Wc=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,"listen_stream_connection_backoff","listen_stream_idle",n,r,o)||this).R=i,s}return Object(Fr.c)(e,t),e.prototype.wr=function(t){return this.Hi.Oi("Listen",t)},e.prototype.onMessage=function(t){this.Zi.reset();var e=function(t,e){var n;if("targetChange"in e){var r=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:Xr()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(t,e){return t.I?($r(void 0===e||"string"==typeof e),pi.fromBase64String(e||"")):($r(void 0===e||e instanceof Uint8Array),pi.fromUint8Array(e||new Uint8Array))}(t,e.targetChange.resumeToken),s=(a=e.targetChange.cause)&&function(t){var e=void 0===t.code?Br.UNKNOWN:cs(t.code);return new Kr(e,t.message||"")}(a);n=new As(r,i,o,s||null)}else if("documentChange"in e){i=Gs(t,(r=e.documentChange).document.name),o=Fs(r.document.updateTime);var a=new Fi({mapValue:{fields:r.document.fields}}),u=(s=Bi.newFoundDocument(i,o,a),r.targetIds||[]);n=new Ds(u,r.removedTargetIds||[],s.key,s)}else if("documentDelete"in e)i=Gs(t,(r=e.documentDelete).document),o=r.readTime?Fs(r.readTime):oi.min(),a=Bi.newNoDocument(i,o),n=new Ds([],s=r.removedTargetIds||[],a.key,a);else if("documentRemove"in e)i=Gs(t,(r=e.documentRemove).document),n=new Ds([],o=r.removedTargetIds||[],i,null);else{if(!("filter"in e))return Xr();var c=e.filter;i=new as(r=c.count||0),n=new Ns(o=c.targetId,i)}return n}(this.R,t),n=function(t){if(!("targetChange"in t))return oi.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length?oi.min():e.readTime?Fs(e.readTime):oi.min()}(t);return this.listener._r(e,n)},e.prototype.mr=function(t){var e={};e.database=Hs(this.R),e.addTarget=function(t,e){var n,r=e.target;return(n=Hi(r)?{documents:Zs(t,r)}:{query:ta(t,r)}).targetId=e.targetId,e.resumeToken.approximateByteSize()>0?n.resumeToken=Us(t,e.resumeToken):e.snapshotVersion.compareTo(oi.min())>0&&(n.readTime=Vs(t,e.snapshotVersion.toTimestamp())),n}(this.R,t);var n=function(t,e){var n=function(t,e){switch(e){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Xr()}}(0,e.purpose);return null==n?null:{"goog-listen-tags":n}}(0,t);n&&(e.labels=n),this.cr(e)},e.prototype.yr=function(t){var e={};e.database=Hs(this.R),e.removeTarget=t,this.cr(e)},e}(Hc),Yc=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,"write_stream_connection_backoff","write_stream_idle",n,r,o)||this).R=i,s.gr=!1,s}return Object(Fr.c)(e,t),Object.defineProperty(e.prototype,"pr",{get:function(){return this.gr},enumerable:!1,configurable:!0}),e.prototype.start=function(){this.gr=!1,this.lastStreamToken=void 0,t.prototype.start.call(this)},e.prototype.ar=function(){this.gr&&this.Er([])},e.prototype.wr=function(t){return this.Hi.Oi("Write",t)},e.prototype.onMessage=function(t){if($r(!!t.streamToken),this.lastStreamToken=t.streamToken,this.gr){this.Zi.reset();var e=function(t,e){return t&&t.length>0?($r(void 0!==e),t.map(function(t){return function(t,e){var n=Fs(t.updateTime?t.updateTime:e);return n.isEqual(oi.min())&&(n=Fs(e)),new Ko(n,t.transformResults||[])}(t,e)})):[]}(t.writeResults,t.commitTime),n=Fs(t.commitTime);return this.listener.Tr(n,e)}return $r(!t.writeResults||0===t.writeResults.length),this.gr=!0,this.listener.Ir()},e.prototype.Ar=function(){var t={};t.database=Hs(this.R),this.cr(t)},e.prototype.Er=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map(function(t){return $s(e.R,t)})};this.cr(n)},e}(Hc),Xc=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).credentials=e,i.Hi=n,i.R=r,i.Rr=!1,i}return Object(Fr.c)(e,t),e.prototype.br=function(){if(this.Rr)throw new Kr(Br.FAILED_PRECONDITION,"The client has already been terminated.")},e.prototype.Ni=function(t,e,n){var r=this;return this.br(),this.credentials.getToken().then(function(i){return r.Hi.Ni(t,e,n,i)}).catch(function(t){throw"FirebaseError"===t.name?(t.code===Br.UNAUTHENTICATED&&r.credentials.invalidateToken(),t):new Kr(Br.UNKNOWN,t.toString())})},e.prototype.$i=function(t,e,n){var r=this;return this.br(),this.credentials.getToken().then(function(i){return r.Hi.$i(t,e,n,i)}).catch(function(t){throw"FirebaseError"===t.name?(t.code===Br.UNAUTHENTICATED&&r.credentials.invalidateToken(),t):new Kr(Br.UNKNOWN,t.toString())})},e.prototype.terminate=function(){this.Rr=!0},e}(function(){}),$c=function(){function t(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.vr=0,this.Pr=null,this.Vr=!0}return t.prototype.Sr=function(){var t=this;0===this.vr&&(this.Dr("Unknown"),this.Pr=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,function(){return t.Pr=null,t.Cr("Backend didn't respond within 10 seconds."),t.Dr("Offline"),Promise.resolve()}))},t.prototype.Nr=function(t){"Online"===this.state?this.Dr("Unknown"):(this.vr++,this.vr>=1&&(this.Fr(),this.Cr("Connection failed 1 times. Most recent error: "+t.toString()),this.Dr("Offline")))},t.prototype.set=function(t){this.Fr(),this.vr=0,"Online"===t&&(this.Vr=!1),this.Dr(t)},t.prototype.Dr=function(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))},t.prototype.Cr=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Vr?(Hr(e),this.Vr=!1):Qr("OnlineStateTracker",e)},t.prototype.Fr=function(){null!==this.Pr&&(this.Pr.cancel(),this.Pr=null)},t}(),Jc=function(t,e,n,r,i){var o=this;this.localStore=t,this.datastore=e,this.asyncQueue=n,this.remoteSyncer={},this.kr=[],this.$r=new Map,this.Or=new Set,this.Mr=[],this.Lr=i,this.Lr.di(function(t){n.enqueueAndForget(function(){return Object(Fr.b)(o,void 0,void 0,function(){return Object(Fr.d)(this,function(t){switch(t.label){case 0:return ah(this)?(Qr("RemoteStore","Restarting streams for network reachability change."),[4,function(t){return Object(Fr.b)(this,void 0,void 0,function(){var e;return Object(Fr.d)(this,function(n){switch(n.label){case 0:return(e=Jr(t)).Or.add(4),[4,th(e)];case 1:return n.sent(),e.Br.set("Unknown"),e.Or.delete(4),[4,Zc(e)];case 2:return n.sent(),[2]}})})}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.Br=new $c(n,r)};function Zc(t){return Object(Fr.b)(this,void 0,void 0,function(){var e,n;return Object(Fr.d)(this,function(r){switch(r.label){case 0:if(!ah(t))return[3,4];e=0,n=t.Mr,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function th(t){return Object(Fr.b)(this,void 0,void 0,function(){var e,n;return Object(Fr.d)(this,function(r){switch(r.label){case 0:e=0,n=t.Mr,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function eh(t,e){var n=Jr(t);n.$r.has(e.targetId)||(n.$r.set(e.targetId,e),sh(n)?oh(n):Th(n).er()&&rh(n,e))}function nh(t,e){var n=Jr(t),r=Th(n);n.$r.delete(e),r.er()&&ih(n,e),0===n.$r.size&&(r.er()?r.ir():ah(n)&&n.Br.set("Unknown"))}function rh(t,e){t.qr.U(e.targetId),Th(t).mr(e)}function ih(t,e){t.qr.U(e),Th(t).yr(e)}function oh(t){t.qr=new xs({getRemoteKeysForTarget:function(e){return t.remoteSyncer.getRemoteKeysForTarget(e)},lt:function(e){return t.$r.get(e)||null}}),Th(t).start(),t.Br.Sr()}function sh(t){return ah(t)&&!Th(t).tr()&&t.$r.size>0}function ah(t){return 0===Jr(t).Or.size}function uh(t){t.qr=void 0}function ch(t){return Object(Fr.b)(this,void 0,void 0,function(){return Object(Fr.d)(this,function(e){return t.$r.forEach(function(e,n){rh(t,e)}),[2]})})}function hh(t,e){return Object(Fr.b)(this,void 0,void 0,function(){return Object(Fr.d)(this,function(n){return uh(t),sh(t)?(t.Br.Nr(e),oh(t)):t.Br.set("Unknown"),[2]})})}function lh(t,e,n){return Object(Fr.b)(this,void 0,void 0,function(){var r,i,o;return Object(Fr.d)(this,function(s){switch(s.label){case 0:if(t.Br.set("Online"),!(e instanceof As&&2===e.state&&e.cause))return[3,6];s.label=1;case 1:return s.trys.push([1,3,,5]),[4,function(t,e){return Object(Fr.b)(this,void 0,void 0,function(){var n,r,i,o;return Object(Fr.d)(this,function(s){switch(s.label){case 0:n=e.cause,r=0,i=e.targetIds,s.label=1;case 1:return r<i.length?t.$r.has(o=i[r])?[4,t.remoteSyncer.rejectListen(o,n)]:[3,3]:[3,5];case 2:s.sent(),t.$r.delete(o),t.qr.removeTarget(o),s.label=3;case 3:s.label=4;case 4:return r++,[3,1];case 5:return[2]}})})}(t,e)];case 2:return s.sent(),[3,5];case 3:return r=s.sent(),Qr("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),[4,fh(t,r)];case 4:return s.sent(),[3,5];case 5:return[3,13];case 6:if(e instanceof Ds?t.qr.X(e):e instanceof Ns?t.qr.rt(e):t.qr.et(e),n.isEqual(oi.min()))return[3,13];s.label=7;case 7:return s.trys.push([7,11,,13]),[4,oc(t.localStore)];case 8:return i=s.sent(),n.compareTo(i)>=0?[4,function(t,e){var n=t.qr.ut(e);return n.targetChanges.forEach(function(n,r){if(n.resumeToken.approximateByteSize()>0){var i=t.$r.get(r);i&&t.$r.set(r,i.withResumeToken(n.resumeToken,e))}}),n.targetMismatches.forEach(function(e){var n=t.$r.get(e);if(n){t.$r.set(e,n.withResumeToken(pi.EMPTY_BYTE_STRING,n.snapshotVersion)),ih(t,e);var r=new $a(n.target,e,1,n.sequenceNumber);rh(t,r)}}),t.remoteSyncer.applyRemoteEvent(n)}(t,n)]:[3,10];case 9:s.sent(),s.label=10;case 10:return[3,13];case 11:return Qr("RemoteStore","Failed to raise snapshot:",o=s.sent()),[4,fh(t,o)];case 12:return s.sent(),[3,13];case 13:return[2]}})})}function fh(t,e,n){return Object(Fr.b)(this,void 0,void 0,function(){var r=this;return Object(Fr.d)(this,function(i){switch(i.label){case 0:if(!Ba(e))throw e;return t.Or.add(1),[4,th(t)];case 1:return i.sent(),t.Br.set("Offline"),n||(n=function(){return oc(t.localStore)}),t.asyncQueue.enqueueRetryable(function(){return Object(Fr.b)(r,void 0,void 0,function(){return Object(Fr.d)(this,function(e){switch(e.label){case 0:return Qr("RemoteStore","Retrying IndexedDB access"),[4,n()];case 1:return e.sent(),t.Or.delete(1),[4,Zc(t)];case 2:return e.sent(),[2]}})})}),[2]}})})}function dh(t,e){return e().catch(function(n){return fh(t,n,e)})}function ph(t){return Object(Fr.b)(this,void 0,void 0,function(){var e,n,r,i,o;return Object(Fr.d)(this,function(s){switch(s.label){case 0:e=Jr(t),n=Eh(e),r=e.kr.length>0?e.kr[e.kr.length-1].batchId:-1,s.label=1;case 1:if(!function(t){return ah(t)&&t.kr.length<10}(e))return[3,7];s.label=2;case 2:return s.trys.push([2,4,,6]),[4,uc(e.localStore,r)];case 3:return null===(i=s.sent())?(0===e.kr.length&&n.ir(),[3,7]):(r=i.batchId,function(t,e){t.kr.push(e);var n=Eh(t);n.er()&&n.pr&&n.Er(e.mutations)}(e,i),[3,6]);case 4:return o=s.sent(),[4,fh(e,o)];case 5:return s.sent(),[3,6];case 6:return[3,1];case 7:return yh(e)&&vh(e),[2]}})})}function yh(t){return ah(t)&&!Eh(t).tr()&&t.kr.length>0}function vh(t){Eh(t).start()}function mh(t){return Object(Fr.b)(this,void 0,void 0,function(){return Object(Fr.d)(this,function(e){return Eh(t).Ar(),[2]})})}function gh(t){return Object(Fr.b)(this,void 0,void 0,function(){var e,n,r;return Object(Fr.d)(this,function(i){for(e=Eh(t),n=0,r=t.kr;n<r.length;n++)e.Er(r[n].mutations);return[2]})})}function bh(t,e,n){return Object(Fr.b)(this,void 0,void 0,function(){var r,i;return Object(Fr.d)(this,function(o){switch(o.label){case 0:return r=t.kr.shift(),i=Xa.from(r,e,n),[4,dh(t,function(){return t.remoteSyncer.applySuccessfulWrite(i)})];case 1:return o.sent(),[4,ph(t)];case 2:return o.sent(),[2]}})})}function wh(t,e){return Object(Fr.b)(this,void 0,void 0,function(){return Object(Fr.d)(this,function(n){switch(n.label){case 0:return e&&Eh(t).pr?[4,function(t,e){return Object(Fr.b)(this,void 0,void 0,function(){var n,r;return Object(Fr.d)(this,function(i){switch(i.label){case 0:return us(r=e.code)&&r!==Br.ABORTED?(n=t.kr.shift(),Eh(t).sr(),[4,dh(t,function(){return t.remoteSyncer.rejectFailedWrite(n.batchId,e)})]):[3,3];case 1:return i.sent(),[4,ph(t)];case 2:i.sent(),i.label=3;case 3:return[2]}})})}(t,e)]:[3,2];case 1:n.sent(),n.label=2;case 2:return yh(t)&&vh(t),[2]}})})}function Ih(t,e){return Object(Fr.b)(this,void 0,void 0,function(){var n;return Object(Fr.d)(this,function(r){switch(r.label){case 0:return n=Jr(t),e?(n.Or.delete(2),[4,Zc(n)]):[3,2];case 1:return r.sent(),[3,5];case 2:return e?[3,4]:(n.Or.add(2),[4,th(n)]);case 3:r.sent(),n.Br.set("Unknown"),r.label=4;case 4:r.label=5;case 5:return[2]}})})}function Th(t){var e=this;return t.Ur||(t.Ur=function(t,e,n){var r=Jr(t);return r.br(),new Wc(e,r.Hi,r.credentials,r.R,n)}(t.datastore,t.asyncQueue,{Ii:ch.bind(null,t),Ri:hh.bind(null,t),_r:lh.bind(null,t)}),t.Mr.push(function(n){return Object(Fr.b)(e,void 0,void 0,function(){return Object(Fr.d)(this,function(e){switch(e.label){case 0:return n?(t.Ur.sr(),sh(t)?oh(t):t.Br.set("Unknown"),[3,3]):[3,1];case 1:return[4,t.Ur.stop()];case 2:e.sent(),uh(t),e.label=3;case 3:return[2]}})})})),t.Ur}function Eh(t){var e=this;return t.Qr||(t.Qr=function(t,e,n){var r=Jr(t);return r.br(),new Yc(e,r.Hi,r.credentials,r.R,n)}(t.datastore,t.asyncQueue,{Ii:mh.bind(null,t),Ri:wh.bind(null,t),Ir:gh.bind(null,t),Tr:bh.bind(null,t)}),t.Mr.push(function(n){return Object(Fr.b)(e,void 0,void 0,function(){return Object(Fr.d)(this,function(e){switch(e.label){case 0:return n?(t.Qr.sr(),[4,ph(t)]):[3,2];case 1:return e.sent(),[3,4];case 2:return[4,t.Qr.stop()];case 3:e.sent(),t.kr.length>0&&(Qr("RemoteStore","Stopping write stream with "+t.kr.length+" pending writes"),t.kr=[]),e.label=4;case 4:return[2]}})})})),t.Qr}var _h=function(){function t(t,e,n,r,i){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new La,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(function(t){})}return t.createAndSchedule=function(e,n,r,i,o){var s=new t(e,n,Date.now()+r,i,o);return s.start(r),s},t.prototype.start=function(t){var e=this;this.timerHandle=setTimeout(function(){return e.handleDelayElapsed()},t)},t.prototype.skipDelay=function(){return this.handleDelayElapsed()},t.prototype.cancel=function(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Kr(Br.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},t.prototype.handleDelayElapsed=function(){var t=this;this.asyncQueue.enqueueAndForget(function(){return null!==t.timerHandle?(t.clearTimeout(),t.op().then(function(e){return t.deferred.resolve(e)})):Promise.resolve()})},t.prototype.clearTimeout=function(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)},t}();function Oh(t,e){if(Hr("AsyncQueue",e+": "+t),Ba(t))return new Kr(Br.UNAVAILABLE,e+": "+t);throw t}var Sh=function(){function t(t){this.comparator=t?function(e,n){return t(e,n)||Oi.comparator(e.key,n.key)}:function(t,e){return Oi.comparator(t.key,e.key)},this.keyedMap=gs(),this.sortedSet=new hs(this.comparator)}return t.emptySet=function(e){return new t(e.comparator)},t.prototype.has=function(t){return null!=this.keyedMap.get(t)},t.prototype.get=function(t){return this.keyedMap.get(t)},t.prototype.first=function(){return this.sortedSet.minKey()},t.prototype.last=function(){return this.sortedSet.maxKey()},t.prototype.isEmpty=function(){return this.sortedSet.isEmpty()},t.prototype.indexOf=function(t){var e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1},Object.defineProperty(t.prototype,"size",{get:function(){return this.sortedSet.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t){this.sortedSet.inorderTraversal(function(e,n){return t(e),!1})},t.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))},t.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(!i.isEqual(o))return!1}return!0},t.prototype.toString=function(){var t=[];return this.forEach(function(e){t.push(e.toString())}),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"},t.prototype.copy=function(e,n){var r=new t;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r},t}(),Dh=function(){function t(){this.Kr=new hs(Oi.comparator)}return t.prototype.track=function(t){var e=t.doc.key,n=this.Kr.get(e);n?0!==t.type&&3===n.type?this.Kr=this.Kr.insert(e,t):3===t.type&&1!==n.type?this.Kr=this.Kr.insert(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Kr=this.Kr.insert(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Kr=this.Kr.insert(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Kr=this.Kr.remove(e):1===t.type&&2===n.type?this.Kr=this.Kr.insert(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Kr=this.Kr.insert(e,{type:2,doc:t.doc}):Xr():this.Kr=this.Kr.insert(e,t)},t.prototype.jr=function(){var t=[];return this.Kr.inorderTraversal(function(e,n){t.push(n)}),t},t}(),Nh=function(){function t(t,e,n,r,i,o,s,a){this.query=t,this.docs=e,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=s,this.excludesMetadataChanges=a}return t.fromInitialDocuments=function(e,n,r,i){var o=[];return n.forEach(function(t){o.push({type:0,doc:t})}),new t(e,n,Sh.emptySet(n),o,r,i,!0,!1)},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return!this.mutatedKeys.isEmpty()},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&Io(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},t}(),Ah=function(){this.Wr=void 0,this.listeners=[]},kh=function(){this.queries=new Vu(function(t){return To(t)},Io),this.onlineState="Unknown",this.Gr=new Set};function xh(t,e){return Object(Fr.b)(this,void 0,void 0,function(){var n,r,i,o,s,a,u;return Object(Fr.d)(this,function(c){switch(c.label){case 0:if(n=Jr(t),i=!1,(o=n.queries.get(r=e.query))||(i=!0,o=new Ah),!i)return[3,4];c.label=1;case 1:return c.trys.push([1,3,,4]),s=o,[4,n.onListen(r)];case 2:return s.Wr=c.sent(),[3,4];case 3:return a=c.sent(),u=Oh(a,"Initialization of query '"+Eo(e.query)+"' failed"),[2,void e.onError(u)];case 4:return n.queries.set(r,o),o.listeners.push(e),e.zr(n.onlineState),o.Wr&&e.Hr(o.Wr)&&Ph(n),[2]}})})}function Ch(t,e){return Object(Fr.b)(this,void 0,void 0,function(){var n,r,i,o,s;return Object(Fr.d)(this,function(a){return n=Jr(t),i=!1,(o=n.queries.get(r=e.query))&&(s=o.listeners.indexOf(e))>=0&&(o.listeners.splice(s,1),i=0===o.listeners.length),i?[2,(n.queries.delete(r),n.onUnlisten(r))]:[2]})})}function jh(t,e){for(var n=Jr(t),r=!1,i=0,o=e;i<o.length;i++){var s=o[i],a=n.queries.get(s.query);if(a){for(var u=0,c=a.listeners;u<c.length;u++)c[u].Hr(s)&&(r=!0);a.Wr=s}}r&&Ph(n)}function Rh(t,e,n){var r=Jr(t),i=r.queries.get(e);if(i)for(var o=0,s=i.listeners;o<s.length;o++)s[o].onError(n);r.queries.delete(e)}function Ph(t){t.Gr.forEach(function(t){t.next()})}var Lh=function(){function t(t,e,n){this.query=t,this.Jr=e,this.Yr=!1,this.Xr=null,this.onlineState="Unknown",this.options=n||{}}return t.prototype.Hr=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new Nh(t.query,t.docs,t.oldDocs,e,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0)}var o=!1;return this.Yr?this.Zr(t)&&(this.Jr.next(t),o=!0):this.eo(t,this.onlineState)&&(this.no(t),o=!0),this.Xr=t,o},t.prototype.onError=function(t){this.Jr.error(t)},t.prototype.zr=function(t){this.onlineState=t;var e=!1;return this.Xr&&!this.Yr&&this.eo(this.Xr,t)&&(this.no(this.Xr),e=!0),e},t.prototype.eo=function(t,e){return!t.fromCache||!(this.options.so&&"Offline"!==e||t.docs.isEmpty()&&"Offline"!==e)},t.prototype.Zr=function(t){return t.docChanges.length>0||!!(t.syncStateChanged||this.Xr&&this.Xr.hasPendingWrites!==t.hasPendingWrites)&&!0===this.options.includeMetadataChanges},t.prototype.no=function(t){t=Nh.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache),this.Yr=!0,this.Jr.next(t)},t}(),Vh=function(){function t(t,e){this.payload=t,this.byteLength=e}return t.prototype.io=function(){return"metadata"in this.payload},t}(),Uh=function(){function t(t){this.R=t}return t.prototype.qn=function(t){return Gs(this.R,t)},t.prototype.Un=function(t){return t.metadata.exists?Xs(this.R,t.document,!1):Bi.newNoDocument(this.qn(t.metadata.name),this.Qn(t.metadata.readTime))},t.prototype.Qn=function(t){return Fs(t)},t}();!function(){function t(t,e,n){this.ro=t,this.localStore=e,this.R=n,this.queries=[],this.documents=[],this.progress=function(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}(t)}t.prototype.oo=function(t){this.progress.bytesLoaded+=t.byteLength;var e=this.progress.documentsLoaded;return t.payload.namedQuery?this.queries.push(t.payload.namedQuery):t.payload.documentMetadata?(this.documents.push({metadata:t.payload.documentMetadata}),t.payload.documentMetadata.exists||++e):t.payload.document&&(this.documents[this.documents.length-1].document=t.payload.document,++e),e!==this.progress.documentsLoaded?(this.progress.documentsLoaded=e,Object.assign({},this.progress)):null},t.prototype.co=function(t){for(var e=new Map,n=new Uh(this.R),r=0,i=t;r<i.length;r++){var o=i[r];if(o.metadata.queries)for(var s=n.qn(o.metadata.name),a=0,u=o.metadata.queries;a<u.length;a++){var c=u[a],h=(e.get(c)||Ts()).add(s);e.set(c,h)}}return e},t.prototype.complete=function(){return Object(Fr.b)(this,void 0,void 0,function(){var t,e,n,r,i;return Object(Fr.d)(this,function(o){switch(o.label){case 0:return[4,yc(this.localStore,new Uh(this.R),this.documents,this.ro.id)];case 1:t=o.sent(),e=this.co(this.documents),n=0,r=this.queries,o.label=2;case 2:return n<r.length?[4,vc(this.localStore,i=r[n],e.get(i.name))]:[3,5];case 3:o.sent(),o.label=4;case 4:return n++,[3,2];case 5:return[2,(this.progress.taskState="Success",new $u(Object.assign({},this.progress),t))]}})})}}();var Mh=function(t){this.key=t},Fh=function(t){this.key=t},qh=function(){function t(t,e){this.query=t,this.uo=e,this.ao=null,this.current=!1,this.ho=Ts(),this.mutatedKeys=Ts(),this.lo=Oo(t),this.fo=new Sh(this.lo)}return Object.defineProperty(t.prototype,"wo",{get:function(){return this.uo},enumerable:!1,configurable:!0}),t.prototype._o=function(t,e){var n=this,r=e?e.mo:new Dh,i=e?e.fo:this.fo,o=e?e.mutatedKeys:this.mutatedKeys,s=i,a=!1,u=fo(this.query)&&i.size===this.query.limit?i.last():null,c=po(this.query)&&i.size===this.query.limit?i.first():null;if(t.inorderTraversal(function(t,e){var h=i.get(t),l=_o(n.query,e)?e:null,f=!!h&&n.mutatedKeys.has(h.key),d=!!l&&(l.hasLocalMutations||n.mutatedKeys.has(l.key)&&l.hasCommittedMutations),p=!1;h&&l?h.data.isEqual(l.data)?f!==d&&(r.track({type:3,doc:l}),p=!0):n.yo(h,l)||(r.track({type:2,doc:l}),p=!0,(u&&n.lo(l,u)>0||c&&n.lo(l,c)<0)&&(a=!0)):!h&&l?(r.track({type:0,doc:l}),p=!0):h&&!l&&(r.track({type:1,doc:h}),p=!0,(u||c)&&(a=!0)),p&&(l?(s=s.add(l),o=d?o.add(t):o.delete(t)):(s=s.delete(t),o=o.delete(t)))}),fo(this.query)||po(this.query))for(;s.size>this.query.limit;){var h=fo(this.query)?s.last():s.first();s=s.delete(h.key),o=o.delete(h.key),r.track({type:1,doc:h})}return{fo:s,mo:r,Nn:a,mutatedKeys:o}},t.prototype.yo=function(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations},t.prototype.applyChanges=function(t,e,n){var r=this,i=this.fo;this.fo=t.fo,this.mutatedKeys=t.mutatedKeys;var o=t.mo.jr();o.sort(function(t,e){return function(t,e){var n=function(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Xr()}};return n(t)-n(e)}(t.type,e.type)||r.lo(t.doc,e.doc)}),this.po(n);var s=e?this.Eo():[],a=0===this.ho.size&&this.current?1:0,u=a!==this.ao;return this.ao=a,0!==o.length||u?{snapshot:new Nh(this.query,t.fo,i,o,t.mutatedKeys,0===a,u,!1),To:s}:{To:s}},t.prototype.zr=function(t){return this.current&&"Offline"===t?(this.current=!1,this.applyChanges({fo:this.fo,mo:new Dh,mutatedKeys:this.mutatedKeys,Nn:!1},!1)):{To:[]}},t.prototype.Io=function(t){return!this.uo.has(t)&&!!this.fo.has(t)&&!this.fo.get(t).hasLocalMutations},t.prototype.po=function(t){var e=this;t&&(t.addedDocuments.forEach(function(t){return e.uo=e.uo.add(t)}),t.modifiedDocuments.forEach(function(t){}),t.removedDocuments.forEach(function(t){return e.uo=e.uo.delete(t)}),this.current=t.current)},t.prototype.Eo=function(){var t=this;if(!this.current)return[];var e=this.ho;this.ho=Ts(),this.fo.forEach(function(e){t.Io(e.key)&&(t.ho=t.ho.add(e.key))});var n=[];return e.forEach(function(e){t.ho.has(e)||n.push(new Fh(e))}),this.ho.forEach(function(t){e.has(t)||n.push(new Mh(t))}),n},t.prototype.Ao=function(t){this.uo=t.Bn,this.ho=Ts();var e=this._o(t.documents);return this.applyChanges(e,!0)},t.prototype.Ro=function(){return Nh.fromInitialDocuments(this.query,this.fo,this.mutatedKeys,0===this.ao)},t}(),Bh=function(t,e,n){this.query=t,this.targetId=e,this.view=n},Kh=function(t){this.key=t,this.bo=!1},Gh=function(){function t(t,e,n,r,i,o){this.localStore=t,this.remoteStore=e,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.vo={},this.Po=new Vu(function(t){return To(t)},Io),this.Vo=new Map,this.So=new Set,this.Do=new hs(Oi.comparator),this.Co=new Map,this.No=new gc,this.xo={},this.Fo=new Map,this.ko=Ou.Yt(),this.onlineState="Unknown",this.$o=void 0}return Object.defineProperty(t.prototype,"isPrimaryClient",{get:function(){return!0===this.$o},enumerable:!1,configurable:!0}),t}();function zh(t,e){return Object(Fr.b)(this,void 0,void 0,function(){var n,r,i,o,s;return Object(Fr.d)(this,function(a){switch(a.label){case 0:return n=wl(t),(i=n.Po.get(e))?(n.sharedClientState.addLocalQueryTarget(i.targetId),r=i.view.Ro(),[3,4]):[3,1];case 1:return[4,cc(n.localStore,bo(e))];case 2:return o=a.sent(),s=n.sharedClientState.addLocalQueryTarget(o.targetId),[4,Qh(n,e,o.targetId,"current"===s)];case 3:r=a.sent(),n.isPrimaryClient&&eh(n.remoteStore,o),a.label=4;case 4:return[2,r]}})})}function Qh(t,e,n,r){return Object(Fr.b)(this,void 0,void 0,function(){var i,o,s,a,u,c;return Object(Fr.d)(this,function(h){switch(h.label){case 0:return t.Oo=function(e,n,r){return function(t,e,n,r){return Object(Fr.b)(this,void 0,void 0,function(){var i,o,s;return Object(Fr.d)(this,function(a){switch(a.label){case 0:return(i=e.view._o(n)).Nn?[4,lc(t.localStore,e.query,!1).then(function(t){return e.view._o(t.documents,i)})]:[3,2];case 1:i=a.sent(),a.label=2;case 2:return o=r&&r.targetChanges.get(e.targetId),s=e.view.applyChanges(i,t.isPrimaryClient,o),[2,(ol(t,e.targetId,s.To),s.snapshot)]}})})}(t,e,n,r)},[4,lc(t.localStore,e,!0)];case 1:return i=h.sent(),o=new qh(e,i.Bn),s=o._o(i.documents),a=Ss.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==t.onlineState),u=o.applyChanges(s,t.isPrimaryClient,a),ol(t,n,u.To),c=new Bh(e,n,o),[2,(t.Po.set(e,c),t.Vo.has(n)?t.Vo.get(n).push(e):t.Vo.set(n,[e]),u.snapshot)]}})})}function Hh(t,e){return Object(Fr.b)(this,void 0,void 0,function(){var n,r,i;return Object(Fr.d)(this,function(o){switch(o.label){case 0:return n=Jr(t),r=n.Po.get(e),(i=n.Vo.get(r.targetId)).length>1?[2,(n.Vo.set(r.targetId,i.filter(function(t){return!Io(t,e)})),void n.Po.delete(e))]:n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)?[3,2]:[4,hc(n.localStore,r.targetId,!1).then(function(){n.sharedClientState.clearQueryState(r.targetId),nh(n.remoteStore,r.targetId),rl(n,r.targetId)}).catch(ku)]):[3,3];case 1:o.sent(),o.label=2;case 2:return[3,5];case 3:return rl(n,r.targetId),[4,hc(n.localStore,r.targetId,!0)];case 4:o.sent(),o.label=5;case 5:return[2]}})})}function Wh(t,e,n){return Object(Fr.b)(this,void 0,void 0,function(){var r,i,o,s;return Object(Fr.d)(this,function(a){switch(a.label){case 0:r=Il(t),a.label=1;case 1:return a.trys.push([1,5,,6]),[4,function(t,e){var n,r=Jr(t),i=ii.now(),o=e.reduce(function(t,e){return t.add(e.key)},Ts());return r.persistence.runTransaction("Locally write mutations","readwrite",function(t){return r.Mn.pn(t,o).next(function(o){n=o;for(var s=[],a=0,u=e;a<u.length;a++){var c=u[a],h=Yo(c,n.get(c.key));null!=h&&s.push(new Zo(c.key,h,qi(h.value.mapValue),Go.exists(!0)))}return r._n.addMutationBatch(t,i,s,e)})}).then(function(t){return t.applyToLocalDocumentSet(n),{batchId:t.batchId,changes:n}})}(r.localStore,e)];case 2:return i=a.sent(),r.sharedClientState.addPendingMutation(i.batchId),function(t,e,n){var r=t.xo[t.currentUser.toKey()];r||(r=new hs(ei)),r=r.insert(e,n),t.xo[t.currentUser.toKey()]=r}(r,i.batchId,n),[4,ul(r,i.changes)];case 3:return a.sent(),[4,ph(r.remoteStore)];case 4:return a.sent(),[3,6];case 5:return o=a.sent(),s=Oh(o,"Failed to persist write"),n.reject(s),[3,6];case 6:return[2]}})})}function Yh(t,e){return Object(Fr.b)(this,void 0,void 0,function(){var n,r;return Object(Fr.d)(this,function(i){switch(i.label){case 0:n=Jr(t),i.label=1;case 1:return i.trys.push([1,4,,6]),[4,sc(n.localStore,e)];case 2:return r=i.sent(),e.targetChanges.forEach(function(t,e){var r=n.Co.get(e);r&&($r(t.addedDocuments.size+t.modifiedDocuments.size+t.removedDocuments.size<=1),t.addedDocuments.size>0?r.bo=!0:t.modifiedDocuments.size>0?$r(r.bo):t.removedDocuments.size>0&&($r(r.bo),r.bo=!1))}),[4,ul(n,r,e)];case 3:return i.sent(),[3,6];case 4:return[4,ku(i.sent())];case 5:return i.sent(),[3,6];case 6:return[2]}})})}function Xh(t,e,n){var r=Jr(t);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){var i=[];r.Po.forEach(function(t,n){var r=n.view.zr(e);r.snapshot&&i.push(r.snapshot)}),function(t,e){var n=Jr(t);n.onlineState=e;var r=!1;n.queries.forEach(function(t,n){for(var i=0,o=n.listeners;i<o.length;i++)o[i].zr(e)&&(r=!0)}),r&&Ph(n)}(r.eventManager,e),i.length&&r.vo._r(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function $h(t,e,n){return Object(Fr.b)(this,void 0,void 0,function(){var r,i,o,s,a,u;return Object(Fr.d)(this,function(c){switch(c.label){case 0:return(r=Jr(t)).sharedClientState.updateQueryState(e,"rejected",n),i=r.Co.get(e),(o=i&&i.key)?(s=(s=new hs(Oi.comparator)).insert(o,Bi.newNoDocument(o,oi.min())),a=Ts().add(o),u=new Os(oi.min(),new Map,new ds(ei),s,a),[4,Yh(r,u)]):[3,2];case 1:return c.sent(),r.Do=r.Do.remove(o),r.Co.delete(e),al(r),[3,4];case 2:return[4,hc(r.localStore,e,!1).then(function(){return rl(r,e,n)}).catch(ku)];case 3:c.sent(),c.label=4;case 4:return[2]}})})}function Jh(t,e){return Object(Fr.b)(this,void 0,void 0,function(){var n,r,i;return Object(Fr.d)(this,function(o){switch(o.label){case 0:n=Jr(t),r=e.batch.batchId,o.label=1;case 1:return o.trys.push([1,4,,6]),[4,ic(n.localStore,e)];case 2:return i=o.sent(),nl(n,r,null),el(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),[4,ul(n,i)];case 3:return o.sent(),[3,6];case 4:return[4,ku(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}})})}function Zh(t,e,n){return Object(Fr.b)(this,void 0,void 0,function(){var r,i;return Object(Fr.d)(this,function(o){switch(o.label){case 0:r=Jr(t),o.label=1;case 1:return o.trys.push([1,4,,6]),[4,function(t,e){var n=Jr(t);return n.persistence.runTransaction("Reject batch","readwrite-primary",function(t){var r;return n._n.lookupMutationBatch(t,e).next(function(e){return $r(null!==e),r=e.keys(),n._n.removeMutationBatch(t,e)}).next(function(){return n._n.performConsistencyCheck(t)}).next(function(){return n.Mn.pn(t,r)})})}(r.localStore,e)];case 2:return i=o.sent(),nl(r,e,n),el(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),[4,ul(r,i)];case 3:return o.sent(),[3,6];case 4:return[4,ku(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}})})}function tl(t,e){return Object(Fr.b)(this,void 0,void 0,function(){var n,r,i,o,s;return Object(Fr.d)(this,function(a){switch(a.label){case 0:ah((n=Jr(t)).remoteStore)||Qr("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,function(t){var e=Jr(t);return e.persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e._n.getHighestUnacknowledgedBatchId(t)})}(n.localStore)];case 2:return-1===(r=a.sent())?[2,void e.resolve()]:((i=n.Fo.get(r)||[]).push(e),n.Fo.set(r,i),[3,4]);case 3:return o=a.sent(),s=Oh(o,"Initialization of waitForPendingWrites() operation failed"),e.reject(s),[3,4];case 4:return[2]}})})}function el(t,e){(t.Fo.get(e)||[]).forEach(function(t){t.resolve()}),t.Fo.delete(e)}function nl(t,e,n){var r=Jr(t),i=r.xo[r.currentUser.toKey()];if(i){var o=i.get(e);o&&(n?o.reject(n):o.resolve(),i=i.remove(e)),r.xo[r.currentUser.toKey()]=i}}function rl(t,e,n){void 0===n&&(n=null),t.sharedClientState.removeLocalQueryTarget(e);for(var r=0,i=t.Vo.get(e);r<i.length;r++){var o=i[r];t.Po.delete(o),n&&t.vo.Mo(o,n)}t.Vo.delete(e),t.isPrimaryClient&&t.No.Zn(e).forEach(function(e){t.No.containsKey(e)||il(t,e)})}function il(t,e){t.So.delete(e.path.canonicalString());var n=t.Do.get(e);null!==n&&(nh(t.remoteStore,n),t.Do=t.Do.remove(e),t.Co.delete(n),al(t))}function ol(t,e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof Mh?(t.No.addReference(o.key,e),sl(t,o)):o instanceof Fh?(Qr("SyncEngine","Document no longer in limbo: "+o.key),t.No.removeReference(o.key,e),t.No.containsKey(o.key)||il(t,o.key)):Xr()}}function sl(t,e){var n=e.key,r=n.path.canonicalString();t.Do.get(n)||t.So.has(r)||(Qr("SyncEngine","New document in limbo: "+n),t.So.add(r),al(t))}function al(t){for(;t.So.size>0&&t.Do.size<t.maxConcurrentLimboResolutions;){var e=t.So.values().next().value;t.So.delete(e);var n=new Oi(hi.fromString(e)),r=t.ko.next();t.Co.set(r,new Kh(n)),t.Do=t.Do.insert(n,r),eh(t.remoteStore,new $a(bo(lo(n.path)),r,2,qr.o))}}function ul(t,e,n){return Object(Fr.b)(this,void 0,void 0,function(){var r,i,o,s;return Object(Fr.d)(this,function(a){switch(a.label){case 0:return r=Jr(t),i=[],o=[],s=[],r.Po.isEmpty()?[3,3]:(r.Po.forEach(function(t,a){s.push(r.Oo(a,e,n).then(function(t){if(t){r.isPrimaryClient&&r.sharedClientState.updateQueryState(a.targetId,t.fromCache?"not-current":"current"),i.push(t);var e=Zu.Pn(a.targetId,t);o.push(e)}}))}),[4,Promise.all(s)]);case 1:return a.sent(),r.vo._r(i),[4,function(t,e){return Object(Fr.b)(this,void 0,void 0,function(){var n,r,i,o,s,a,u,c;return Object(Fr.d)(this,function(h){switch(h.label){case 0:n=Jr(t),h.label=1;case 1:return h.trys.push([1,3,,4]),[4,n.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(t){return Va.forEach(e,function(e){return Va.forEach(e.bn,function(r){return n.persistence.referenceDelegate.addReference(t,e.targetId,r)}).next(function(){return Va.forEach(e.vn,function(r){return n.persistence.referenceDelegate.removeReference(t,e.targetId,r)})})})})];case 2:return h.sent(),[3,4];case 3:if(!Ba(r=h.sent()))throw r;return Qr("LocalStore","Failed to update sequence numbers: "+r),[3,4];case 4:for(i=0,o=e;i<o.length;i++)a=(s=o[i]).targetId,s.fromCache||(u=n.Fn.get(a),c=u.withLastLimboFreeSnapshotVersion(u.snapshotVersion),n.Fn=n.Fn.insert(a,c));return[2]}})})}(r.localStore,o)];case 2:a.sent(),a.label=3;case 3:return[2]}})})}function cl(t,e){return Object(Fr.b)(this,void 0,void 0,function(){var n,r;return Object(Fr.d)(this,function(i){switch(i.label){case 0:return(n=Jr(t)).currentUser.isEqual(e)?[3,3]:(Qr("SyncEngine","User change. New user:",e.toKey()),[4,rc(n.localStore,e)]);case 1:return r=i.sent(),n.currentUser=e,function(t,e){t.Fo.forEach(function(t){t.forEach(function(t){t.reject(new Kr(Br.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),t.Fo.clear()}(n),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),[4,ul(n,r.Ln)];case 2:i.sent(),i.label=3;case 3:return[2]}})})}function hl(t,e){var n=Jr(t),r=n.Co.get(e);if(r&&r.bo)return Ts().add(r.key);var i=Ts(),o=n.Vo.get(e);if(!o)return i;for(var s=0,a=o;s<a.length;s++){var u=n.Po.get(a[s]);i=i.unionWith(u.view.wo)}return i}function ll(t,e){return Object(Fr.b)(this,void 0,void 0,function(){var n,r,i;return Object(Fr.d)(this,function(o){switch(o.label){case 0:return[4,lc((n=Jr(t)).localStore,e.query,!0)];case 1:return r=o.sent(),i=e.view.Ao(r),[2,(n.isPrimaryClient&&ol(n,e.targetId,i.To),i)]}})})}function fl(t){return Object(Fr.b)(this,void 0,void 0,function(){var e;return Object(Fr.d)(this,function(n){return[2,dc((e=Jr(t)).localStore).then(function(t){return ul(e,t)})]})})}function dl(t,e,n,r){return Object(Fr.b)(this,void 0,void 0,function(){var i,o;return Object(Fr.d)(this,function(s){switch(s.label){case 0:return[4,function(t,e){var n=Jr(t),r=Jr(n._n);return n.persistence.runTransaction("Lookup mutation documents","readonly",function(t){return r.jt(t,e).next(function(e){return e?n.Mn.pn(t,e):Va.resolve(null)})})}((i=Jr(t)).localStore,e)];case 1:return null===(o=s.sent())?[3,6]:"pending"!==n?[3,3]:[4,ph(i.remoteStore)];case 2:return s.sent(),[3,4];case 3:"acknowledged"===n||"rejected"===n?(nl(i,e,r||null),el(i,e),function(t,e){Jr(Jr(t)._n).Gt(e)}(i.localStore,e)):Xr(),s.label=4;case 4:return[4,ul(i,o)];case 5:return s.sent(),[3,7];case 6:Qr("SyncEngine","Cannot apply mutation batch with id: "+e),s.label=7;case 7:return[2]}})})}function pl(t,e){return Object(Fr.b)(this,void 0,void 0,function(){var n,r,i,o,s,a,u;return Object(Fr.d)(this,function(c){switch(c.label){case 0:return wl(n=Jr(t)),Il(n),!0!==e||!0===n.$o?[3,3]:(r=n.sharedClientState.getAllActiveQueryTargets(),[4,yl(n,r.toArray())]);case 1:return i=c.sent(),n.$o=!0,[4,Ih(n.remoteStore,!0)];case 2:for(c.sent(),o=0,s=i;o<s.length;o++)eh(n.remoteStore,s[o]);return[3,7];case 3:return!1!==e||!1===n.$o?[3,7]:(a=[],u=Promise.resolve(),n.Vo.forEach(function(t,e){n.sharedClientState.isLocalQueryTarget(e)?a.push(e):u=u.then(function(){return rl(n,e),hc(n.localStore,e,!0)}),nh(n.remoteStore,e)}),[4,u]);case 4:return c.sent(),[4,yl(n,a)];case 5:return c.sent(),function(t){var e=Jr(t);e.Co.forEach(function(t,n){nh(e.remoteStore,n)}),e.No.ts(),e.Co=new Map,e.Do=new hs(Oi.comparator)}(n),n.$o=!1,[4,Ih(n.remoteStore,!1)];case 6:c.sent(),c.label=7;case 7:return[2]}})})}function yl(t,e,n){return Object(Fr.b)(this,void 0,void 0,function(){var n,r,i,o,s,a,u,c,h,l,f,d,p;return Object(Fr.d)(this,function(y){switch(y.label){case 0:n=Jr(t),r=[],i=[],o=0,s=e,y.label=1;case 1:return o<s.length?(u=void 0,(c=n.Vo.get(a=s[o]))&&0!==c.length?[4,cc(n.localStore,bo(c[0]))]:[3,7]):[3,13];case 2:u=y.sent(),h=0,l=c,y.label=3;case 3:return h<l.length?(f=n.Po.get(l[h]),[4,ll(n,f)]):[3,6];case 4:(d=y.sent()).snapshot&&i.push(d.snapshot),y.label=5;case 5:return h++,[3,3];case 6:return[3,11];case 7:return[4,fc(n.localStore,a)];case 8:return p=y.sent(),[4,cc(n.localStore,p)];case 9:return u=y.sent(),[4,Qh(n,vl(p),a,!1)];case 10:y.sent(),y.label=11;case 11:r.push(u),y.label=12;case 12:return o++,[3,1];case 13:return[2,(n.vo._r(i),r)]}})})}function vl(t){return ho(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function ml(t){var e=Jr(t);return Jr(Jr(e.localStore).persistence).fn()}function gl(t,e,n,r){return Object(Fr.b)(this,void 0,void 0,function(){var i,o,s;return Object(Fr.d)(this,function(a){switch(a.label){case 0:return(i=Jr(t)).$o?(Qr("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!i.Vo.has(e))return[3,8];switch(n){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,dc(i.localStore)];case 3:return o=a.sent(),s=Os.createSynthesizedRemoteEventForCurrentChange(e,"current"===n),[4,ul(i,o,s)];case 4:return a.sent(),[3,8];case 5:return[4,hc(i.localStore,e,!0)];case 6:return a.sent(),rl(i,e,r),[3,8];case 7:Xr(),a.label=8;case 8:return[2]}})})}function bl(t,e,n){return Object(Fr.b)(this,void 0,void 0,function(){var r,i,o,s,a,u,c,h,l;return Object(Fr.d)(this,function(f){switch(f.label){case 0:if(!(r=wl(t)).$o)return[3,10];i=0,o=e,f.label=1;case 1:return i<o.length?r.Vo.has(s=o[i])?(Qr("SyncEngine","Adding an already active target "+s),[3,5]):[4,fc(r.localStore,s)]:[3,6];case 2:return a=f.sent(),[4,cc(r.localStore,a)];case 3:return u=f.sent(),[4,Qh(r,vl(a),u.targetId,!1)];case 4:f.sent(),eh(r.remoteStore,u),f.label=5;case 5:return i++,[3,1];case 6:c=function(t){return Object(Fr.d)(this,function(e){switch(e.label){case 0:return r.Vo.has(t)?[4,hc(r.localStore,t,!1).then(function(){nh(r.remoteStore,t),rl(r,t)}).catch(ku)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})},h=0,l=n,f.label=7;case 7:return h<l.length?[5,c(l[h])]:[3,10];case 8:f.sent(),f.label=9;case 9:return h++,[3,7];case 10:return[2]}})})}function wl(t){var e=Jr(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=Yh.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=hl.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=$h.bind(null,e),e.vo._r=jh.bind(null,e.eventManager),e.vo.Mo=Rh.bind(null,e.eventManager),e}function Il(t){var e=Jr(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Jh.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Zh.bind(null,e),e}var Tl=function(){function t(){this.synchronizeTabs=!1}return t.prototype.initialize=function(t){return Object(Fr.b)(this,void 0,void 0,function(){return Object(Fr.d)(this,function(e){switch(e.label){case 0:return this.R=zc(t.databaseInfo.databaseId),this.sharedClientState=this.Bo(t),this.persistence=this.qo(t),[4,this.persistence.start()];case 1:return e.sent(),this.gcScheduler=this.Uo(t),this.localStore=this.Qo(t),[2]}})})},t.prototype.Uo=function(t){return null},t.prototype.Qo=function(t){return nc(this.persistence,new tc,t.initialUser,this.R)},t.prototype.qo=function(t){return new _c(Sc.bs,this.R)},t.prototype.Bo=function(t){return new Vc},t.prototype.terminate=function(){return Object(Fr.b)(this,void 0,void 0,function(){return Object(Fr.d)(this,function(t){switch(t.label){case 0:return this.gcScheduler&&this.gcScheduler.stop(),[4,this.sharedClientState.shutdown()];case 1:return t.sent(),[4,this.persistence.shutdown()];case 2:return t.sent(),[2]}})})},t}(),El=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).Ko=e,i.cacheSizeBytes=n,i.forceOwnership=r,i.synchronizeTabs=!1,i}return Object(Fr.c)(e,t),e.prototype.initialize=function(e){return Object(Fr.b)(this,void 0,void 0,function(){return Object(Fr.d)(this,function(n){switch(n.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return n.sent(),[4,pc(this.localStore)];case 2:return n.sent(),[4,this.Ko.initialize(this,e)];case 3:return n.sent(),[4,Il(this.Ko.syncEngine)];case 4:return n.sent(),[4,ph(this.Ko.remoteStore)];case 5:return n.sent(),[2]}})})},e.prototype.Qo=function(t){return nc(this.persistence,new tc,t.initialUser,this.R)},e.prototype.Uo=function(t){return new ju(this.persistence.referenceDelegate.garbageCollector,t.asyncQueue)},e.prototype.qo=function(t){var e=Xu(t.databaseInfo.databaseId,t.databaseInfo.persistenceKey),n=void 0!==this.cacheSizeBytes?mu.withCacheSize(this.cacheSizeBytes):mu.DEFAULT;return new Hu(this.synchronizeTabs,e,t.clientId,n,t.asyncQueue,Kc(),Gc(),this.R,this.sharedClientState,!!this.forceOwnership)},e.prototype.Bo=function(t){return new Vc},e}(Tl),_l=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n,!1)||this).Ko=e,r.cacheSizeBytes=n,r.synchronizeTabs=!0,r}return Object(Fr.c)(e,t),e.prototype.initialize=function(e){return Object(Fr.b)(this,void 0,void 0,function(){var n,r=this;return Object(Fr.d)(this,function(i){switch(i.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return i.sent(),n=this.Ko.syncEngine,this.sharedClientState instanceof Lc?(this.sharedClientState.syncEngine={ui:dl.bind(null,n),ai:gl.bind(null,n),hi:bl.bind(null,n),fn:ml.bind(null,n),ci:fl.bind(null,n)},[4,this.sharedClientState.start()]):[3,3];case 2:i.sent(),i.label=3;case 3:return[4,this.persistence.He(function(t){return Object(Fr.b)(r,void 0,void 0,function(){return Object(Fr.d)(this,function(e){switch(e.label){case 0:return[4,pl(this.Ko.syncEngine,t)];case 1:return e.sent(),this.gcScheduler&&(t&&!this.gcScheduler.started?this.gcScheduler.start(this.localStore):t||this.gcScheduler.stop()),[2]}})})})];case 4:return i.sent(),[2]}})})},e.prototype.Bo=function(t){var e=Kc();if(!Lc.yt(e))throw new Kr(Br.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=Xu(t.databaseInfo.databaseId,t.databaseInfo.persistenceKey);return new Lc(e,t.asyncQueue,n,t.clientId,t.initialUser)},e}(El),Ol=function(){function t(){}return t.prototype.initialize=function(t,e){return Object(Fr.b)(this,void 0,void 0,function(){var n=this;return Object(Fr.d)(this,function(r){switch(r.label){case 0:return this.localStore?[3,2]:(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(e),this.remoteStore=this.createRemoteStore(e),this.eventManager=this.createEventManager(e),this.syncEngine=this.createSyncEngine(e,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=function(t){return Xh(n.syncEngine,t,1)},this.remoteStore.remoteSyncer.handleCredentialChange=cl.bind(null,this.syncEngine),[4,Ih(this.remoteStore,this.syncEngine.isPrimaryClient)]);case 1:r.sent(),r.label=2;case 2:return[2]}})})},t.prototype.createEventManager=function(t){return new kh},t.prototype.createDatastore=function(t){var e=zc(t.databaseInfo.databaseId),n=new Bc(t.databaseInfo);return function(t,e,n){return new Xc(t,e,n)}(t.credentials,n,e)},t.prototype.createRemoteStore=function(t){var e,n,r,i,o,s=this;return e=this.localStore,n=this.datastore,r=t.asyncQueue,i=function(t){return Xh(s.syncEngine,t,0)},o=Mc.yt()?new Mc:new Uc,new Jc(e,n,r,i,o)},t.prototype.createSyncEngine=function(t,e){return function(t,e,n,r,i,o,s){var a=new Gh(t,e,n,r,i,o);return s&&(a.$o=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)},t.prototype.terminate=function(){return function(t){return Object(Fr.b)(this,void 0,void 0,function(){var e;return Object(Fr.d)(this,function(n){switch(n.label){case 0:return e=Jr(t),Qr("RemoteStore","RemoteStore shutting down."),e.Or.add(5),[4,th(e)];case 1:return n.sent(),e.Lr.shutdown(),e.Br.set("Unknown"),[2]}})})}(this.remoteStore)},t}(),Sl=function(){function t(t){this.observer=t,this.muted=!1}return t.prototype.next=function(t){this.observer.next&&this.jo(this.observer.next,t)},t.prototype.error=function(t){this.observer.error?this.jo(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},t.prototype.Wo=function(){this.muted=!0},t.prototype.jo=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},t}(),Dl=(function(){function t(t,e){var n=this;this.Go=t,this.R=e,this.metadata=new La,this.buffer=new Uint8Array,this.zo=new TextDecoder("utf-8"),this.Ho().then(function(t){t&&t.io()?n.metadata.resolve(t.payload.metadata):n.metadata.reject(new Error("The first element of the bundle is not a metadata, it is\n             "+JSON.stringify(null==t?void 0:t.payload)))},function(t){return n.metadata.reject(t)})}t.prototype.close=function(){return this.Go.cancel()},t.prototype.getMetadata=function(){return Object(Fr.b)(this,void 0,void 0,function(){return Object(Fr.d)(this,function(t){return[2,this.metadata.promise]})})},t.prototype.Lo=function(){return Object(Fr.b)(this,void 0,void 0,function(){return Object(Fr.d)(this,function(t){switch(t.label){case 0:return[4,this.getMetadata()];case 1:return[2,(t.sent(),this.Ho())]}})})},t.prototype.Ho=function(){return Object(Fr.b)(this,void 0,void 0,function(){var t,e,n,r;return Object(Fr.d)(this,function(i){switch(i.label){case 0:return[4,this.Jo()];case 1:return null===(t=i.sent())?[2,null]:(e=this.zo.decode(t),n=Number(e),isNaN(n)&&this.Yo("length string ("+e+") is not valid number"),[4,this.Xo(n)]);case 2:return r=i.sent(),[2,new Vh(JSON.parse(r),t.length+n)]}})})},t.prototype.Zo=function(){return this.buffer.findIndex(function(t){return t==="{".charCodeAt(0)})},t.prototype.Jo=function(){return Object(Fr.b)(this,void 0,void 0,function(){var t,e;return Object(Fr.d)(this,function(n){switch(n.label){case 0:return this.Zo()<0?[4,this.tc()]:[3,3];case 1:if(n.sent())return[3,3];n.label=2;case 2:return[3,0];case 3:return 0===this.buffer.length?[2,null]:((t=this.Zo())<0&&this.Yo("Reached the end of bundle when a length string is expected."),e=this.buffer.slice(0,t),[2,(this.buffer=this.buffer.slice(t),e)])}})})},t.prototype.Xo=function(t){return Object(Fr.b)(this,void 0,void 0,function(){var e;return Object(Fr.d)(this,function(n){switch(n.label){case 0:return this.buffer.length<t?[4,this.tc()]:[3,3];case 1:n.sent()&&this.Yo("Reached the end of bundle when more is expected."),n.label=2;case 2:return[3,0];case 3:return e=this.zo.decode(this.buffer.slice(0,t)),[2,(this.buffer=this.buffer.slice(t),e)]}})})},t.prototype.Yo=function(t){throw this.Go.cancel(),new Error("Invalid bundle format: "+t)},t.prototype.tc=function(){return Object(Fr.b)(this,void 0,void 0,function(){var t,e;return Object(Fr.d)(this,function(n){switch(n.label){case 0:return[4,this.Go.read()];case 1:return(t=n.sent()).done||((e=new Uint8Array(this.buffer.length+t.value.length)).set(this.buffer),e.set(t.value,this.buffer.length),this.buffer=e),[2,t.done]}})})}}(),function(){function t(t){this.datastore=t,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}return t.prototype.lookup=function(t){return Object(Fr.b)(this,void 0,void 0,function(){var e,n=this;return Object(Fr.d)(this,function(r){switch(r.label){case 0:if(this.ensureCommitNotCalled(),this.mutations.length>0)throw new Kr(Br.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(t,e){return Object(Fr.b)(this,void 0,void 0,function(){var n,r,i,o,s,a;return Object(Fr.d)(this,function(u){switch(u.label){case 0:return n=Jr(t),r=Hs(n.R)+"/documents",i={documents:e.map(function(t){return Ks(n.R,t)})},[4,n.$i("BatchGetDocuments",r,i)];case 1:return o=u.sent(),s=new Map,o.forEach(function(t){var e=function(t,e){return"found"in e?function(t,e){$r(!!e.found);var n=Gs(t,e.found.name),r=Fs(e.found.updateTime),i=new Fi({mapValue:{fields:e.found.fields}});return Bi.newFoundDocument(n,r,i)}(t,e):"missing"in e?function(t,e){$r(!!e.missing),$r(!!e.readTime);var n=Gs(t,e.missing),r=Fs(e.readTime);return Bi.newNoDocument(n,r)}(t,e):Xr()}(n.R,t);s.set(e.key.toString(),e)}),a=[],[2,(e.forEach(function(t){var e=s.get(t.toString());$r(!!e),a.push(e)}),a)]}})})}(this.datastore,t)];case 1:return[2,((e=r.sent()).forEach(function(t){return n.recordVersion(t)}),e)]}})})},t.prototype.set=function(t,e){this.write(e.toMutation(t,this.precondition(t))),this.writtenDocs.add(t.toString())},t.prototype.update=function(t,e){try{this.write(e.toMutation(t,this.preconditionForUpdate(t)))}catch(t){this.lastWriteError=t}this.writtenDocs.add(t.toString())},t.prototype.delete=function(t){this.write(new os(t,this.precondition(t))),this.writtenDocs.add(t.toString())},t.prototype.commit=function(){return Object(Fr.b)(this,void 0,void 0,function(){var t,e=this;return Object(Fr.d)(this,function(n){switch(n.label){case 0:if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;return t=this.readVersions,this.mutations.forEach(function(e){t.delete(e.key.toString())}),t.forEach(function(t,n){var r=Oi.fromPath(n);e.mutations.push(new ss(r,e.precondition(r)))}),[4,function(t,e){return Object(Fr.b)(this,void 0,void 0,function(){var n,r,i;return Object(Fr.d)(this,function(o){switch(o.label){case 0:return n=Jr(t),r=Hs(n.R)+"/documents",i={writes:e.map(function(t){return $s(n.R,t)})},[4,n.Ni("Commit",r,i)];case 1:return o.sent(),[2]}})})}(this.datastore,this.mutations)];case 1:return n.sent(),this.committed=!0,[2]}})})},t.prototype.recordVersion=function(t){var e;if(t.isFoundDocument())e=t.version;else{if(!t.isNoDocument())throw Xr();e=oi.min()}var n=this.readVersions.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Kr(Br.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(t.key.toString(),e)},t.prototype.precondition=function(t){var e=this.readVersions.get(t.toString());return!this.writtenDocs.has(t.toString())&&e?Go.updateTime(e):Go.none()},t.prototype.preconditionForUpdate=function(t){var e=this.readVersions.get(t.toString());if(!this.writtenDocs.has(t.toString())&&e){if(e.isEqual(oi.min()))throw new Kr(Br.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Go.updateTime(e)}return Go.exists(!0)},t.prototype.write=function(t){this.ensureCommitNotCalled(),this.mutations.push(t)},t.prototype.ensureCommitNotCalled=function(){},t}()),Nl=function(){function t(t,e,n,r){this.asyncQueue=t,this.datastore=e,this.updateFunction=n,this.deferred=r,this.ec=5,this.Zi=new Qc(this.asyncQueue,"transaction_retry")}return t.prototype.run=function(){this.nc()},t.prototype.nc=function(){var t=this;this.Zi.ji(function(){return Object(Fr.b)(t,void 0,void 0,function(){var t,e,n=this;return Object(Fr.d)(this,function(r){return t=new Dl(this.datastore),(e=this.sc(t))&&e.then(function(e){n.asyncQueue.enqueueAndForget(function(){return t.commit().then(function(){n.deferred.resolve(e)}).catch(function(t){n.ic(t)})})}).catch(function(t){n.ic(t)}),[2]})})})},t.prototype.sc=function(t){try{var e=this.updateFunction(t);return!Ti(e)&&e.catch&&e.then?e:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}},t.prototype.ic=function(t){var e=this;this.ec>0&&this.rc(t)?(this.ec-=1,this.asyncQueue.enqueueAndForget(function(){return e.nc(),Promise.resolve()})):this.deferred.reject(t)},t.prototype.rc=function(t){if("FirebaseError"===t.name){var e=t.code;return"aborted"===e||"failed-precondition"===e||!us(e)}return!1},t}(),Al=function(){function t(t,e,n){var r=this;this.credentials=t,this.asyncQueue=e,this.databaseInfo=n,this.user=Dc.UNAUTHENTICATED,this.clientId=ti.u(),this.credentialListener=function(){return Promise.resolve()},this.credentials.setChangeListener(e,function(t){return Object(Fr.b)(r,void 0,void 0,function(){return Object(Fr.d)(this,function(e){switch(e.label){case 0:return Qr("FirestoreClient","Received user=",t.uid),[4,this.credentialListener(t)];case 1:return e.sent(),this.user=t,[2]}})})})}return t.prototype.getConfiguration=function(){return Object(Fr.b)(this,void 0,void 0,function(){return Object(Fr.d)(this,function(t){return[2,{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,credentials:this.credentials,initialUser:this.user,maxConcurrentLimboResolutions:100}]})})},t.prototype.setCredentialChangeListener=function(t){this.credentialListener=t},t.prototype.verifyNotTerminated=function(){if(this.asyncQueue.isShuttingDown)throw new Kr(Br.FAILED_PRECONDITION,"The client has already been terminated.")},t.prototype.terminate=function(){var t=this;this.asyncQueue.enterRestrictedMode();var e=new La;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(function(){return Object(Fr.b)(t,void 0,void 0,function(){var t,n;return Object(Fr.d)(this,function(r){switch(r.label){case 0:return r.trys.push([0,5,,6]),this.onlineComponents?[4,this.onlineComponents.terminate()]:[3,2];case 1:r.sent(),r.label=2;case 2:return this.offlineComponents?[4,this.offlineComponents.terminate()]:[3,4];case 3:r.sent(),r.label=4;case 4:return this.credentials.removeChangeListener(),e.resolve(),[3,6];case 5:return t=r.sent(),n=Oh(t,"Failed to shutdown persistence"),e.reject(n),[3,6];case 6:return[2]}})})}),e.promise},t}();function kl(t,e){return Object(Fr.b)(this,void 0,void 0,function(){var n,r,i=this;return Object(Fr.d)(this,function(o){switch(o.label){case 0:return t.asyncQueue.verifyOperationInProgress(),Qr("FirestoreClient","Initializing OfflineComponentProvider"),[4,t.getConfiguration()];case 1:return n=o.sent(),[4,e.initialize(n)];case 2:return o.sent(),r=n.initialUser,t.setCredentialChangeListener(function(t){return Object(Fr.b)(i,void 0,void 0,function(){return Object(Fr.d)(this,function(n){switch(n.label){case 0:return r.isEqual(t)?[3,2]:[4,rc(e.localStore,t)];case 1:n.sent(),r=t,n.label=2;case 2:return[2]}})})}),e.persistence.setDatabaseDeletedListener(function(){return t.terminate()}),t.offlineComponents=e,[2]}})})}function xl(t,e){return Object(Fr.b)(this,void 0,void 0,function(){var n,r;return Object(Fr.d)(this,function(i){switch(i.label){case 0:return t.asyncQueue.verifyOperationInProgress(),[4,Cl(t)];case 1:return n=i.sent(),Qr("FirestoreClient","Initializing OnlineComponentProvider"),[4,t.getConfiguration()];case 2:return r=i.sent(),[4,e.initialize(n,r)];case 3:return i.sent(),t.setCredentialChangeListener(function(t){return function(t,e){return Object(Fr.b)(this,void 0,void 0,function(){var n,r;return Object(Fr.d)(this,function(i){switch(i.label){case 0:return(n=Jr(t)).asyncQueue.verifyOperationInProgress(),Qr("RemoteStore","RemoteStore received new credentials"),r=ah(n),n.Or.add(3),[4,th(n)];case 1:return i.sent(),r&&n.Br.set("Unknown"),[4,n.remoteSyncer.handleCredentialChange(e)];case 2:return i.sent(),n.Or.delete(3),[4,Zc(n)];case 3:return i.sent(),[2]}})})}(e.remoteStore,t)}),t.onlineComponents=e,[2]}})})}function Cl(t){return Object(Fr.b)(this,void 0,void 0,function(){return Object(Fr.d)(this,function(e){switch(e.label){case 0:return t.offlineComponents?[3,2]:(Qr("FirestoreClient","Using default OfflineComponentProvider"),[4,kl(t,new Tl)]);case 1:e.sent(),e.label=2;case 2:return[2,t.offlineComponents]}})})}function jl(t){return Object(Fr.b)(this,void 0,void 0,function(){return Object(Fr.d)(this,function(e){switch(e.label){case 0:return t.onlineComponents?[3,2]:(Qr("FirestoreClient","Using default OnlineComponentProvider"),[4,xl(t,new Ol)]);case 1:e.sent(),e.label=2;case 2:return[2,t.onlineComponents]}})})}function Rl(t){return Cl(t).then(function(t){return t.persistence})}function Pl(t){return Cl(t).then(function(t){return t.localStore})}function Ll(t){return jl(t).then(function(t){return t.remoteStore})}function Vl(t){return jl(t).then(function(t){return t.syncEngine})}function Ul(t){return Object(Fr.b)(this,void 0,void 0,function(){var e,n;return Object(Fr.d)(this,function(r){switch(r.label){case 0:return[4,jl(t)];case 1:return e=r.sent(),[2,((n=e.eventManager).onListen=zh.bind(null,e.syncEngine),n.onUnlisten=Hh.bind(null,e.syncEngine),n)]}})})}function Ml(t,e,n){var r=this;void 0===n&&(n={});var i=new La;return t.asyncQueue.enqueueAndForget(function(){return Object(Fr.b)(r,void 0,void 0,function(){var r;return Object(Fr.d)(this,function(o){switch(o.label){case 0:return r=function(t,e,n,r,i){var o=new Sl({next:function(o){e.enqueueAndForget(function(){return Ch(t,s)});var a=o.docs.has(n);!a&&o.fromCache?i.reject(new Kr(Br.UNAVAILABLE,"Failed to get document because the client is offline.")):a&&o.fromCache&&r&&"server"===r.source?i.reject(new Kr(Br.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(o)},error:function(t){return i.reject(t)}}),s=new Lh(lo(n.path),o,{includeMetadataChanges:!0,so:!0});return xh(t,s)},[4,Ul(t)];case 1:return[2,r.apply(void 0,[o.sent(),t.asyncQueue,e,n,i])]}})})}),i.promise}function Fl(t,e,n){var r=this;void 0===n&&(n={});var i=new La;return t.asyncQueue.enqueueAndForget(function(){return Object(Fr.b)(r,void 0,void 0,function(){var r;return Object(Fr.d)(this,function(o){switch(o.label){case 0:return r=function(t,e,n,r,i){var o=new Sl({next:function(n){e.enqueueAndForget(function(){return Ch(t,s)}),n.fromCache&&"server"===r.source?i.reject(new Kr(Br.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:function(t){return i.reject(t)}}),s=new Lh(n,o,{includeMetadataChanges:!0,so:!0});return xh(t,s)},[4,Ul(t)];case 1:return[2,r.apply(void 0,[o.sent(),t.asyncQueue,e,n,i])]}})})}),i.promise}var ql=function(t,e,n,r,i,o,s,a){this.databaseId=t,this.appId=e,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=s,this.useFetchStreams=a},Bl=function(){function t(t,e){this.projectId=t,this.database=e||"(default)"}return Object.defineProperty(t.prototype,"isDefaultDatabase",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database},t}(),Kl=new Map,Gl=function(t,e){this.user=e,this.type="OAuth",this.authHeaders={},this.authHeaders.Authorization="Bearer "+t},zl=function(){function t(){this.changeListener=null}return t.prototype.getToken=function(){return Promise.resolve(null)},t.prototype.invalidateToken=function(){},t.prototype.setChangeListener=function(t,e){this.changeListener=e,t.enqueueRetryable(function(){return e(Dc.UNAUTHENTICATED)})},t.prototype.removeChangeListener=function(){this.changeListener=null},t}(),Ql=function(){function t(t){this.token=t,this.changeListener=null}return t.prototype.getToken=function(){return Promise.resolve(this.token)},t.prototype.invalidateToken=function(){},t.prototype.setChangeListener=function(t,e){var n=this;this.changeListener=e,t.enqueueRetryable(function(){return e(n.token.user)})},t.prototype.removeChangeListener=function(){this.changeListener=null},t}(),Hl=function(){function t(t){var e=this;this.currentUser=Dc.UNAUTHENTICATED,this.oc=new La,this.cc=0,this.forceRefresh=!1,this.auth=null,this.asyncQueue=null,this.uc=function(){e.cc++,e.currentUser=e.ac(),e.oc.resolve(),e.changeListener&&e.asyncQueue.enqueueRetryable(function(){return e.changeListener(e.currentUser)})};var n=function(t){Qr("FirebaseCredentialsProvider","Auth detected"),e.auth=t,e.auth.addAuthTokenListener(e.uc)};t.onInit(function(t){return n(t)}),setTimeout(function(){if(!e.auth){var r=t.getImmediate({optional:!0});r?n(r):(Qr("FirebaseCredentialsProvider","Auth not yet detected"),e.oc.resolve())}},0)}return t.prototype.getToken=function(){var t=this,e=this.cc,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(function(n){return t.cc!==e?(Qr("FirebaseCredentialsProvider","getToken aborted due to token change."),t.getToken()):n?($r("string"==typeof n.accessToken),new Gl(n.accessToken,t.currentUser)):null}):Promise.resolve(null)},t.prototype.invalidateToken=function(){this.forceRefresh=!0},t.prototype.setChangeListener=function(t,e){var n=this;this.asyncQueue=t,this.asyncQueue.enqueueRetryable(function(){return Object(Fr.b)(n,void 0,void 0,function(){return Object(Fr.d)(this,function(t){switch(t.label){case 0:return[4,this.oc.promise];case 1:return t.sent(),[4,e(this.currentUser)];case 2:return t.sent(),this.changeListener=e,[2]}})})})},t.prototype.removeChangeListener=function(){this.auth&&this.auth.removeAuthTokenListener(this.uc),this.changeListener=function(){return Promise.resolve()}},t.prototype.ac=function(){var t=this.auth&&this.auth.getUid();return $r(null===t||"string"==typeof t),new Dc(t)},t}(),Wl=function(){function t(t,e,n){this.hc=t,this.lc=e,this.fc=n,this.type="FirstParty",this.user=Dc.FIRST_PARTY}return Object.defineProperty(t.prototype,"authHeaders",{get:function(){var t={"X-Goog-AuthUser":this.lc},e=this.hc.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),this.fc&&(t["X-Goog-Iam-Authorization-Token"]=this.fc),t},enumerable:!1,configurable:!0}),t}(),Yl=function(){function t(t,e,n){this.hc=t,this.lc=e,this.fc=n}return t.prototype.getToken=function(){return Promise.resolve(new Wl(this.hc,this.lc,this.fc))},t.prototype.setChangeListener=function(t,e){t.enqueueRetryable(function(){return e(Dc.FIRST_PARTY)})},t.prototype.removeChangeListener=function(){},t.prototype.invalidateToken=function(){},t}();function Xl(t,e,n){if(!n)throw new Kr(Br.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function $l(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new Kr(Br.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function Jl(t,e,n,r){if(!0===e&&!0===r)throw new Kr(Br.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function Zl(t){if(!Oi.isDocumentKey(t))throw new Kr(Br.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t+" has "+t.length+".")}function tf(t){if(Oi.isDocumentKey(t))throw new Kr(Br.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t+" has "+t.length+".")}function ef(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";var e=function(t){if(t.constructor){var e=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString());if(e&&e.length>1)return e[1]}return null}(t);return e?"a custom "+e+" object":"an object"}return"function"==typeof t?"a function":Xr()}function nf(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Kr(Br.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");var n=ef(t);throw new Kr(Br.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+n)}return t}function rf(t,e){if(e<=0)throw new Kr(Br.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}var of=function(){function t(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new Kr(Br.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new Kr(Br.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.useFetchStreams=!!t.useFetchStreams,Jl("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}return t.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams},t}(),sf=function(){function t(t,e){this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new of({}),this._settingsFrozen=!1,t instanceof Bl?(this._databaseId=t,this._credentials=new zl):(this._app=t,this._databaseId=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new Kr(Br.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Bl(t.options.projectId)}(t),this._credentials=new Hl(e))}return Object.defineProperty(t.prototype,"app",{get:function(){if(!this._app)throw new Kr(Br.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_initialized",{get:function(){return this._settingsFrozen},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_terminated",{get:function(){return void 0!==this._terminateTask},enumerable:!1,configurable:!0}),t.prototype._setSettings=function(t){if(this._settingsFrozen)throw new Kr(Br.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new of(t),void 0!==t.credentials&&(this._credentials=function(t){if(!t)return new zl;switch(t.type){case"gapi":var e=t.client;return $r(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Yl(e,t.sessionIndex||"0",t.iamToken||null);case"provider":return t.client;default:throw new Kr(Br.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},t.prototype._getSettings=function(){return this._settings},t.prototype._freezeSettings=function(){return this._settingsFrozen=!0,this._settings},t.prototype._delete=function(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask},t.prototype.toJSON=function(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}},t.prototype._terminate=function(){return(t=Kl.get(this))&&(Qr("ComponentProvider","Removing Datastore"),Kl.delete(this),t.terminate()),Promise.resolve();var t},t}(),af=function(){function t(t,e,n){this.converter=e,this._key=n,this.type="document",this.firestore=t}return Object.defineProperty(t.prototype,"_path",{get:function(){return this._key.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this._key.path.canonicalString()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new cf(this.firestore,this.converter,this._key.path.popLast())},enumerable:!1,configurable:!0}),t.prototype.withConverter=function(e){return new t(this.firestore,e,this._key)},t}(),uf=function(){function t(t,e,n){this.converter=e,this._query=n,this.type="query",this.firestore=t}return t.prototype.withConverter=function(e){return new t(this.firestore,e,this._query)},t}(),cf=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,lo(r))||this)._path=r,i.type="collection",i}return Object(Fr.c)(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._query.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._query.path.canonicalString()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this._path.popLast();return t.isEmpty()?null:new af(this.firestore,null,new Oi(t))},enumerable:!1,configurable:!0}),e.prototype.withConverter=function(t){return new e(this.firestore,t,this._path)},e}(uf);function hf(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t=Object(A.i)(t),Xl("collection","path",e),t instanceof sf)return tf(n=hi.fromString.apply(hi,Object(Fr.f)([e],r))),new cf(t,null,n);if(!(t instanceof af||t instanceof cf))throw new Kr(Br.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return tf(n=hi.fromString.apply(hi,Object(Fr.f)([t.path],r)).child(hi.fromString(e))),new cf(t.firestore,null,n)}function lf(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t=Object(A.i)(t),1===arguments.length&&(e=ti.u()),Xl("doc","path",e),t instanceof sf)return Zl(n=hi.fromString.apply(hi,Object(Fr.f)([e],r))),new af(t,null,new Oi(n));if(!(t instanceof af||t instanceof cf))throw new Kr(Br.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return Zl(n=t._path.child(hi.fromString.apply(hi,Object(Fr.f)([e],r)))),new af(t.firestore,t instanceof cf?t.converter:null,new Oi(n))}function ff(t,e){return t=Object(A.i)(t),e=Object(A.i)(e),(t instanceof af||t instanceof cf)&&(e instanceof af||e instanceof cf)&&t.firestore===e.firestore&&t.path===e.path&&t.converter===e.converter}function df(t,e){return t=Object(A.i)(t),e=Object(A.i)(e),t instanceof uf&&e instanceof uf&&t.firestore===e.firestore&&Io(t._query,e._query)&&t.converter===e.converter}var pf=function(){function t(){var t=this;this.dc=Promise.resolve(),this.wc=[],this._c=!1,this.mc=[],this.yc=null,this.gc=!1,this.Ec=[],this.Zi=new Qc(this,"async_queue_retry"),this.Tc=function(){var e=Gc();e&&Qr("AsyncQueue","Visibility state changed to "+e.visibilityState),t.Zi.Gi()};var e=Gc();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Tc)}return Object.defineProperty(t.prototype,"isShuttingDown",{get:function(){return this._c},enumerable:!1,configurable:!0}),t.prototype.enqueueAndForget=function(t){this.enqueue(t)},t.prototype.enqueueAndForgetEvenWhileRestricted=function(t){this.Ic(),this.Ac(t)},t.prototype.enterRestrictedMode=function(){if(!this._c){this._c=!0;var t=Gc();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Tc)}},t.prototype.enqueue=function(t){return this.Ic(),this._c?new Promise(function(t){}):this.Ac(t)},t.prototype.enqueueRetryable=function(t){var e=this;this.enqueueAndForget(function(){return e.wc.push(t),e.Rc()})},t.prototype.Rc=function(){return Object(Fr.b)(this,void 0,void 0,function(){var t,e=this;return Object(Fr.d)(this,function(n){switch(n.label){case 0:if(0===this.wc.length)return[3,5];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.wc[0]()];case 2:return n.sent(),this.wc.shift(),this.Zi.reset(),[3,4];case 3:if(!Ba(t=n.sent()))throw t;return Qr("AsyncQueue","Operation failed with retryable error: "+t),[3,4];case 4:this.wc.length>0&&this.Zi.ji(function(){return e.Rc()}),n.label=5;case 5:return[2]}})})},t.prototype.Ac=function(t){var e=this,n=this.dc.then(function(){return e.gc=!0,t().catch(function(t){throw e.yc=t,e.gc=!1,Hr("INTERNAL UNHANDLED ERROR: ",function(t){var e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t)),t}).then(function(t){return e.gc=!1,t})});return this.dc=n,n},t.prototype.enqueueAfterDelay=function(t,e,n){var r=this;this.Ic(),this.Ec.indexOf(t)>-1&&(e=0);var i=_h.createAndSchedule(this,t,e,n,function(t){return r.bc(t)});return this.mc.push(i),i},t.prototype.Ic=function(){this.yc&&Xr()},t.prototype.verifyOperationInProgress=function(){},t.prototype.vc=function(){return Object(Fr.b)(this,void 0,void 0,function(){var t;return Object(Fr.d)(this,function(e){switch(e.label){case 0:return[4,t=this.dc];case 1:e.sent(),e.label=2;case 2:if(t!==this.dc)return[3,0];e.label=3;case 3:return[2]}})})},t.prototype.Pc=function(t){for(var e=0,n=this.mc;e<n.length;e++)if(n[e].timerId===t)return!0;return!1},t.prototype.Vc=function(t){var e=this;return this.vc().then(function(){e.mc.sort(function(t,e){return t.targetTimeMs-e.targetTimeMs});for(var n=0,r=e.mc;n<r.length;n++){var i=r[n];if(i.skipDelay(),"all"!==t&&i.timerId===t)break}return e.vc()})},t.prototype.Sc=function(t){this.Ec.push(t)},t.prototype.bc=function(t){var e=this.mc.indexOf(t);this.mc.splice(e,1)},t}();function yf(t){return function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=t,r=0,i=["next","error","complete"];r<i.length;r++){var o=i[r];if(o in n&&"function"==typeof n[o])return!0}return!1}(t)}!function(){function t(){this._progressObserver={},this._taskCompletionResolver=new La,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}t.prototype.onProgress=function(t,e,n){this._progressObserver={next:t,error:e,complete:n}},t.prototype.catch=function(t){return this._taskCompletionResolver.promise.catch(t)},t.prototype.then=function(t,e){return this._taskCompletionResolver.promise.then(t,e)},t.prototype._completeWith=function(t){this._updateProgress(t),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(t)},t.prototype._failWith=function(t){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(t),this._taskCompletionResolver.reject(t)},t.prototype._updateProgress=function(t){this._lastProgress=t,this._progressObserver.next&&this._progressObserver.next(t)}}();var vf=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).type="firestore",r._queue=new pf,r._persistenceKey="name"in e?e.name:"[DEFAULT]",r}return Object(Fr.c)(e,t),e.prototype._terminate=function(){return this._firestoreClient||gf(this),this._firestoreClient.terminate()},e}(sf);function mf(t){return t._firestoreClient||gf(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function gf(t){var e,n=t._freezeSettings(),r=function(t,e,n,r){return new ql(t,e,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,r.useFetchStreams)}(t._databaseId,(null===(e=t._app)||void 0===e?void 0:e.options.appId)||"",t._persistenceKey,n);t._firestoreClient=new Al(t._credentials,t._queue,r)}function bf(t,e,n){var r=this,i=new La;return t.asyncQueue.enqueue(function(){return Object(Fr.b)(r,void 0,void 0,function(){var r;return Object(Fr.d)(this,function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),[4,kl(t,n)];case 1:return o.sent(),[4,xl(t,e)];case 2:return o.sent(),i.resolve(),[3,4];case 3:if(!function(t){return"FirebaseError"===t.name?t.code===Br.FAILED_PRECONDITION||t.code===Br.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code}(r=o.sent()))throw r;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+r),i.reject(r),[3,4];case 4:return[2]}})})}).then(function(){return i.promise})}function wf(t){if(t._initialized||t._terminated)throw new Kr(Br.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var If=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new Kr(Br.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new fi(t)}return t.prototype.isEqual=function(t){return this._internalPath.isEqual(t._internalPath)},t}(),Tf=function(){function t(t){this._byteString=t}return t.fromBase64String=function(e){try{return new t(pi.fromBase64String(e))}catch(e){throw new Kr(Br.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}},t.fromUint8Array=function(e){return new t(pi.fromUint8Array(e))},t.prototype.toBase64=function(){return this._byteString.toBase64()},t.prototype.toUint8Array=function(){return this._byteString.toUint8Array()},t.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},t.prototype.isEqual=function(t){return this._byteString.isEqual(t._byteString)},t}(),Ef=function(t){this._methodName=t},_f=function(){function t(t,e){if(!isFinite(t)||t<-90||t>90)throw new Kr(Br.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new Kr(Br.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}return Object.defineProperty(t.prototype,"latitude",{get:function(){return this._lat},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"longitude",{get:function(){return this._long},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this._lat===t._lat&&this._long===t._long},t.prototype.toJSON=function(){return{latitude:this._lat,longitude:this._long}},t.prototype._compareTo=function(t){return ei(this._lat,t._lat)||ei(this._long,t._long)},t}(),Of=/^__.*__$/,Sf=function(){function t(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}return t.prototype.toMutation=function(t,e){return null!==this.fieldMask?new Zo(t,this.data,this.fieldMask,e,this.fieldTransforms):new Jo(t,this.data,e,this.fieldTransforms)},t}(),Df=function(){function t(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}return t.prototype.toMutation=function(t,e){return new Zo(t,this.data,this.fieldMask,e,this.fieldTransforms)},t}();function Nf(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Xr()}}var Af=function(){function t(t,e,n,r,i,o){this.settings=t,this.databaseId=e,this.R=n,this.ignoreUndefinedProperties=r,void 0===i&&this.Dc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}return Object.defineProperty(t.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Cc",{get:function(){return this.settings.Cc},enumerable:!1,configurable:!0}),t.prototype.Nc=function(e){return new t(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.R,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)},t.prototype.xc=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.Nc({path:n,Fc:!1});return r.kc(t),r},t.prototype.$c=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.Nc({path:n,Fc:!1});return r.Dc(),r},t.prototype.Oc=function(t){return this.Nc({path:void 0,Fc:!0})},t.prototype.Mc=function(t){return Yf(t,this.settings.methodName,this.settings.Lc||!1,this.path,this.settings.Bc)},t.prototype.contains=function(t){return void 0!==this.fieldMask.find(function(e){return t.isPrefixOf(e)})||void 0!==this.fieldTransforms.find(function(e){return t.isPrefixOf(e.field)})},t.prototype.Dc=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.kc(this.path.get(t))},t.prototype.kc=function(t){if(0===t.length)throw this.Mc("Document fields must not be empty");if(Nf(this.Cc)&&Of.test(t))throw this.Mc('Document fields cannot begin and end with "__"')},t}(),kf=function(){function t(t,e,n){this.databaseId=t,this.ignoreUndefinedProperties=e,this.R=n||zc(t)}return t.prototype.qc=function(t,e,n,r){return void 0===r&&(r=!1),new Af({Cc:t,methodName:e,Bc:n,path:fi.emptyPath(),Fc:!1,Lc:r},this.databaseId,this.R,this.ignoreUndefinedProperties)},t}();function xf(t){var e=t._freezeSettings(),n=zc(t._databaseId);return new kf(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Cf(t,e,n,r,i,o){void 0===o&&(o={});var s=t.qc(o.merge||o.mergeFields?2:0,e,n,i);zf("Data must be an object, but it was:",s,r);var a,u,c=Kf(r,s);if(o.merge)a=new di(s.fieldMask),u=s.fieldTransforms;else if(o.mergeFields){for(var h=[],l=0,f=o.mergeFields;l<f.length;l++){var d=Qf(e,f[l],n);if(!s.contains(d))throw new Kr(Br.INVALID_ARGUMENT,"Field '"+d+"' is specified in your field mask but missing from your input data.");Xf(h,d)||h.push(d)}a=new di(h),u=s.fieldTransforms.filter(function(t){return a.covers(t.field)})}else a=null,u=s.fieldTransforms;return new Sf(new Fi(c),a,u)}var jf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(Fr.c)(e,t),e.prototype._toFieldTransform=function(t){if(2!==t.Cc)throw t.Mc(1===t.Cc?this._methodName+"() can only appear at the top level of your update data":this._methodName+"() cannot be used with set() unless you pass {merge:true}");return t.fieldMask.push(t.path),null},e.prototype.isEqual=function(t){return t instanceof e},e}(Ef);function Rf(t,e,n){return new Af({Cc:3,Bc:e.settings.Bc,methodName:t._methodName,Fc:n},e.databaseId,e.R,e.ignoreUndefinedProperties)}var Pf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(Fr.c)(e,t),e.prototype._toFieldTransform=function(t){return new Bo(t.path,new Ro)},e.prototype.isEqual=function(t){return t instanceof e},e}(Ef),Lf=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).Uc=n,r}return Object(Fr.c)(e,t),e.prototype._toFieldTransform=function(t){var e=Rf(this,t,!0),n=this.Uc.map(function(t){return Bf(t,e)}),r=new Po(n);return new Bo(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(Ef),Vf=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).Uc=n,r}return Object(Fr.c)(e,t),e.prototype._toFieldTransform=function(t){var e=Rf(this,t,!0),n=this.Uc.map(function(t){return Bf(t,e)}),r=new Vo(n);return new Bo(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(Ef),Uf=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).Qc=n,r}return Object(Fr.c)(e,t),e.prototype._toFieldTransform=function(t){var e=new Mo(t.R,Ao(t.R,this.Qc));return new Bo(t.path,e)},e.prototype.isEqual=function(t){return this===t},e}(Ef);function Mf(t,e,n,r){var i=t.qc(1,e,n);zf("Data must be an object, but it was:",i,r);var o=[],s=Fi.empty();ai(r,function(t,r){var a=Wf(e,t,n);r=Object(A.i)(r);var u=i.$c(a);if(r instanceof jf)o.push(a);else{var c=Bf(r,u);null!=c&&(o.push(a),s.set(a,c))}});var a=new di(o);return new Df(s,a,i.fieldTransforms)}function Ff(t,e,n,r,i,o){var s=t.qc(1,e,n),a=[Qf(e,r,n)],u=[i];if(o.length%2!=0)throw new Kr(Br.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)a.push(Qf(e,o[c])),u.push(o[c+1]);for(var h=[],l=Fi.empty(),f=a.length-1;f>=0;--f)if(!Xf(h,a[f])){var d=a[f],p=u[f];p=Object(A.i)(p);var y=s.$c(d);if(p instanceof jf)h.push(d);else{var v=Bf(p,y);null!=v&&(h.push(d),l.set(d,v))}}var m=new di(h);return new Df(l,m,s.fieldTransforms)}function qf(t,e,n,r){return void 0===r&&(r=!1),Bf(n,t.qc(r?4:3,e))}function Bf(t,e){if(Gf(t=Object(A.i)(t)))return zf("Unsupported field value:",e,t),Kf(t,e);if(t instanceof Ef)return function(t,e){if(!Nf(e.Cc))throw e.Mc(t._methodName+"() can only be used with update() and set()");if(!e.path)throw e.Mc(t._methodName+"() is not currently supported inside arrays");var n=t._toFieldTransform(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(void 0===t&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.Fc&&4!==e.Cc)throw e.Mc("Nested arrays are not supported");return function(t,e){for(var n=[],r=0,i=0,o=t;i<o.length;i++){var s=Bf(o[i],e.Oc(r));null==s&&(s={nullValue:"NULL_VALUE"}),n.push(s),r++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(null===(t=Object(A.i)(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Ao(e.R,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=ii.fromDate(t);return{timestampValue:Vs(e.R,n)}}if(t instanceof ii)return n=new ii(t.seconds,1e3*Math.floor(t.nanoseconds/1e3)),{timestampValue:Vs(e.R,n)};if(t instanceof _f)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Tf)return{bytesValue:Us(e.R,t._byteString)};if(t instanceof af){var r=t.firestore._databaseId;if(!r.isEqual(n=e.databaseId))throw e.Mc("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:qs(t.firestore._databaseId||e.databaseId,t._key.path)}}throw e.Mc("Unsupported field value: "+ef(t))}(t,e)}function Kf(t,e){var n={};return ui(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ai(t,function(t,r){var i=Bf(r,e.xc(t));null!=i&&(n[t]=i)}),{mapValue:{fields:n}}}function Gf(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof ii||t instanceof _f||t instanceof Tf||t instanceof af||t instanceof Ef)}function zf(t,e,n){if(!Gf(n)||!function(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}(n)){var r=ef(n);throw e.Mc("an object"===r?t+" a custom object":t+" "+r)}}function Qf(t,e,n){if((e=Object(A.i)(e))instanceof If)return e._internalPath;if("string"==typeof e)return Wf(t,e);throw Yf("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var Hf=new RegExp("[~\\*/\\[\\]]");function Wf(t,e,n){if(e.search(Hf)>=0)throw Yf("Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'",t,!1,void 0,n);try{return(new(If.bind.apply(If,Object(Fr.f)([void 0],e.split(".")))))._internalPath}catch(r){throw Yf("Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",t,!1,void 0,n)}}function Yf(t,e,n,r,i){var o=r&&!r.isEmpty(),s=void 0!==i,a="Function "+e+"() called with invalid data";n&&(a+=" (via `toFirestore()`)");var u="";return(o||s)&&(u+=" (found",o&&(u+=" in field "+r),s&&(u+=" in document "+i),u+=")"),new Kr(Br.INVALID_ARGUMENT,(a+=". ")+t+u)}function Xf(t,e){return t.some(function(t){return t.isEqual(e)})}var $f=function(){function t(t,e,n,r,i){this._firestore=t,this._userDataWriter=e,this._key=n,this._document=r,this._converter=i}return Object.defineProperty(t.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new af(this._firestore,this._converter,this._key)},enumerable:!1,configurable:!0}),t.prototype.exists=function(){return null!==this._document},t.prototype.data=function(){if(this._document){if(this._converter){var t=new Jf(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}},t.prototype.get=function(t){if(this._document){var e=this._document.data.field(Zf("DocumentSnapshot.get",t));if(null!==e)return this._userDataWriter.convertValue(e)}},t}(),Jf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(Fr.c)(e,t),e.prototype.data=function(){return t.prototype.data.call(this)},e}($f);function Zf(t,e){return"string"==typeof e?Wf(t,e):e instanceof If?e._internalPath:e._delegate._internalPath}var td=function(){function t(t,e){this.hasPendingWrites=t,this.fromCache=e}return t.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},t}(),ed=function(t){function e(e,n,r,i,o,s){var a=this;return(a=t.call(this,e,n,r,i,s)||this)._firestore=e,a._firestoreImpl=e,a.metadata=o,a}return Object(Fr.c)(e,t),e.prototype.exists=function(){return t.prototype.exists.call(this)},e.prototype.data=function(t){if(void 0===t&&(t={}),this._document){if(this._converter){var e=new nd(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}},e.prototype.get=function(t,e){if(void 0===e&&(e={}),this._document){var n=this._document.data.field(Zf("DocumentSnapshot.get",t));if(null!==n)return this._userDataWriter.convertValue(n,e.serverTimestamps)}},e}($f),nd=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(Fr.c)(e,t),e.prototype.data=function(e){return void 0===e&&(e={}),t.prototype.data.call(this,e)},e}(ed),rd=function(){function t(t,e,n,r){this._firestore=t,this._userDataWriter=e,this._snapshot=r,this.metadata=new td(r.hasPendingWrites,r.fromCache),this.query=n}return Object.defineProperty(t.prototype,"docs",{get:function(){var t=[];return this.forEach(function(e){return t.push(e)}),t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._snapshot.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t,e){var n=this;this._snapshot.docs.forEach(function(r){t.call(e,new nd(n._firestore,n._userDataWriter,r.key,r,new td(n._snapshot.mutatedKeys.has(r.key),n._snapshot.fromCache),n.query.converter))})},t.prototype.docChanges=function(t){void 0===t&&(t={});var e=!!t.includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new Kr(Br.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(t,e){if(t._snapshot.oldDocs.isEmpty()){var n=0;return t._snapshot.docChanges.map(function(e){return{type:"added",doc:new nd(t._firestore,t._userDataWriter,e.doc.key,e.doc,new td(t._snapshot.mutatedKeys.has(e.doc.key),t._snapshot.fromCache),t.query.converter),oldIndex:-1,newIndex:n++}})}var r=t._snapshot.oldDocs;return t._snapshot.docChanges.filter(function(t){return e||3!==t.type}).map(function(e){var n=new nd(t._firestore,t._userDataWriter,e.doc.key,e.doc,new td(t._snapshot.mutatedKeys.has(e.doc.key),t._snapshot.fromCache),t.query.converter),i=-1,o=-1;return 0!==e.type&&(i=r.indexOf(e.doc.key),r=r.delete(e.doc.key)),1!==e.type&&(o=(r=r.add(e.doc)).indexOf(e.doc.key)),{type:id(e.type),doc:n,oldIndex:i,newIndex:o}})}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges},t}();function id(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Xr()}}function od(t,e){return t instanceof ed&&e instanceof ed?t._firestore===e._firestore&&t._key.isEqual(e._key)&&(null===t._document?null===e._document:t._document.isEqual(e._document))&&t._converter===e._converter:t instanceof rd&&e instanceof rd&&t._firestore===e._firestore&&df(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._snapshot.isEqual(e._snapshot)}function sd(t){if(po(t)&&0===t.explicitOrderBy.length)throw new Kr(Br.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var ad=function(){};function ud(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0,i=e;r<i.length;r++){var o=i[r];t=o._apply(t)}return t}var cd=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).Kc=e,i.jc=n,i.Wc=r,i.type="where",i}return Object(Fr.c)(e,t),e.prototype._apply=function(t){var e=xf(t.firestore),n=function(t,e,n,r,i,o,s){var a;if(i.isKeyField()){if("array-contains"===o||"array-contains-any"===o)throw new Kr(Br.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o+"' queries on FieldPath.documentId().");if("in"===o||"not-in"===o){vd(s,o);for(var u=[],c=0,h=s;c<h.length;c++)u.push(yd(r,t,h[c]));a={arrayValue:{values:u}}}else a=yd(r,t,s)}else"in"!==o&&"not-in"!==o&&"array-contains-any"!==o||vd(s,o),a=qf(n,"where",s,"in"===o||"not-in"===o);var l=Wi.create(i,o,a);return function(t,e){if(e.g()){var n=vo(t);if(null!==n&&!n.isEqual(e.field))throw new Kr(Br.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");var r=yo(t);null!==r&&md(0,e.field,r)}var i=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(e.indexOf(i.op)>=0)return i.op}return null}(t,function(t){switch(t){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==i)throw new Kr(Br.INVALID_ARGUMENT,i===e.op?"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter.":"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+i.toString()+"' filters.")}(t,l),l}(t._query,0,e,t.firestore._databaseId,this.Kc,this.jc,this.Wc);return new uf(t.firestore,t.converter,function(t,e){var n=t.filters.concat([e]);return new co(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}(t._query,n))},e}(ad),hd=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Kc=e,r.Gc=n,r.type="orderBy",r}return Object(Fr.c)(e,t),e.prototype._apply=function(t){var e=function(t,e,n){if(null!==t.startAt)throw new Kr(Br.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Kr(Br.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new oo(e,n);return function(t,e){if(null===yo(t)){var n=vo(t);null!==n&&md(0,n,e.field)}}(t,r),r}(t._query,this.Kc,this.Gc);return new uf(t.firestore,t.converter,function(t,e){var n=t.explicitOrderBy.concat([e]);return new co(t.path,t.collectionGroup,n,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(t._query,e))},e}(ad),ld=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.zc=n,i.Hc=r,i}return Object(Fr.c)(e,t),e.prototype._apply=function(t){return new uf(t.firestore,t.converter,wo(t._query,this.zc,this.Hc))},e}(ad),fd=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.Jc=n,i.Yc=r,i}return Object(Fr.c)(e,t),e.prototype._apply=function(t){var e=pd(t,this.type,this.Jc,this.Yc);return new uf(t.firestore,t.converter,function(t,e){return new co(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)}(t._query,e))},e}(ad),dd=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.Jc=n,i.Yc=r,i}return Object(Fr.c)(e,t),e.prototype._apply=function(t){var e=pd(t,this.type,this.Jc,this.Yc);return new uf(t.firestore,t.converter,function(t,e){return new co(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)}(t._query,e))},e}(ad);function pd(t,e,n,r){if(n[0]=Object(A.i)(n[0]),n[0]instanceof $f)return function(t,e,n,r,i){if(!r)throw new Kr(Br.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+n+"().");for(var o=[],s=0,a=go(t);s<a.length;s++){var u=a[s];if(u.field.isKeyField())o.push(ji(e,r.key));else{var c=r.data.field(u.field);if(bi(c))throw new Kr(Br.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===c){var h=u.field.canonicalString();throw new Kr(Br.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+h+"' (used as the orderBy) does not exist.")}o.push(c)}}return new ro(o,i)}(t._query,t.firestore._databaseId,e,n[0]._document,r);var i=xf(t.firestore);return function(t,e,n,r,i,o){var s=t.explicitOrderBy;if(i.length>s.length)throw new Kr(Br.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var a=[],u=0;u<i.length;u++){var c=i[u];if(s[u].field.isKeyField()){if("string"!=typeof c)throw new Kr(Br.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!mo(t)&&-1!==c.indexOf("/"))throw new Kr(Br.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(hi.fromString(c));if(!Oi.isDocumentKey(h))throw new Kr(Br.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");var l=new Oi(h);a.push(ji(e,l))}else{var f=qf(n,r,c);a.push(f)}}return new ro(a,o)}(t._query,t.firestore._databaseId,i,e,n,r)}function yd(t,e,n){if("string"==typeof(n=Object(A.i)(n))){if(""===n)throw new Kr(Br.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!mo(e)&&-1!==n.indexOf("/"))throw new Kr(Br.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var r=e.path.child(hi.fromString(n));if(!Oi.isDocumentKey(r))throw new Kr(Br.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+r+"' is not because it has an odd number of segments ("+r.length+").");return ji(t,new Oi(r))}if(n instanceof af)return ji(t,n._key);throw new Kr(Br.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+ef(n)+".")}function vd(t,e){if(!Array.isArray(t)||0===t.length)throw new Kr(Br.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(t.length>10)throw new Kr(Br.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function md(t,e,n){if(!n.isEqual(e))throw new Kr(Br.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}var gd=function(){function t(){}return t.prototype.convertValue=function(t,e){switch(void 0===e&&(e="none"),Si(t)){case 0:return null;case 1:return t.booleanValue;case 2:return mi(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(gi(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 10:return this.convertObject(t.mapValue,e);default:throw Xr()}},t.prototype.convertObject=function(t,e){var n=this,r={};return ai(t.fields,function(t,i){r[t]=n.convertValue(i,e)}),r},t.prototype.convertGeoPoint=function(t){return new _f(mi(t.latitude),mi(t.longitude))},t.prototype.convertArray=function(t,e){var n=this;return(t.values||[]).map(function(t){return n.convertValue(t,e)})},t.prototype.convertServerTimestamp=function(t,e){switch(e){case"previous":var n=wi(t);return null==n?null:this.convertValue(n,e);case"estimate":return this.convertTimestamp(Ii(t));default:return null}},t.prototype.convertTimestamp=function(t){var e=vi(t);return new ii(e.seconds,e.nanos)},t.prototype.convertDocumentKey=function(t,e){var n=hi.fromString(t);$r(fa(n));var r=new Bl(n.get(1),n.get(3)),i=new Oi(n.popFirst(5));return r.isEqual(e)||Hr("Document "+i+" contains a document reference within a different database ("+r.projectId+"/"+r.database+") which is not supported. It will be treated as a reference in the current database ("+e.projectId+"/"+e.database+") instead."),i},t}();function bd(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var wd=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return Object(Fr.c)(e,t),e.prototype.convertBytes=function(t){return new Tf(t)},e.prototype.convertReference=function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return new af(this.firestore,null,e)},e}(gd),Id=function(){function t(t,e){this._firestore=t,this._commitHandler=e,this._mutations=[],this._committed=!1,this._dataReader=xf(t)}return t.prototype.set=function(t,e,n){this._verifyNotCommitted();var r=Td(t,this._firestore),i=bd(r.converter,e,n),o=Cf(this._dataReader,"WriteBatch.set",r._key,i,null!==r.converter,n);return this._mutations.push(o.toMutation(r._key,Go.none())),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];this._verifyNotCommitted();var o,s=Td(t,this._firestore);return o="string"==typeof(e=Object(A.i)(e))||e instanceof If?Ff(this._dataReader,"WriteBatch.update",s._key,e,n,r):Mf(this._dataReader,"WriteBatch.update",s._key,e),this._mutations.push(o.toMutation(s._key,Go.exists(!0))),this},t.prototype.delete=function(t){this._verifyNotCommitted();var e=Td(t,this._firestore);return this._mutations=this._mutations.concat(new os(e._key,Go.none())),this},t.prototype.commit=function(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()},t.prototype._verifyNotCommitted=function(){if(this._committed)throw new Kr(Br.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},t}();function Td(t,e){if((t=Object(A.i)(t)).firestore!==e)throw new Kr(Br.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}var Ed=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return Object(Fr.c)(e,t),e.prototype.convertBytes=function(t){return new Tf(t)},e.prototype.convertReference=function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return new af(this.firestore,null,e)},e}(gd);function _d(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];t=nf(t,af);var o=nf(t.firestore,vf),s=xf(o);return Sd(o,[("string"==typeof(e=Object(A.i)(e))||e instanceof If?Ff(s,"updateDoc",t._key,e,n,r):Mf(s,"updateDoc",t._key,e)).toMutation(t._key,Go.exists(!0))])}function Od(t){for(var e,n,r,i=[],o=1;o<arguments.length;o++)i[o-1]=arguments[o];t=Object(A.i)(t);var s={includeMetadataChanges:!1},a=0;"object"!=typeof i[a]||yf(i[a])||(s=i[a],a++);var u,c,h,l={includeMetadataChanges:s.includeMetadataChanges};if(yf(i[a])){var f=i[a];i[a]=null===(e=f.next)||void 0===e?void 0:e.bind(f),i[a+1]=null===(n=f.error)||void 0===n?void 0:n.bind(f),i[a+2]=null===(r=f.complete)||void 0===r?void 0:r.bind(f)}if(t instanceof af)c=nf(t.firestore,vf),h=lo(t._key.path),u={next:function(e){i[a]&&i[a](Dd(c,t,e))},error:i[a+1],complete:i[a+2]};else{var d=nf(t,uf);c=nf(d.firestore,vf),h=d._query;var p=new Ed(c);u={next:function(t){i[a]&&i[a](new rd(c,p,d,t))},error:i[a+1],complete:i[a+2]},sd(t._query)}return function(t,e,n,r){var i=this,o=new Sl(r),s=new Lh(e,o,n);return t.asyncQueue.enqueueAndForget(function(){return Object(Fr.b)(i,void 0,void 0,function(){var e;return Object(Fr.d)(this,function(n){switch(n.label){case 0:return e=xh,[4,Ul(t)];case 1:return[2,e.apply(void 0,[n.sent(),s])]}})})}),function(){o.Wo(),t.asyncQueue.enqueueAndForget(function(){return Object(Fr.b)(i,void 0,void 0,function(){var e;return Object(Fr.d)(this,function(n){switch(n.label){case 0:return e=Ch,[4,Ul(t)];case 1:return[2,e.apply(void 0,[n.sent(),s])]}})})})}}(mf(c),h,l,u)}function Sd(t,e){return function(t,e){var n=this,r=new La;return t.asyncQueue.enqueueAndForget(function(){return Object(Fr.b)(n,void 0,void 0,function(){var n;return Object(Fr.d)(this,function(i){switch(i.label){case 0:return n=Wh,[4,Vl(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}})})}),r.promise}(mf(t),e)}function Dd(t,e,n){var r=n.docs.get(e._key),i=new Ed(t);return new ed(t,i,e._key,r,new td(n.hasPendingWrites,n.fromCache),e.converter)}var Nd=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this)._firestore=e,r}return Object(Fr.c)(e,t),e.prototype.get=function(e){var n=this,r=Td(e,this._firestore),i=new Ed(this._firestore);return t.prototype.get.call(this,e).then(function(t){return new ed(n._firestore,i,r._key,t._document,new td(!1,!1),r.converter)})},e}(function(){function t(t,e){this._firestore=t,this._transaction=e,this._dataReader=xf(t)}return t.prototype.get=function(t){var e=this,n=Td(t,this._firestore),r=new wd(this._firestore);return this._transaction.lookup([n._key]).then(function(t){if(!t||1!==t.length)return Xr();var i=t[0];if(i.isFoundDocument())return new $f(e._firestore,r,i.key,i,n.converter);if(i.isNoDocument())return new $f(e._firestore,r,n._key,null,n.converter);throw Xr()})},t.prototype.set=function(t,e,n){var r=Td(t,this._firestore),i=bd(r.converter,e,n),o=Cf(this._dataReader,"Transaction.set",r._key,i,null!==r.converter,n);return this._transaction.set(r._key,o),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o,s=Td(t,this._firestore);return o="string"==typeof(e=Object(A.i)(e))||e instanceof If?Ff(this._dataReader,"Transaction.update",s._key,e,n,r):Mf(this._dataReader,"Transaction.update",s._key,e),this._transaction.update(s._key,o),this},t.prototype.delete=function(t){var e=Td(t,this._firestore);return this._transaction.delete(e._key),this},t}());function Ad(){if("undefined"==typeof Uint8Array)throw new Kr(Br.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function kd(){if("undefined"==typeof atob)throw new Kr(Br.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var xd=function(){function t(t){this._delegate=t}return t.fromBase64String=function(e){return kd(),new t(Tf.fromBase64String(e))},t.fromUint8Array=function(e){return Ad(),new t(Tf.fromUint8Array(e))},t.prototype.toBase64=function(){return kd(),this._delegate.toBase64()},t.prototype.toUint8Array=function(){return Ad(),this._delegate.toUint8Array()},t.prototype.isEqual=function(t){return this._delegate.isEqual(t._delegate)},t.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},t}(),Cd=function(){function t(){}return t.prototype.enableIndexedDbPersistence=function(t,e){return function(t,e){wf(t=nf(t,vf));var n=mf(t),r=t._freezeSettings(),i=new Ol;return bf(n,i,new El(i,r.cacheSizeBytes,null==e?void 0:e.forceOwnership))}(t._delegate,{forceOwnership:e})},t.prototype.enableMultiTabIndexedDbPersistence=function(t){return function(t){wf(t=nf(t,vf));var e=mf(t),n=t._freezeSettings(),r=new Ol;return bf(e,r,new _l(r,n.cacheSizeBytes))}(t._delegate)},t.prototype.clearIndexedDbPersistence=function(t){return function(t){var e=this;if(t._initialized&&!t._terminated)throw new Kr(Br.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var n=new La;return t._queue.enqueueAndForgetEvenWhileRestricted(function(){return Object(Fr.b)(e,void 0,void 0,function(){var e;return Object(Fr.d)(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,function(t){return Object(Fr.b)(this,void 0,void 0,function(){return Object(Fr.d)(this,function(e){switch(e.label){case 0:return Ma.yt()?[4,Ma.delete(t+"main")]:[2,Promise.resolve()];case 1:return e.sent(),[2]}})})}(Xu(t._databaseId,t._persistenceKey))];case 1:return r.sent(),n.resolve(),[3,3];case 2:return e=r.sent(),n.reject(e),[3,3];case 3:return[2]}})})}),n.promise}(t._delegate)},t}(),jd=function(){function t(t,e,n){var r=this;this._delegate=e,this.Xc=n,this.INTERNAL={delete:function(){return r.terminate()}},t instanceof Bl||(this.Zc=t)}return Object.defineProperty(t.prototype,"_databaseId",{get:function(){return this._delegate._databaseId},enumerable:!1,configurable:!0}),t.prototype.settings=function(t){var e=this._delegate._getSettings();t.merge||e.host===t.host||Wr("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),t.merge&&delete(t=Object.assign(Object.assign({},e),t)).merge,this._delegate._setSettings(t)},t.prototype.useEmulator=function(t,e,n){void 0===n&&(n={}),function(t,e,n,r){void 0===r&&(r={});var i=(t=nf(t,sf))._getSettings();if("firestore.googleapis.com"!==i.host&&i.host!==e&&Wr("Host has been set in both settings() and useEmulator(), emulator host will be used"),t._setSettings(Object.assign(Object.assign({},i),{host:e+":"+n,ssl:!1})),r.mockUserToken){var o=Object(A.e)(r.mockUserToken),s=r.mockUserToken.sub||r.mockUserToken.user_id;if(!s)throw new Kr(Br.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");t._credentials=new Ql(new Gl(o,new Dc(s)))}}(this._delegate,t,e,n)},t.prototype.enableNetwork=function(){return function(t){var e=this;return t.asyncQueue.enqueue(function(){return Object(Fr.b)(e,void 0,void 0,function(){var e,n;return Object(Fr.d)(this,function(r){switch(r.label){case 0:return[4,Rl(t)];case 1:return e=r.sent(),[4,Ll(t)];case 2:return n=r.sent(),[2,(e.setNetworkEnabled(!0),function(t){var e=Jr(t);return e.Or.delete(0),Zc(e)}(n))]}})})})}(mf(nf(this._delegate,vf)))},t.prototype.disableNetwork=function(){return function(t){var e=this;return t.asyncQueue.enqueue(function(){return Object(Fr.b)(e,void 0,void 0,function(){var e,n;return Object(Fr.d)(this,function(r){switch(r.label){case 0:return[4,Rl(t)];case 1:return e=r.sent(),[4,Ll(t)];case 2:return n=r.sent(),[2,(e.setNetworkEnabled(!1),function(t){return Object(Fr.b)(this,void 0,void 0,function(){var e;return Object(Fr.d)(this,function(n){switch(n.label){case 0:return(e=Jr(t)).Or.add(0),[4,th(e)];case 1:return n.sent(),e.Br.set("Offline"),[2]}})})}(n))]}})})})}(mf(nf(this._delegate,vf)))},t.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&Jl("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.Xc.enableMultiTabIndexedDbPersistence(this):this.Xc.enableIndexedDbPersistence(this,n)},t.prototype.clearPersistence=function(){return this.Xc.clearIndexedDbPersistence(this)},t.prototype.terminate=function(){return this.Zc&&(this.Zc._removeServiceInstance("firestore"),this.Zc._removeServiceInstance("firestore-exp")),this._delegate._delete()},t.prototype.waitForPendingWrites=function(){return function(t){var e=this,n=new La;return t.asyncQueue.enqueueAndForget(function(){return Object(Fr.b)(e,void 0,void 0,function(){var e;return Object(Fr.d)(this,function(r){switch(r.label){case 0:return e=tl,[4,Vl(t)];case 1:return[2,e.apply(void 0,[r.sent(),n])]}})})}),n.promise}(mf(nf(this._delegate,vf)))},t.prototype.onSnapshotsInSync=function(t){return function(t,e){return function(t,e){var n=this,r=new Sl(e);return t.asyncQueue.enqueueAndForget(function(){return Object(Fr.b)(n,void 0,void 0,function(){var e;return Object(Fr.d)(this,function(n){switch(n.label){case 0:return e=function(t,e){Jr(t).Gr.add(e),e.next()},[4,Ul(t)];case 1:return[2,e.apply(void 0,[n.sent(),r])]}})})}),function(){r.Wo(),t.asyncQueue.enqueueAndForget(function(){return Object(Fr.b)(n,void 0,void 0,function(){var e;return Object(Fr.d)(this,function(n){switch(n.label){case 0:return e=function(t,e){Jr(t).Gr.delete(e)},[4,Ul(t)];case 1:return[2,e.apply(void 0,[n.sent(),r])]}})})})}}(mf(t=nf(t,vf)),yf(e)?e:{next:e})}(this._delegate,t)},Object.defineProperty(t.prototype,"app",{get:function(){if(!this.Zc)throw new Kr(Br.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.Zc},enumerable:!1,configurable:!0}),t.prototype.collection=function(t){try{return new Hd(this,hf(this._delegate,t))}catch(t){throw Md(t,"collection()","Firestore.collection()")}},t.prototype.doc=function(t){try{return new Ud(this,lf(this._delegate,t))}catch(t){throw Md(t,"doc()","Firestore.doc()")}},t.prototype.collectionGroup=function(t){try{return new Gd(this,function(t,e){if(t=nf(t,sf),Xl("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new Kr(Br.INVALID_ARGUMENT,"Invalid collection ID '"+e+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new uf(t,null,function(t){return new co(hi.emptyPath(),t)}(e))}(this._delegate,t))}catch(t){throw Md(t,"collectionGroup()","Firestore.collectionGroup()")}},t.prototype.runTransaction=function(t){var e=this;return function(t,e){return function(t,e){var n=this,r=new La;return t.asyncQueue.enqueueAndForget(function(){return Object(Fr.b)(n,void 0,void 0,function(){var n;return Object(Fr.d)(this,function(i){switch(i.label){case 0:return[4,function(t){return jl(t).then(function(t){return t.datastore})}(t)];case 1:return n=i.sent(),new Nl(t.asyncQueue,n,e,r).run(),[2]}})})}),r.promise}(mf(t),function(n){return e(new Nd(t,n))})}(this._delegate,function(n){return t(new Pd(e,n))})},t.prototype.batch=function(){var t=this;return mf(this._delegate),new Ld(new Id(this._delegate,function(e){return Sd(t._delegate,e)}))},t.prototype.loadBundle=function(t){throw new Kr(Br.FAILED_PRECONDITION,'"loadBundle()" does not exist, have you imported "firebase/firestore/bundle"?')},t.prototype.namedQuery=function(t){throw new Kr(Br.FAILED_PRECONDITION,'"namedQuery()" does not exist, have you imported "firebase/firestore/bundle"?')},t}(),Rd=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return Object(Fr.c)(e,t),e.prototype.convertBytes=function(t){return new xd(new Tf(t))},e.prototype.convertReference=function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return Ud.tu(e,this.firestore,null)},e}(gd),Pd=function(){function t(t,e){this._firestore=t,this._delegate=e,this._userDataWriter=new Rd(t)}return t.prototype.get=function(t){var e=this,n=Wd(t);return this._delegate.get(n).then(function(t){return new Bd(e._firestore,new ed(e._firestore._delegate,e._userDataWriter,t._key,t._document,t.metadata,n.converter))})},t.prototype.set=function(t,e,n){var r=Wd(t);return n?($l("Transaction.set",n),this._delegate.set(r,e,n)):this._delegate.set(r,e),this},t.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var s=Wd(t);return 2===arguments.length?this._delegate.update(s,e):(r=this._delegate).update.apply(r,Object(Fr.f)([s,e,n],i)),this},t.prototype.delete=function(t){var e=Wd(t);return this._delegate.delete(e),this},t}(),Ld=function(){function t(t){this._delegate=t}return t.prototype.set=function(t,e,n){var r=Wd(t);return n?($l("WriteBatch.set",n),this._delegate.set(r,e,n)):this._delegate.set(r,e),this},t.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var s=Wd(t);return 2===arguments.length?this._delegate.update(s,e):(r=this._delegate).update.apply(r,Object(Fr.f)([s,e,n],i)),this},t.prototype.delete=function(t){var e=Wd(t);return this._delegate.delete(e),this},t.prototype.commit=function(){return this._delegate.commit()},t}(),Vd=function(){function t(t,e,n){this._firestore=t,this._userDataWriter=e,this._delegate=n}return t.prototype.fromFirestore=function(t,e){var n=new nd(this._firestore._delegate,this._userDataWriter,t._key,t._document,t.metadata,null);return this._delegate.fromFirestore(new Kd(this._firestore,n),null!=e?e:{})},t.prototype.toFirestore=function(t,e){return e?this._delegate.toFirestore(t,e):this._delegate.toFirestore(t)},t.eu=function(e,n){var r=t.nu,i=r.get(e);i||(i=new WeakMap,r.set(e,i));var o=i.get(n);return o||(o=new t(e,new Rd(e),n),i.set(n,o)),o},t}();Vd.nu=new WeakMap;var Ud=function(){function t(t,e){this.firestore=t,this._delegate=e,this._userDataWriter=new Rd(t)}return t.su=function(e,n,r){if(e.length%2!=0)throw new Kr(Br.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+e.canonicalString()+" has "+e.length);return new t(n,new af(n._delegate,r,new Oi(e)))},t.tu=function(e,n,r){return new t(n,new af(n._delegate,r,e))},Object.defineProperty(t.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new Hd(this.firestore,this._delegate.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this._delegate.path},enumerable:!1,configurable:!0}),t.prototype.collection=function(t){try{return new Hd(this.firestore,hf(this._delegate,t))}catch(t){throw Md(t,"collection()","DocumentReference.collection()")}},t.prototype.isEqual=function(t){return(t=Object(A.i)(t))instanceof af&&ff(this._delegate,t)},t.prototype.set=function(t,e){e=$l("DocumentReference.set",e);try{return function(t,e,n){t=nf(t,af);var r=nf(t.firestore,vf),i=bd(t.converter,e,n);return Sd(r,[Cf(xf(r),"setDoc",t._key,i,null!==t.converter,n).toMutation(t._key,Go.none())])}(this._delegate,t,e)}catch(t){throw Md(t,"setDoc()","DocumentReference.set()")}},t.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?_d(this._delegate,t):_d.apply(void 0,Object(Fr.f)([this._delegate,t,e],n))}catch(t){throw Md(t,"updateDoc()","DocumentReference.update()")}},t.prototype.delete=function(){return Sd(nf((t=this._delegate).firestore,vf),[new os(t._key,Go.none())]);var t},t.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=Fd(e),i=qd(e,function(e){return new Bd(t.firestore,new ed(t.firestore._delegate,t._userDataWriter,e._key,e._document,e.metadata,t._delegate.converter))});return Od(this._delegate,r,i)},t.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){t=nf(t,af);var e=nf(t.firestore,vf),n=mf(e),r=new Ed(e);return function(t,e){var n=this,r=new La;return t.asyncQueue.enqueueAndForget(function(){return Object(Fr.b)(n,void 0,void 0,function(){var n;return Object(Fr.d)(this,function(i){switch(i.label){case 0:return n=function(t,e,n){return Object(Fr.b)(this,void 0,void 0,function(){var r,i;return Object(Fr.d)(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,function(t,e){var n=Jr(t);return n.persistence.runTransaction("read document","readonly",function(t){return n.Mn.mn(t,e)})}(t,e)];case 1:return(i=o.sent()).isFoundDocument()?n.resolve(i):i.isNoDocument()?n.resolve(null):n.reject(new Kr(Br.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=o.sent(),i=Oh(r,"Failed to get document '"+e+" from cache"),n.reject(i),[3,3];case 3:return[2]}})})},[4,Pl(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}})})}),r.promise}(n,t._key).then(function(n){return new ed(e,r,t._key,n,new td(null!==n&&n.hasLocalMutations,!0),t.converter)})}(this._delegate):"server"===(null==t?void 0:t.source)?function(t){t=nf(t,af);var e=nf(t.firestore,vf);return Ml(mf(e),t._key,{source:"server"}).then(function(n){return Dd(e,t,n)})}(this._delegate):function(t){t=nf(t,af);var e=nf(t.firestore,vf);return Ml(mf(e),t._key).then(function(n){return Dd(e,t,n)})}(this._delegate)).then(function(t){return new Bd(e.firestore,new ed(e.firestore._delegate,e._userDataWriter,t._key,t._document,t.metadata,e._delegate.converter))})},t.prototype.withConverter=function(e){return new t(this.firestore,this._delegate.withConverter(e?Vd.eu(this.firestore,e):null))},t}();function Md(t,e,n){return t.message=t.message.replace(e,n),t}function Fd(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if("object"==typeof r&&!yf(r))return r}return{}}function qd(t,e){var n,r,i;return{next:function(t){i.next&&i.next(e(t))},error:null===(n=(i=yf(t[0])?t[0]:yf(t[1])?t[1]:"function"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]}).error)||void 0===n?void 0:n.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}var Bd=function(){function t(t,e){this._firestore=t,this._delegate=e}return Object.defineProperty(t.prototype,"ref",{get:function(){return new Ud(this._firestore,this._delegate.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"exists",{get:function(){return this._delegate.exists()},enumerable:!1,configurable:!0}),t.prototype.data=function(t){return this._delegate.data(t)},t.prototype.get=function(t,e){return this._delegate.get(t,e)},t.prototype.isEqual=function(t){return od(this._delegate,t._delegate)},t}(),Kd=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(Fr.c)(e,t),e.prototype.data=function(t){return this._delegate.data(t)},e}(Bd),Gd=function(){function t(t,e){this.firestore=t,this._delegate=e,this._userDataWriter=new Rd(t)}return t.prototype.where=function(e,n,r){try{return new t(this.firestore,ud(this._delegate,function(t,e,n){var r=e,i=Zf("where",t);return new cd(i,r,n)}(e,n,r)))}catch(e){throw Md(e,/(orderBy|where)\(\)/,"Query.$1()")}},t.prototype.orderBy=function(e,n){try{return new t(this.firestore,ud(this._delegate,function(t,e){void 0===e&&(e="asc");var n=e,r=Zf("orderBy",t);return new hd(r,n)}(e,n)))}catch(e){throw Md(e,/(orderBy|where)\(\)/,"Query.$1()")}},t.prototype.limit=function(e){try{return new t(this.firestore,ud(this._delegate,function(t){return rf("limit",t),new ld("limit",t,"F")}(e)))}catch(e){throw Md(e,"limit()","Query.limit()")}},t.prototype.limitToLast=function(e){try{return new t(this.firestore,ud(this._delegate,function(t){return rf("limitToLast",t),new ld("limitToLast",t,"L")}(e)))}catch(e){throw Md(e,"limitToLast()","Query.limitToLast()")}},t.prototype.startAt=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,ud(this._delegate,(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new fd("startAt",t,!0)}).apply(void 0,e)))}catch(e){throw Md(e,"startAt()","Query.startAt()")}},t.prototype.startAfter=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,ud(this._delegate,(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new fd("startAfter",t,!1)}).apply(void 0,e)))}catch(e){throw Md(e,"startAfter()","Query.startAfter()")}},t.prototype.endBefore=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,ud(this._delegate,(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new dd("endBefore",t,!0)}).apply(void 0,e)))}catch(e){throw Md(e,"endBefore()","Query.endBefore()")}},t.prototype.endAt=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,ud(this._delegate,(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new dd("endAt",t,!1)}).apply(void 0,e)))}catch(e){throw Md(e,"endAt()","Query.endAt()")}},t.prototype.isEqual=function(t){return df(this._delegate,t._delegate)},t.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){t=nf(t,uf);var e=nf(t.firestore,vf),n=mf(e),r=new Ed(e);return function(t,e){var n=this,r=new La;return t.asyncQueue.enqueueAndForget(function(){return Object(Fr.b)(n,void 0,void 0,function(){var n;return Object(Fr.d)(this,function(i){switch(i.label){case 0:return n=function(t,e,n){return Object(Fr.b)(this,void 0,void 0,function(){var r,i,o,s,a;return Object(Fr.d)(this,function(u){switch(u.label){case 0:return u.trys.push([0,2,,3]),[4,lc(t,e,!0)];case 1:return a=u.sent(),r=new qh(e,a.Bn),i=r._o(a.documents),o=r.applyChanges(i,!1),n.resolve(o.snapshot),[3,3];case 2:return s=u.sent(),a=Oh(s,"Failed to execute query '"+e+" against cache"),n.reject(a),[3,3];case 3:return[2]}})})},[4,Pl(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}})})}),r.promise}(n,t._query).then(function(n){return new rd(e,r,t,n)})}(this._delegate):"server"===(null==t?void 0:t.source)?function(t){t=nf(t,uf);var e=nf(t.firestore,vf),n=mf(e),r=new Ed(e);return Fl(n,t._query,{source:"server"}).then(function(n){return new rd(e,r,t,n)})}(this._delegate):function(t){t=nf(t,uf);var e=nf(t.firestore,vf),n=mf(e),r=new Ed(e);return sd(t._query),Fl(n,t._query).then(function(n){return new rd(e,r,t,n)})}(this._delegate)).then(function(t){return new Qd(e.firestore,new rd(e.firestore._delegate,e._userDataWriter,e._delegate,t._snapshot))})},t.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=Fd(e),i=qd(e,function(e){return new Qd(t.firestore,new rd(t.firestore._delegate,t._userDataWriter,t._delegate,e._snapshot))});return Od(this._delegate,r,i)},t.prototype.withConverter=function(e){return new t(this.firestore,this._delegate.withConverter(e?Vd.eu(this.firestore,e):null))},t}(),zd=function(){function t(t,e){this._firestore=t,this._delegate=e}return Object.defineProperty(t.prototype,"type",{get:function(){return this._delegate.type},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"doc",{get:function(){return new Kd(this._firestore,this._delegate.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"oldIndex",{get:function(){return this._delegate.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"newIndex",{get:function(){return this._delegate.newIndex},enumerable:!1,configurable:!0}),t}(),Qd=function(){function t(t,e){this._firestore=t,this._delegate=e}return Object.defineProperty(t.prototype,"query",{get:function(){return new Gd(this._firestore,this._delegate.query)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._delegate.size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return this._delegate.empty},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"docs",{get:function(){var t=this;return this._delegate.docs.map(function(e){return new Kd(t._firestore,e)})},enumerable:!1,configurable:!0}),t.prototype.docChanges=function(t){var e=this;return this._delegate.docChanges(t).map(function(t){return new zd(e._firestore,t)})},t.prototype.forEach=function(t,e){var n=this;this._delegate.forEach(function(r){t.call(e,new Kd(n._firestore,r))})},t.prototype.isEqual=function(t){return od(this._delegate,t._delegate)},t}(),Hd=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).firestore=e,r._delegate=n,r}return Object(Fr.c)(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._delegate.path},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this._delegate.parent;return t?new Ud(this.firestore,t):null},enumerable:!1,configurable:!0}),e.prototype.doc=function(t){try{return new Ud(this.firestore,void 0===t?lf(this._delegate):lf(this._delegate,t))}catch(t){throw Md(t,"doc()","CollectionReference.doc()")}},e.prototype.add=function(t){var e=this;return function(t,e){var n=nf(t.firestore,vf),r=lf(t),i=bd(t.converter,e);return Sd(n,[Cf(xf(t.firestore),"addDoc",r._key,i,null!==t.converter,{}).toMutation(r._key,Go.exists(!1))]).then(function(){return r})}(this._delegate,t).then(function(t){return new Ud(e.firestore,t)})},e.prototype.isEqual=function(t){return ff(this._delegate,t._delegate)},e.prototype.withConverter=function(t){return new e(this.firestore,this._delegate.withConverter(t?Vd.eu(this.firestore,t):null))},e}(Gd);function Wd(t){return nf(t,af)}var Yd,Xd=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._delegate=new(If.bind.apply(If,Object(Fr.f)([void 0],t)))}return t.documentId=function(){return new t(fi.keyField().canonicalString())},t.prototype.isEqual=function(t){return(t=Object(A.i)(t))instanceof If&&this._delegate._internalPath.isEqual(t._internalPath)},t}(),$d=function(){function t(t){this._delegate=t}return t.serverTimestamp=function(){var e=new Pf("serverTimestamp");return e._methodName="FieldValue.serverTimestamp",new t(e)},t.delete=function(){var e=new jf("deleteField");return e._methodName="FieldValue.delete",new t(e)},t.arrayUnion=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Lf("arrayUnion",t)}).apply(void 0,e);return r._methodName="FieldValue.arrayUnion",new t(r)},t.arrayRemove=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Vf("arrayRemove",t)}).apply(void 0,e);return r._methodName="FieldValue.arrayRemove",new t(r)},t.increment=function(e){var n=function(t){return new Uf("increment",t)}(e);return n._methodName="FieldValue.increment",new t(n)},t.prototype.isEqual=function(t){return this._delegate.isEqual(t._delegate)},t}(),Jd=n("/6Yf"),Zd={Firestore:jd,GeoPoint:_f,Timestamp:ii,Blob:xd,Transaction:Pd,WriteBatch:Ld,DocumentReference:Ud,DocumentSnapshot:Bd,Query:Gd,QueryDocumentSnapshot:Kd,QuerySnapshot:Qd,CollectionReference:Hd,FieldPath:Xd,FieldValue:$d,setLogLevel:function(t){Gr.setLogLevel(t)},CACHE_SIZE_UNLIMITED:-1};(function(t,e){t.INTERNAL.registerComponent(new Jd.a("firestore",function(t){return function(t,e){return new jd(t,new vf(t,e),new Cd)}(t.getProvider("app").getImmediate(),t.getProvider("auth-internal"))},"PUBLIC").setServiceProps(Object.assign({},Zd)))})(Yd=N.a),Yd.registerVersion("@firebase/firestore","2.3.7");var tp=n("UbJi");function ep(t,e){return function(t,e=y.b){return new v.a(n=>{let r;return null!=e?e.schedule(()=>{r=t.onSnapshot({includeMetadataChanges:!0},n)}):r=t.onSnapshot({includeMetadataChanges:!0},n),()=>{null!=r&&r()}})}(t,e)}function np(t,e){return ep(t,e).pipe(Object(I.a)(t=>({payload:t,type:"query"})))}function rp(t,e){return np(t,e).pipe(Object(b.a)(void 0),Object(w.a)(),Object(I.a)(([t,e])=>{const n=e.payload.docChanges(),r=n.map(t=>({type:t.type,payload:t}));return t&&JSON.stringify(t.payload.metadata)!==JSON.stringify(e.payload.metadata)&&e.payload.docs.forEach((e,i)=>{const o=n.find(t=>t.doc.ref.isEqual(e.ref)),s=null==t?void 0:t.payload.docs.find(t=>t.ref.isEqual(e.ref));o&&JSON.stringify(o.doc.metadata)===JSON.stringify(e.metadata)||!o&&s&&JSON.stringify(s.metadata)===JSON.stringify(e.metadata)||r.push({type:"modified",payload:{oldIndex:i,newIndex:i,type:"modified",doc:e}})}),r}))}function ip(t,e,n){return rp(t,n).pipe(Object(T.a)((t,n)=>function(t,e,n){return e.forEach(e=>{n.indexOf(e.type)>-1&&(t=function(t,e){switch(e.type){case"added":if(!t[e.newIndex]||!t[e.newIndex].doc.ref.isEqual(e.doc.ref))return op(t,e.newIndex,0,e);break;case"modified":if(null==t[e.oldIndex]||t[e.oldIndex].doc.ref.isEqual(e.doc.ref)){if(e.oldIndex!==e.newIndex){const n=t.slice();return n.splice(e.oldIndex,1),n.splice(e.newIndex,0,e),n}return op(t,e.newIndex,1,e)}break;case"removed":if(t[e.oldIndex]&&t[e.oldIndex].doc.ref.isEqual(e.doc.ref))return op(t,e.oldIndex,1)}return t}(t,e))}),t}(t,n.map(t=>t.payload),e),[]),Object(E.a)(),Object(I.a)(t=>t.map(t=>({type:t.type,payload:t}))))}function op(t,e,n,...r){const i=t.slice();return i.splice(e,n,...r),i}function sp(t){return t&&0!==t.length||(t=["added","removed","modified"]),t}class ap{constructor(t,e,n){this.ref=t,this.query=e,this.afs=n}stateChanges(t){let e=rp(this.query,this.afs.schedulers.outsideAngular);return t&&t.length>0&&(e=e.pipe(Object(I.a)(e=>e.filter(e=>t.indexOf(e.type)>-1)))),e.pipe(Object(b.a)(void 0),Object(w.a)(),Object(_.a)(([t,e])=>e.length>0||!t),Object(I.a)(([t,e])=>e),this.afs.keepUnstableUntilFirst)}auditTrail(t){return this.stateChanges(t).pipe(Object(T.a)((t,e)=>[...t,...e],[]))}snapshotChanges(t){const e=sp(t);return ip(this.query,e,this.afs.schedulers.outsideAngular).pipe(this.afs.keepUnstableUntilFirst)}valueChanges(t={}){return np(this.query,this.afs.schedulers.outsideAngular).pipe(Object(I.a)(e=>e.payload.docs.map(e=>t.idField?Object.assign(Object.assign({},e.data()),{[t.idField]:e.id}):e.data())),this.afs.keepUnstableUntilFirst)}get(t){return Object(m.a)(this.query.get(t)).pipe(Object(O.b)(this.afs.schedulers.insideAngular))}add(t){return this.ref.add(t)}doc(t){return new up(this.ref.doc(t),this.afs)}}class up{constructor(t,e){this.ref=t,this.afs=e}set(t,e){return this.ref.set(t,e)}update(t){return this.ref.update(t)}delete(){return this.ref.delete()}collection(t,e){const n=this.ref.collection(t),{ref:r,query:i}=pp(n,e);return new ap(r,i,this.afs)}snapshotChanges(){return ep(this.ref,this.afs.schedulers.outsideAngular).pipe(Object(b.a)(void 0),Object(w.a)(),Object(I.a)(([t,e])=>e.exists?(null==t?void 0:t.exists)?{payload:e,type:"modified"}:{payload:e,type:"added"}:{payload:e,type:"removed"})).pipe(this.afs.keepUnstableUntilFirst)}valueChanges(t={}){return this.snapshotChanges().pipe(Object(I.a)(({payload:e})=>t.idField?Object.assign(Object.assign({},e.data()),{[t.idField]:e.id}):e.data()))}get(t){return Object(m.a)(this.ref.get(t)).pipe(Object(O.b)(this.afs.schedulers.insideAngular))}}class cp{constructor(t,e){this.query=t,this.afs=e}stateChanges(t){return t&&0!==t.length?rp(this.query,this.afs.schedulers.outsideAngular).pipe(Object(I.a)(e=>e.filter(e=>t.indexOf(e.type)>-1)),Object(_.a)(t=>t.length>0),this.afs.keepUnstableUntilFirst):rp(this.query,this.afs.schedulers.outsideAngular).pipe(this.afs.keepUnstableUntilFirst)}auditTrail(t){return this.stateChanges(t).pipe(Object(T.a)((t,e)=>[...t,...e],[]))}snapshotChanges(t){const e=sp(t);return ip(this.query,e,this.afs.schedulers.outsideAngular).pipe(this.afs.keepUnstableUntilFirst)}valueChanges(t={}){return np(this.query,this.afs.schedulers.outsideAngular).pipe(Object(I.a)(e=>e.payload.docs.map(e=>t.idField?Object.assign({[t.idField]:e.id},e.data()):e.data())),this.afs.keepUnstableUntilFirst)}get(t){return Object(m.a)(this.query.get(t)).pipe(Object(O.b)(this.afs.schedulers.insideAngular))}}const hp=new i.s("angularfire2.enableFirestorePersistence"),lp=new i.s("angularfire2.firestore.persistenceSettings"),fp=new i.s("angularfire2.firestore.settings"),dp=new i.s("angularfire2.firestore.use-emulator");function pp(t,e=(t=>t)){return{query:e(t),ref:t}}let yp=(()=>{class t{constructor(t,e,n,i,o,s,a,u,c){this.schedulers=new S.d(s),this.keepUnstableUntilFirst=Object(S.h)(this.schedulers);const h=Object(S.g)(t,s,e);!D.a.auth&&c&&Object(S.j)();const l=u;[this.firestore,this.persistenceEnabled$]=Object(S.f)(`${h.name}.firestore`,"AngularFirestore",h,()=>{const t=s.runOutsideAngular(()=>h.firestore());if(i&&t.settings(i),l&&t.useEmulator(...l),n&&!Object(r.u)(o)){const e=()=>{try{return Object(m.a)(t.enablePersistence(a||void 0).then(()=>!0,()=>!1))}catch(Yd){return"undefined"!=typeof console&&console.warn(Yd),Object(g.a)(!1)}};return[t,s.runOutsideAngular(e)]}return[t,Object(g.a)(!1)]},[i,l,n])}collection(t,e){let n;n="string"==typeof t?this.firestore.collection(t):t;const{ref:r,query:i}=pp(n,e),o=this.schedulers.ngZone.run(()=>r);return new ap(o,i,this)}collectionGroup(t,e){const n=e||(t=>t),r=this.firestore.collectionGroup(t);return new cp(n(r),this)}doc(t){let e;e="string"==typeof t?this.firestore.doc(t):t;const n=this.schedulers.ngZone.run(()=>e);return new up(n,this)}createId(){return this.firestore.collection("_").doc().id}}return t.\u0275fac=function(e){return new(e||t)(i.Zb(S.c),i.Zb(S.b,8),i.Zb(hp,8),i.Zb(fp,8),i.Zb(i.D),i.Zb(i.B),i.Zb(lp,8),i.Zb(dp,8),i.Zb(tp.b,8))},t.\u0275prov=i.Lb({factory:function(){return new t(i.Zb(S.c),i.Zb(S.b,8),i.Zb(hp,8),i.Zb(fp,8),i.Zb(i.D),i.Zb(i.B),i.Zb(lp,8),i.Zb(dp,8),i.Zb(tp.b,8))},token:t,providedIn:"any"}),t})();var vp=n("kmnG"),mp=n("qFsG"),gp=n("3Pt+");let bp=(()=>{class t{constructor(t,e,n,r){this.dialogRef=t,this.data=e,this.db=n,this.auth=r,this.userData={}}ngOnInit(){this.auth.user.subscribe(t=>{this.userData=t})}saveData(){if(this.loading=!0,null==this.data.id){let t=(new Date).getTime().toString();this.data.uid=this.userData.uid,this.db.collection("cameras").doc(t).set(this.data).then(t=>{this.dialogRef.close(this.data),this.loading=!1}).catch(t=>{console.log(t),this.loading=!1,alert("Tidak dapat menyimpan data")})}else this.db.collection("cameras").doc(this.data.id).update(this.data).then(t=>{this.dialogRef.close(this.data),this.loading=!1}).catch(t=>{console.log(t),this.loading=!1,alert("Tidak dapat mengupdate data")})}}return t.\u0275fac=function(e){return new(e||t)(i.Pb(p.g),i.Pb(p.a),i.Pb(yp),i.Pb(tp.a))},t.\u0275cmp=i.Jb({type:t,selectors:[["app-product-detail"]],decls:24,vars:6,consts:[["mat-dialog-title",""],["mat-dialog-content",""],["appearance","outline",2,"width","100%"],["matInput","",3,"ngModel","ngModelChange"],["matInput","","type","number",3,"ngModel","ngModelChange"],["mat-dialog-actions","","align","end"],["mat-button","","mat-dialog-close",""],["mat-flat-button","",3,"disabled","click"]],template:function(t,e){1&t&&(i.Vb(0,"h3",0),i.zc(1," Detail Produk "),i.Ub(),i.Vb(2,"div",1),i.Vb(3,"mat-form-field",2),i.Vb(4,"mat-label"),i.zc(5,"Nama"),i.Ub(),i.Vb(6,"input",3),i.cc("ngModelChange",function(t){return e.data.nama=t}),i.Ub(),i.Ub(),i.Vb(7,"mat-form-field",2),i.Vb(8,"mat-label"),i.zc(9,"Brand"),i.Ub(),i.Vb(10,"input",3),i.cc("ngModelChange",function(t){return e.data.brand=t}),i.Ub(),i.Ub(),i.Vb(11,"mat-form-field",2),i.Vb(12,"mat-label"),i.zc(13,"Kode"),i.Ub(),i.Vb(14,"input",3),i.cc("ngModelChange",function(t){return e.data.kode=t}),i.Ub(),i.Ub(),i.Vb(15,"mat-form-field",2),i.Vb(16,"mat-label"),i.zc(17,"Harga"),i.Ub(),i.Vb(18,"input",4),i.cc("ngModelChange",function(t){return e.data.harga=t}),i.Ub(),i.Ub(),i.Ub(),i.Vb(19,"div",5),i.Vb(20,"button",6),i.zc(21,"Batal"),i.Ub(),i.Vb(22,"button",7),i.cc("click",function(){return e.saveData()}),i.zc(23),i.Ub(),i.Ub()),2&t&&(i.Eb(6),i.lc("ngModel",e.data.nama),i.Eb(4),i.lc("ngModel",e.data.brand),i.Eb(4),i.lc("ngModel",e.data.kode),i.Eb(4),i.lc("ngModel",e.data.harga),i.Eb(4),i.lc("disabled",e.loading),i.Eb(1),i.Ac(e.loading?"Menyimpan..":"Simpan"))},directives:[p.h,p.e,vp.b,vp.e,mp.b,gp.c,gp.i,gp.k,gp.l,p.c,s.a,p.d],styles:[""]}),t})();var wp=n("Xa2L"),Ip=n("Wp6s");function Tp(t,e){1&t&&(i.Vb(0,"div",2),i.Qb(1,"mat-spinner"),i.Ub())}function Ep(t,e){if(1&t){const t=i.Wb();i.Vb(0,"tr"),i.Vb(1,"td"),i.zc(2),i.Ub(),i.Vb(3,"td"),i.zc(4),i.Ub(),i.Vb(5,"td"),i.zc(6),i.Ub(),i.Vb(7,"td"),i.zc(8),i.Ub(),i.Vb(9,"td"),i.zc(10),i.Ub(),i.Vb(11,"td",7),i.Vb(12,"button",9),i.cc("click",function(){i.sc(t);const n=e.$implicit,r=e.index;return i.gc(2).productDetail(n,r)}),i.zc(13,"Edit"),i.Ub(),i.Vb(14,"button",10),i.cc("click",function(){i.sc(t);const n=e.$implicit,r=e.index;return i.gc(2).deleteProduct(n.id,r)}),i.zc(15),i.Ub(),i.Ub(),i.Ub()}if(2&t){const t=e.$implicit,n=e.index,r=i.gc(2);i.Eb(2),i.Ac(n+1),i.Eb(2),i.Ac(t.nama),i.Eb(2),i.Ac(t.brand),i.Eb(2),i.Ac(t.kode),i.Eb(2),i.Ac(t.harga),i.Eb(4),i.lc("disabled",r.loadingDelete[n]),i.Eb(1),i.Ac(r.loadingDelete[n]?"Deleting..":"Delete")}}function _p(t,e){if(1&t){const t=i.Wb();i.Vb(0,"mat-card"),i.Vb(1,"mat-card-header"),i.Vb(2,"mat-card-title"),i.zc(3),i.Ub(),i.Ub(),i.Vb(4,"mat-card-content"),i.Vb(5,"div",3),i.Qb(6,"span",4),i.Vb(7,"button",5),i.cc("click",function(){return i.sc(t),i.gc().productDetail({},-1)}),i.zc(8,"Tambah Produk"),i.Ub(),i.Ub(),i.Vb(9,"table",6),i.Vb(10,"thead"),i.Vb(11,"th"),i.zc(12,"No"),i.Ub(),i.Vb(13,"th"),i.zc(14,"Nama"),i.Ub(),i.Vb(15,"th"),i.zc(16,"Brand"),i.Ub(),i.Vb(17,"th"),i.zc(18,"Kode"),i.Ub(),i.Vb(19,"th"),i.zc(20,"Harga"),i.Ub(),i.Qb(21,"th",7),i.Ub(),i.Vb(22,"tbody"),i.yc(23,Ep,16,7,"tr",8),i.Ub(),i.Ub(),i.Ub(),i.Ub()}if(2&t){const t=i.gc();i.Eb(3),i.Ac(t.title),i.Eb(20),i.lc("ngForOf",t.cameras)}}let Op=(()=>{class t{constructor(t,e,n){this.dialog=t,this.db=e,this.auth=n,this.cameras=[],this.userData={},this.loadingDelete={}}ngOnInit(){this.title="PRODUCT",this.auth.user.subscribe(t=>{this.userData=t,this.getCameras()})}getCameras(){this.loading=!0,this.db.collection("cameras",t=>t.where("uid","==",this.userData.uid)).valueChanges({idField:"id"}).subscribe(t=>{console.log(t),this.cameras=t,this.loading=!1},t=>{this.loading=!1})}productDetail(t,e){this.dialog.open(bp,{width:"400px",data:t}).afterClosed().subscribe(t=>{})}deleteProduct(t,e){confirm("Delete Item?")&&this.db.collection("cameras").doc(t).delete().then(t=>{this.cameras.splice(e,1),this.loadingDelete[e]=!1}).catch(t=>{this.loadingDelete[e]=!1,alert("Tidak dapat menghapus data")})}}return t.\u0275fac=function(e){return new(e||t)(i.Pb(p.b),i.Pb(yp),i.Pb(tp.a))},t.\u0275cmp=i.Jb({type:t,selectors:[["app-product"]],decls:2,vars:2,consts:[["style","height: 300px","class","uk-flex uk-flex-center uk-flex-middle",4,"ngIf"],[4,"ngIf"],[1,"uk-flex","uk-flex-center","uk-flex-middle",2,"height","300px"],[1,"uk-flex"],[1,"uk-width-expand"],["mat-flat-button","","color","primary",3,"click"],[1,"uk-table","uk-table-middle","uk-table-divider"],["align","right"],[4,"ngFor","ngForOf"],["mat-button","","color","primary",3,"click"],["mat-button","","color","warn",3,"disabled","click"]],template:function(t,e){1&t&&(i.yc(0,Tp,2,0,"div",0),i.yc(1,_p,24,2,"mat-card",1)),2&t&&(i.lc("ngIf",e.loading),i.Eb(1),i.lc("ngIf",!e.loading))},directives:[r.k,wp.b,Ip.a,Ip.c,Ip.f,Ip.b,s.a,r.j],styles:[""]}),t})();const Sp=[{path:"",component:f,children:[{path:"home",component:(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=i.Jb({type:t,selectors:[["app-home"]],decls:7,vars:0,consts:[["mat-card-image","","src","assets/ok.jpg","width","100%","height","500"]],template:function(t,e){1&t&&(i.Vb(0,"mat-card"),i.Vb(1,"mat-card-title"),i.zc(2,"DETKAMERA"),i.Ub(),i.Qb(3,"img",0),i.Vb(4,"mat-card-content"),i.Vb(5,"p"),i.zc(6," Selamat datang di DETKAMERA, tempat terbaik informasi kamera Anda! "),i.Ub(),i.Ub(),i.Ub())},directives:[Ip.a,Ip.f,Ip.d,Ip.b],styles:[""]}),t})()},{path:"katalog",component:(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=i.Jb({type:t,selectors:[["app-katalog"]],decls:40,vars:0,consts:[[1,"row"],[1,"col-xl-6"],[1,"card","mb-4"],[1,"card-body"],["src","assets/kat1.jpg","width","100%","height","500"],["src","assets/kat3.jpg","width","100%","height","500"],["src","assets/kat2.jpg","width","100%","height","500"],["src","assets/kat4.jpg","width","100%","height","500"],["src","assets/kat5.jpg","width","100%","height","500"]],template:function(t,e){1&t&&(i.Vb(0,"mat-card"),i.Vb(1,"div",0),i.Vb(2,"mat-card-title"),i.zc(3,"FUJIFILM"),i.Ub(),i.Vb(4,"div",1),i.Vb(5,"div",2),i.Vb(6,"div",3),i.Qb(7,"img",4),i.Ub(),i.Ub(),i.Ub(),i.Qb(8,"hr"),i.Vb(9,"div",1),i.Vb(10,"div",2),i.Vb(11,"div",3),i.Qb(12,"img",5),i.Ub(),i.Ub(),i.Ub(),i.Ub(),i.Ub(),i.Qb(13,"hr"),i.Vb(14,"mat-card"),i.Vb(15,"div",0),i.Vb(16,"mat-card-title"),i.zc(17,"CANON"),i.Ub(),i.Vb(18,"div",1),i.Vb(19,"div",2),i.Vb(20,"div",3),i.Qb(21,"img",6),i.Ub(),i.Ub(),i.Ub(),i.Ub(),i.Ub(),i.Qb(22,"hr"),i.Vb(23,"mat-card"),i.Vb(24,"div",0),i.Vb(25,"mat-card-title"),i.zc(26,"NIKON"),i.Ub(),i.Vb(27,"div",1),i.Vb(28,"div",2),i.Vb(29,"div",3),i.Qb(30,"img",7),i.Ub(),i.Ub(),i.Ub(),i.Ub(),i.Ub(),i.Qb(31,"hr"),i.Vb(32,"mat-card"),i.Vb(33,"div",0),i.Vb(34,"mat-card-title"),i.zc(35,"SONY"),i.Ub(),i.Vb(36,"div",1),i.Vb(37,"div",2),i.Vb(38,"div",3),i.Qb(39,"img",8),i.Ub(),i.Ub(),i.Ub(),i.Ub(),i.Ub())},directives:[Ip.a,Ip.f],styles:[""]}),t})()},{path:"product",component:Op},{path:"",pathMatch:"full",redirectTo:"/admin/home"}]}];let Dp=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=i.Nb({type:t}),t.\u0275inj=i.Mb({imports:[[r.c,c.c.forChild(Sp),d.a,gp.e]]}),t})()}}]);